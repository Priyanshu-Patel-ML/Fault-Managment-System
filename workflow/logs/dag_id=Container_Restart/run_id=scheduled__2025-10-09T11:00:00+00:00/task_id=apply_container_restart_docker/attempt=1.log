[2025-10-09T11:45:37.832+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-10-09T11:45:37.897+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: Container_Restart.apply_container_restart_docker scheduled__2025-10-09T11:00:00+00:00 [queued]>
[2025-10-09T11:45:37.922+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: Container_Restart.apply_container_restart_docker scheduled__2025-10-09T11:00:00+00:00 [queued]>
[2025-10-09T11:45:37.922+0000] {taskinstance.py:2865} INFO - Starting attempt 1 of 1
[2025-10-09T11:45:37.962+0000] {taskinstance.py:2888} INFO - Executing <Task(DockerOperator): apply_container_restart_docker> on 2025-10-09 11:00:00+00:00
[2025-10-09T11:45:37.977+0000] {standard_task_runner.py:72} INFO - Started process 2019 to run task
[2025-10-09T11:45:37.994+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'Container_Restart', 'apply_container_restart_docker', 'scheduled__2025-10-09T11:00:00+00:00', '--job-id', '1202', '--raw', '--subdir', 'DAGS_FOLDER/dag_factory.py', '--cfg-path', '/tmp/tmp_i_yxh5s']
[2025-10-09T11:45:37.999+0000] {standard_task_runner.py:105} INFO - Job 1202: Subtask apply_container_restart_docker
[2025-10-09T11:45:38.154+0000] {task_command.py:467} INFO - Running <TaskInstance: Container_Restart.apply_container_restart_docker scheduled__2025-10-09T11:00:00+00:00 [running]> on host workflow.y2twbfvcjkaujnl2bmtbxunhcb.cx.internal.cloudapp.net
[2025-10-09T11:45:38.453+0000] {taskinstance.py:3131} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='Container_Restart' AIRFLOW_CTX_TASK_ID='apply_container_restart_docker' AIRFLOW_CTX_EXECUTION_DATE='2025-10-09T11:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-10-09T11:00:00+00:00'
[2025-10-09T11:45:38.455+0000] {taskinstance.py:731} INFO - ::endgroup::
[2025-10-09T11:45:38.593+0000] {docker.py:367} INFO - Starting docker container from image priyanshu01ce/***_chaos:latest
[2025-10-09T11:45:39.637+0000] {docker.py:438} INFO - The container is run as root user. For security, consider using a regular user account.
[2025-10-09T11:45:51.721+0000] {job.py:239} ERROR - Job heartbeat failed with error
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (127.0.0.1), port 5433 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/jobs/job.py", line 233, in heartbeat
    heartbeat_callback(session)
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/jobs/local_task_job_runner.py", line 284, in heartbeat_callback
    self.task_instance.refresh_from_db()
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/session.py", line 97, in wrapper
    return func(*args, session=session, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/models/taskinstance.py", line 2358, in refresh_from_db
    _refresh_from_db(task_instance=self, session=session, lock_for_update=lock_for_update)
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/models/taskinstance.py", line 872, in _refresh_from_db
    ti = TaskInstance.get_task_instance(
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/models/taskinstance.py", line 2344, in get_task_instance
    return query.one_or_none()
           ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2850, in one_or_none
    return self._iter().one_or_none()
           ^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/query.py", line 2916, in _iter
    result = self.session.execute(
             ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 750, in _connection_for_bind
    conn = bind.connect()
           ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/future/engine.py", line 412, in connect
    return super(Engine, self).connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3325, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3404, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3374, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2208, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: server closed the connection unexpectedly
	This probably means the server terminated abnormally
	before or while processing the request.

(Background on this error at: https://sqlalche.me/e/14/e3q8)
[2025-10-09T11:45:54.905+0000] {job.py:245} ERROR - Job heartbeat failed with error. Scheduler may go into unhealthy state
[2025-10-09T11:46:01.070+0000] {job.py:254} ERROR - Job heartbeat failed with error. Scheduler is in unhealthy state
[2025-10-09T11:46:06.206+0000] {job.py:229} INFO - Heartbeat recovered after 17.68 seconds
[2025-10-09T11:46:46.517+0000] {job.py:239} ERROR - Job heartbeat failed with error
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (127.0.0.1), port 5433 failed: FATAL:  the database system is in recovery mode


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/jobs/job.py", line 207, in heartbeat
    self._merge_from(Job._fetch_from_db(self, session))
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/retries.py", line 93, in wrapped_function
    for attempt in run_with_db_retries(max_retries=retries, logger=logger, **retry_kwargs):
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/retries.py", line 102, in wrapped_function
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/jobs/job.py", line 335, in _fetch_from_db
    session.merge(job)
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3056, in merge
    return self._merge(
           ^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3136, in _merge
    merged = self.get(
             ^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2853, in get
    return self._get_impl(
           ^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2975, in _get_impl
    return db_load_fn(
           ^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/loading.py", line 530, in load_on_pk_identity
    session.execute(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 750, in _connection_for_bind
    conn = bind.connect()
           ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/future/engine.py", line 412, in connect
    return super(Engine, self).connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3325, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3404, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3374, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2208, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: FATAL:  the database system is in recovery mode

(Background on this error at: https://sqlalche.me/e/14/e3q8)
[2025-10-09T11:46:47.710+0000] {job.py:254} ERROR - Job heartbeat failed with error. Scheduler is in unhealthy state
[2025-10-09T11:46:50.909+0000] {docker.py:438} INFO - 
[2025-10-09T11:46:53.506+0000] {docker.py:438} INFO - total 3292
[2025-10-09T11:46:53.507+0000] {docker.py:438} INFO - drwxr-xr-x 5    1000 1000    4096 Oct  9 06:39 .
[2025-10-09T11:46:53.508+0000] {docker.py:438} INFO - drwxr-xr-x 1 *** root    4096 Sep 26 10:44 ..
[2025-10-09T11:46:53.508+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    1193 Sep  8 07:02 API_Latency.json
[2025-10-09T11:46:53.513+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000     729 Sep  9 10:30 API_Timeout.json
[2025-10-09T11:46:53.513+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    1243 Sep 30 18:21 CPU_Stress_Test_Azure.yaml
[2025-10-09T11:46:53.513+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    1331 Oct  7 18:22 Continuous_Load_Test_Azure.yaml
[2025-10-09T11:46:53.514+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    1233 Sep 30 18:18 Load_Test_Azure.yaml
[2025-10-09T11:46:53.515+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    1267 Oct  9 06:39 Memory_Stress_Test_Azure.yaml
[2025-10-09T11:46:53.516+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    1178 Sep 30 18:19 Stress_Test_Azure.yaml
[2025-10-09T11:46:53.516+0000] {docker.py:438} INFO - drwxrwxr-x 2 root    root    4096 Oct  9 06:43 __pycache__
[2025-10-09T11:46:53.516+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    8875 Sep 25 16:54 chaosk6_actions.py
[2025-10-09T11:46:53.517+0000] {docker.py:438} INFO - -rw-rw-r-- 1 root    root 2906701 Oct  9 11:45 chaostoolkit.log
[2025-10-09T11:46:53.517+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    3213 Sep  9 09:11 combined-sequential.json
[2025-10-09T11:46:53.517+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000     502 Sep 16 05:31 connection_test_experiment.json
[2025-10-09T11:46:53.522+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    1420 Sep 24 06:53 container_restart.json
[2025-10-09T11:46:53.522+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000   16452 Sep 26 09:59 container_restart.py
[2025-10-09T11:46:53.522+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    1313 Oct  9 06:32 container_restart_Azure.yaml
[2025-10-09T11:46:53.522+0000] {docker.py:438} INFO - -rw-rw-r-- 1    1000 1000    6679 Oct  9 06:37 continuos_memory_stress.py
[2025-10-09T11:46:53.523+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    1409 Sep 18 12:30 continuous_load_test.json
[2025-10-09T11:46:53.523+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    1637 Sep 25 10:13 cordon-uncordon-node.json
[2025-10-09T11:46:53.525+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    1637 Sep 25 04:39 cordon_test.json
[2025-10-09T11:46:53.526+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    1034 Sep 30 18:27 cordon_uncordon_node_Azure.yaml
[2025-10-09T11:46:53.526+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    1203 Sep 30 06:51 cpu_stress_ng.json
[2025-10-09T11:46:53.526+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    1771 Sep 24 07:40 db_cleanup.json
[2025-10-09T11:46:53.527+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    6399 Sep 24 07:40 db_cleanup.py
[2025-10-09T11:46:53.527+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    1169 Sep 30 18:15 db_cleanup_docker_Azure.yaml
[2025-10-09T11:46:53.531+0000] {docker.py:438} INFO - -rw-rw-r-- 1    1000 1000    1076 Oct  9 06:38 gradual_memory_stress.json
[2025-10-09T11:46:53.531+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    3216 Oct  9 11:45 journal.json
[2025-10-09T11:46:53.532+0000] {docker.py:438} INFO - -rw-rw-r-- 1 root    root  196685 Oct  9 11:45 k6_continuous_load.log
[2025-10-09T11:46:53.532+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    3963 Oct  9 11:45 k6_continuous_summary.json
[2025-10-09T11:46:53.532+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    3433 Sep 25 09:28 k6_summary.json
[2025-10-09T11:46:53.533+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000     989 Sep 30 09:24 kubernetes_actions.json
[2025-10-09T11:46:53.533+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000   10961 Sep 30 09:23 kubernetes_actions.py
[2025-10-09T11:46:53.533+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000     945 Sep 21 16:40 load_test.json
[2025-10-09T11:46:53.533+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000     528 Sep 17 12:13 max_connection_experiment.json
[2025-10-09T11:46:53.534+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    1227 Sep 13 15:20 memory-stress-rollback.json
[2025-10-09T11:46:53.534+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    1421 Sep 29 05:20 mongo_db_container_restart.json
[2025-10-09T11:46:53.534+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    7586 Sep 18 05:54 mongodb_actions.py
[2025-10-09T11:46:53.535+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    2136 Sep 18 11:23 mongodb_connection.json
[2025-10-09T11:46:53.535+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000     597 Sep 16 09:17 mongodb_network_latency_experiment.json
[2025-10-09T11:46:53.535+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    3657 Sep 18 05:42 mongodb_probes.py
[2025-10-09T11:46:53.537+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    6161 Sep 12 08:04 pod_restart.py
[2025-10-09T11:46:53.537+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    1497 Sep 30 05:50 redis_config_faults.py
[2025-10-09T11:46:53.537+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000     862 Sep 30 05:50 redis_experiment.json
[2025-10-09T11:46:53.537+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000     945 Sep 18 06:53 redis_load.json
[2025-10-09T11:46:53.538+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    1299 Sep 30 18:14 redis_memory_stress_Azure.yaml
[2025-10-09T11:46:53.538+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    1284 Sep 25 10:53 run_load_test_with_cleanup.py
[2025-10-09T11:46:53.540+0000] {docker.py:438} INFO - drwxr-xr-x 2    1000 1000    4096 Oct  8 01:13 scripts
[2025-10-09T11:46:53.540+0000] {docker.py:438} INFO - drwxr-xr-x 4    1000 1000    4096 Sep 30 09:41 socialNetwork
[2025-10-09T11:46:53.540+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000     821 Sep 26 13:20 stress_test.json
[2025-10-09T11:46:53.541+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000     367 Sep 17 07:24 test_params.json
[2025-10-09T11:46:53.542+0000] {docker.py:438} INFO - Starting continuous container restart experiment...
[2025-10-09T11:46:53.652+0000] {job.py:254} ERROR - Job heartbeat failed with error. Scheduler is in unhealthy state
[2025-10-09T11:46:58.466+0000] {docker.py:438} INFO - [32m[2025-10-09 11:46:58 INFO] Validating the experiment's syntax
[2025-10-09T11:46:58.835+0000] {job.py:229} INFO - Heartbeat recovered after 21.88 seconds
[2025-10-09T11:47:01.933+0000] {docker.py:438} INFO - [32m[2025-10-09 11:47:01 INFO] Experiment looks valid
[2025-10-09T11:47:01.942+0000] {docker.py:438} INFO - [32m[2025-10-09 11:47:01 INFO] Running experiment: Continuous Container Restart Experiment
[2025-10-09T11:47:01.959+0000] {docker.py:438} INFO - [32m[2025-10-09 11:47:01 INFO] Steady-state strategy: default
[2025-10-09T11:47:01.960+0000] {docker.py:438} INFO - [32m[2025-10-09 11:47:01 INFO] Rollbacks strategy: default
[2025-10-09T11:47:01.960+0000] {docker.py:438} INFO - [32m[2025-10-09 11:47:01 INFO] No steady state hypothesis defined. That's ok, just exploring.
[2025-10-09T11:47:01.960+0000] {docker.py:438} INFO - [32m[2025-10-09 11:47:01 INFO] Playing your experiment's method now...
[2025-10-09T11:47:01.962+0000] {docker.py:438} INFO - [32m[2025-10-09 11:47:01 INFO] Action: continuous-container-restart
[2025-10-09T11:47:30.567+0000] {docker.py:438} INFO - üöÄ [DEBUG] Entered restart_containers_continuous()
[2025-10-09T11:47:30.662+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, interval=5, duration=400, ns=default, container_name=compose-post-service
[2025-10-09T11:47:30.663+0000] {docker.py:438} INFO - 
[2025-10-09T11:47:30.663+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T11:47:30.663+0000] {docker.py:438} INFO - üîÑ [DEBUG] Container Restart Cycle #1 at 2025-10-09 11:47:01
[2025-10-09T11:47:30.663+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T11:47:30.664+0000] {docker.py:438} INFO - üîÑ [DEBUG] Entered restart_containers()
[2025-10-09T11:47:30.664+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, qty=2, rand=True, mode=fixed, ns=default, order=alphabetic, container_name=compose-post-service, restart_command=None
[2025-10-09T11:47:30.664+0000] {docker.py:438} INFO - üîë [DEBUG] Kubernetes API client created
[2025-10-09T11:47:30.664+0000] {docker.py:438} INFO - üîç [DEBUG] Selecting pods now...
[2025-10-09T11:47:30.664+0000] {docker.py:438} INFO - üîç [DEBUG] Entered _select_pods()
[2025-10-09T11:47:30.665+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, all=False, rand=True, mode=fixed, qty=2, ns=default, order=alphabetic
[2025-10-09T11:47:30.665+0000] {docker.py:438} INFO -    [DEBUG] Listing pods with label_selector=app=compose-post-service
[2025-10-09T11:47:30.665+0000] {docker.py:438} INFO - üìã [DEBUG] Found 1 pods initially
[2025-10-09T11:47:30.665+0000] {docker.py:438} INFO - üé≤ [DEBUG] Random selection chosen: 1 pods
[2025-10-09T11:47:30.665+0000] {docker.py:438} INFO - ‚úÖ [DEBUG] Selected pods: ['compose-post-service-67bcfcd5ff-bqrz2']
[2025-10-09T11:47:30.665+0000] {docker.py:438} INFO - üìã [DEBUG] Pods selected: 1
[2025-10-09T11:47:30.666+0000] {docker.py:438} INFO - 
[2025-10-09T11:47:30.666+0000] {docker.py:438} INFO - üéØ [DEBUG] Processing pod: compose-post-service-67bcfcd5ff-bqrz2
[2025-10-09T11:47:30.666+0000] {docker.py:438} INFO - üì¶ [DEBUG] Using provided container: compose-post-service
[2025-10-09T11:47:30.666+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:47:30.666+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:47:30.667+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 47
[2025-10-09T11:47:30.667+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=47
[2025-10-09T11:47:30.667+0000] {docker.py:438} INFO - üìä [DEBUG] Restart count before action: 47
[2025-10-09T11:47:30.667+0000] {docker.py:438} INFO - üîß [DEBUG] Restart strategies to try: [['sh', '-c', 'kill -INT 1'], ['sh', '-c', 'kill -2 1'], ['sh', '-c', 'kill -TERM 1'], ['sh', '-c', 'kill -9 1']]
[2025-10-09T11:47:30.668+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #1: sh -c kill -INT 1
[2025-10-09T11:47:30.668+0000] {docker.py:438} INFO -    [DEBUG] Exec stream opened successfully, running command...
[2025-10-09T11:47:30.668+0000] {docker.py:438} INFO -    [DEBUG] run_forever returned/finished
[2025-10-09T11:47:30.668+0000] {docker.py:438} INFO -    üì§ [DEBUG] STDOUT (truncated): 
[2025-10-09T11:47:30.668+0000] {docker.py:438} INFO -    üì§ [DEBUG] STDERR (truncated): 
[2025-10-09T11:47:30.669+0000] {docker.py:438} INFO -    üì§ [DEBUG] CTRL_ERR: {"metadata":{},"status":"Failure","message":"command terminated with non-zero exit code: error executing command [sh -c kill -INT 1], exit code 137","reason":"NonZeroExitCode","details":{"causes":[{"reason":"ExitCode","message":"137"}]}}
[2025-10-09T11:47:30.669+0000] {docker.py:438} INFO -    ‚è≥ [DEBUG] Waiting up to 60s for restart count to increment...
[2025-10-09T11:47:30.669+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:47:30.669+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:47:30.669+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 47
[2025-10-09T11:47:30.670+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=47
[2025-10-09T11:47:30.670+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 47 (before was 47)
[2025-10-09T11:47:30.670+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:47:30.670+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:47:30.670+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 48
[2025-10-09T11:47:30.671+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=48
[2025-10-09T11:47:30.671+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 48 (before was 47)
[2025-10-09T11:47:30.671+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Restart observed: 47 -> 48
[2025-10-09T11:47:30.671+0000] {docker.py:438} INFO -    üéâ [DEBUG] Restart verified, breaking out of strategies loop
[2025-10-09T11:47:30.671+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:47:30.672+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:47:30.672+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 48
[2025-10-09T11:47:30.672+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=48
[2025-10-09T11:47:30.672+0000] {docker.py:438} INFO - ‚úÖ [DEBUG] Restart recorded for compose-post-service-67bcfcd5ff-bqrz2: 47 -> 48
[2025-10-09T11:47:30.672+0000] {docker.py:438} INFO - 
[2025-10-09T11:47:30.672+0000] {docker.py:438} INFO - üèÅ [DEBUG] restart_containers() finished. Processed 1 pods
[2025-10-09T11:47:30.673+0000] {docker.py:438} INFO -    [DEBUG] restart_containers returned 1 entries
[2025-10-09T11:47:30.673+0000] {docker.py:438} INFO - ‚úÖ [DEBUG] Successfully restarted this cycle: 1
[2025-10-09T11:47:30.673+0000] {docker.py:438} INFO -    üì¶ [DEBUG] compose-post-service-67bcfcd5ff-bqrz2: restart_verified
[2025-10-09T11:47:30.673+0000] {docker.py:438} INFO - ‚è≥ [DEBUG] Waiting 5 seconds until next cycle. Time remaining: 396s
[2025-10-09T11:47:30.673+0000] {docker.py:438} INFO - 
[2025-10-09T11:47:30.674+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T11:47:30.674+0000] {docker.py:438} INFO - üîÑ [DEBUG] Container Restart Cycle #2 at 2025-10-09 11:47:11
[2025-10-09T11:47:30.674+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T11:47:30.674+0000] {docker.py:438} INFO - üîÑ [DEBUG] Entered restart_containers()
[2025-10-09T11:47:30.674+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, qty=2, rand=True, mode=fixed, ns=default, order=alphabetic, container_name=compose-post-service, restart_command=None
[2025-10-09T11:47:30.675+0000] {docker.py:438} INFO - üîë [DEBUG] Kubernetes API client created
[2025-10-09T11:47:30.675+0000] {docker.py:438} INFO - üîç [DEBUG] Selecting pods now...
[2025-10-09T11:47:30.675+0000] {docker.py:438} INFO - üîç [DEBUG] Entered _select_pods()
[2025-10-09T11:47:30.675+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, all=False, rand=True, mode=fixed, qty=2, ns=default, order=alphabetic
[2025-10-09T11:47:30.675+0000] {docker.py:438} INFO -    [DEBUG] Listing pods with label_selector=app=compose-post-service
[2025-10-09T11:47:30.675+0000] {docker.py:438} INFO - üìã [DEBUG] Found 1 pods initially
[2025-10-09T11:47:30.676+0000] {docker.py:438} INFO - üé≤ [DEBUG] Random selection chosen: 1 pods
[2025-10-09T11:47:30.676+0000] {docker.py:438} INFO - ‚úÖ [DEBUG] Selected pods: ['compose-post-service-67bcfcd5ff-bqrz2']
[2025-10-09T11:47:30.676+0000] {docker.py:438} INFO - üìã [DEBUG] Pods selected: 1
[2025-10-09T11:47:30.676+0000] {docker.py:438} INFO - 
[2025-10-09T11:47:30.676+0000] {docker.py:438} INFO - üéØ [DEBUG] Processing pod: compose-post-service-67bcfcd5ff-bqrz2
[2025-10-09T11:47:30.677+0000] {docker.py:438} INFO - üì¶ [DEBUG] Using provided container: compose-post-service
[2025-10-09T11:47:30.677+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:47:30.677+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:47:30.677+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 48
[2025-10-09T11:47:30.677+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=48
[2025-10-09T11:47:30.678+0000] {docker.py:438} INFO - üìä [DEBUG] Restart count before action: 48
[2025-10-09T11:47:30.678+0000] {docker.py:438} INFO - üîß [DEBUG] Restart strategies to try: [['sh', '-c', 'kill -INT 1'], ['sh', '-c', 'kill -2 1'], ['sh', '-c', 'kill -TERM 1'], ['sh', '-c', 'kill -9 1']]
[2025-10-09T11:47:30.678+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #1: sh -c kill -INT 1
[2025-10-09T11:47:30.678+0000] {docker.py:438} INFO -    [DEBUG] Exec stream opened successfully, running command...
[2025-10-09T11:47:30.678+0000] {docker.py:438} INFO -    [DEBUG] run_forever returned/finished
[2025-10-09T11:47:30.679+0000] {docker.py:438} INFO -    üì§ [DEBUG] STDOUT (truncated): 
[2025-10-09T11:47:30.679+0000] {docker.py:438} INFO -    üì§ [DEBUG] STDERR (truncated): 
[2025-10-09T11:47:30.679+0000] {docker.py:438} INFO -    üì§ [DEBUG] CTRL_ERR: {"metadata":{},"status":"Success"}
[2025-10-09T11:47:30.679+0000] {docker.py:438} INFO -    ‚è≥ [DEBUG] Waiting up to 60s for restart count to increment...
[2025-10-09T11:47:30.679+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:47:30.680+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:47:30.680+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 48
[2025-10-09T11:47:30.680+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=48
[2025-10-09T11:47:30.680+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 48 (before was 48)
[2025-10-09T11:47:30.680+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:47:30.681+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:47:30.681+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 48
[2025-10-09T11:47:30.681+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=48
[2025-10-09T11:47:30.681+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 48 (before was 48)
[2025-10-09T11:47:30.681+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:47:30.682+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:47:30.682+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 48
[2025-10-09T11:47:30.682+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=48
[2025-10-09T11:47:30.682+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 48 (before was 48)
[2025-10-09T11:47:30.682+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:47:30.683+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:47:30.683+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 48
[2025-10-09T11:47:30.683+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=48
[2025-10-09T11:47:30.683+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 48 (before was 48)
[2025-10-09T11:47:30.683+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:47:30.684+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:47:30.684+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 48
[2025-10-09T11:47:30.684+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=48
[2025-10-09T11:47:30.684+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 48 (before was 48)
[2025-10-09T11:47:30.684+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:47:30.685+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:47:30.685+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 48
[2025-10-09T11:47:30.685+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=48
[2025-10-09T11:47:30.685+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 48 (before was 48)
[2025-10-09T11:47:30.685+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:47:30.685+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:47:30.686+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 49
[2025-10-09T11:47:30.686+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=49
[2025-10-09T11:47:34.383+0000] {job.py:239} ERROR - Job heartbeat failed with error
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (127.0.0.1), port 5433 failed: FATAL:  the database system is in recovery mode


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/jobs/job.py", line 207, in heartbeat
    self._merge_from(Job._fetch_from_db(self, session))
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/retries.py", line 93, in wrapped_function
    for attempt in run_with_db_retries(max_retries=retries, logger=logger, **retry_kwargs):
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/retries.py", line 102, in wrapped_function
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/jobs/job.py", line 335, in _fetch_from_db
    session.merge(job)
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3056, in merge
    return self._merge(
           ^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3136, in _merge
    merged = self.get(
             ^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2853, in get
    return self._get_impl(
           ^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2975, in _get_impl
    return db_load_fn(
           ^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/loading.py", line 530, in load_on_pk_identity
    session.execute(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 750, in _connection_for_bind
    conn = bind.connect()
           ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/future/engine.py", line 412, in connect
    return super(Engine, self).connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3325, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3404, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3374, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2208, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: FATAL:  the database system is in recovery mode

(Background on this error at: https://sqlalche.me/e/14/e3q8)
[2025-10-09T11:47:35.174+0000] {job.py:254} ERROR - Job heartbeat failed with error. Scheduler is in unhealthy state
[2025-10-09T11:47:41.401+0000] {job.py:254} ERROR - Job heartbeat failed with error. Scheduler is in unhealthy state
[2025-10-09T11:47:46.470+0000] {job.py:229} INFO - Heartbeat recovered after 27.21 seconds
[2025-10-09T11:48:07.566+0000] {docker.py:438} INFO - [DEBUG] Polled restart count: 49 (before was 48)
[2025-10-09T11:48:07.755+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Restart observed: 48 -> 49
[2025-10-09T11:48:07.756+0000] {docker.py:438} INFO -    üéâ [DEBUG] Restart verified, breaking out of strategies loop
[2025-10-09T11:48:07.756+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:48:07.756+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:48:07.756+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 49
[2025-10-09T11:48:07.757+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=49
[2025-10-09T11:48:07.757+0000] {docker.py:438} INFO - ‚úÖ [DEBUG] Restart recorded for compose-post-service-67bcfcd5ff-bqrz2: 48 -> 49
[2025-10-09T11:48:07.757+0000] {docker.py:438} INFO - 
[2025-10-09T11:48:07.757+0000] {docker.py:438} INFO - üèÅ [DEBUG] restart_containers() finished. Processed 1 pods
[2025-10-09T11:48:07.757+0000] {docker.py:438} INFO -    [DEBUG] restart_containers returned 1 entries
[2025-10-09T11:48:07.758+0000] {docker.py:438} INFO - ‚úÖ [DEBUG] Successfully restarted this cycle: 1
[2025-10-09T11:48:07.758+0000] {docker.py:438} INFO -    üì¶ [DEBUG] compose-post-service-67bcfcd5ff-bqrz2: restart_verified
[2025-10-09T11:48:07.758+0000] {docker.py:438} INFO - ‚è≥ [DEBUG] Waiting 5 seconds until next cycle. Time remaining: 372s
[2025-10-09T11:48:07.758+0000] {docker.py:438} INFO - 
[2025-10-09T11:48:07.758+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T11:48:07.759+0000] {docker.py:438} INFO - üîÑ [DEBUG] Container Restart Cycle #3 at 2025-10-09 11:47:35
[2025-10-09T11:48:07.759+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T11:48:07.759+0000] {docker.py:438} INFO - üîÑ [DEBUG] Entered restart_containers()
[2025-10-09T11:48:07.759+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, qty=2, rand=True, mode=fixed, ns=default, order=alphabetic, container_name=compose-post-service, restart_command=None
[2025-10-09T11:48:07.760+0000] {docker.py:438} INFO - üîë [DEBUG] Kubernetes API client created
[2025-10-09T11:48:07.760+0000] {docker.py:438} INFO - üîç [DEBUG] Selecting pods now...
[2025-10-09T11:48:07.760+0000] {docker.py:438} INFO - üîç [DEBUG] Entered _select_pods()
[2025-10-09T11:48:07.760+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, all=False, rand=True, mode=fixed, qty=2, ns=default, order=alphabetic
[2025-10-09T11:48:07.760+0000] {docker.py:438} INFO -    [DEBUG] Listing pods with label_selector=app=compose-post-service
[2025-10-09T11:48:07.761+0000] {docker.py:438} INFO - üìã [DEBUG] Found 1 pods initially
[2025-10-09T11:48:07.761+0000] {docker.py:438} INFO - üé≤ [DEBUG] Random selection chosen: 1 pods
[2025-10-09T11:48:07.761+0000] {docker.py:438} INFO - ‚úÖ [DEBUG] Selected pods: ['compose-post-service-67bcfcd5ff-bqrz2']
[2025-10-09T11:48:07.761+0000] {docker.py:438} INFO - üìã [DEBUG] Pods selected: 1
[2025-10-09T11:48:07.761+0000] {docker.py:438} INFO - 
[2025-10-09T11:48:07.762+0000] {docker.py:438} INFO - üéØ [DEBUG] Processing pod: compose-post-service-67bcfcd5ff-bqrz2
[2025-10-09T11:48:07.762+0000] {docker.py:438} INFO - üì¶ [DEBUG] Using provided container: compose-post-service
[2025-10-09T11:48:07.762+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:48:07.762+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:48:07.762+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 49
[2025-10-09T11:48:07.763+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=49
[2025-10-09T11:48:07.763+0000] {docker.py:438} INFO - üìä [DEBUG] Restart count before action: 49
[2025-10-09T11:48:07.763+0000] {docker.py:438} INFO - üîß [DEBUG] Restart strategies to try: [['sh', '-c', 'kill -INT 1'], ['sh', '-c', 'kill -2 1'], ['sh', '-c', 'kill -TERM 1'], ['sh', '-c', 'kill -9 1']]
[2025-10-09T11:48:07.763+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #1: sh -c kill -INT 1
[2025-10-09T11:48:07.763+0000] {docker.py:438} INFO -    [DEBUG] Exec stream opened successfully, running command...
[2025-10-09T11:48:07.764+0000] {docker.py:438} INFO -    [DEBUG] run_forever returned/finished
[2025-10-09T11:48:07.764+0000] {docker.py:438} INFO -    üì§ [DEBUG] STDOUT (truncated): 
[2025-10-09T11:48:07.764+0000] {docker.py:438} INFO -    üì§ [DEBUG] STDERR (truncated): 
[2025-10-09T11:48:07.764+0000] {docker.py:438} INFO -    üì§ [DEBUG] CTRL_ERR: {"metadata":{},"status":"Success"}
[2025-10-09T11:48:07.765+0000] {docker.py:438} INFO -    ‚è≥ [DEBUG] Waiting up to 60s for restart count to increment...
[2025-10-09T11:48:07.765+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:48:07.765+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:48:07.765+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 49
[2025-10-09T11:48:07.765+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=49
[2025-10-09T11:48:07.765+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 49 (before was 49)
[2025-10-09T11:48:07.766+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:48:07.766+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:48:07.766+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 49
[2025-10-09T11:48:07.766+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=49
[2025-10-09T11:48:07.766+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 49 (before was 49)
[2025-10-09T11:48:07.767+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:48:07.767+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:48:07.767+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 49
[2025-10-09T11:48:07.768+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=49
[2025-10-09T11:48:07.768+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 49 (before was 49)
[2025-10-09T11:48:07.768+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:48:07.768+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:48:07.768+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 49
[2025-10-09T11:48:07.769+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=49
[2025-10-09T11:48:07.769+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 49 (before was 49)
[2025-10-09T11:48:07.770+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:48:07.770+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:48:07.770+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 49
[2025-10-09T11:48:07.770+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=49
[2025-10-09T11:48:07.770+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 49 (before was 49)
[2025-10-09T11:48:07.771+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:48:07.771+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:48:07.771+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 49
[2025-10-09T11:48:07.771+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=49
[2025-10-09T11:48:07.772+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 49 (before was 49)
[2025-10-09T11:48:07.772+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:48:07.772+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:48:07.772+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 49
[2025-10-09T11:48:07.772+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=49
[2025-10-09T11:48:07.773+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 49 (before was 49)
[2025-10-09T11:48:07.773+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:48:07.773+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:48:07.773+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 49
[2025-10-09T11:48:07.774+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=49
[2025-10-09T11:48:07.774+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 49 (before was 49)
[2025-10-09T11:48:07.774+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:48:07.774+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:48:07.774+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 49
[2025-10-09T11:48:07.775+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=49
[2025-10-09T11:48:07.775+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 49 (before was 49)
[2025-10-09T11:48:07.775+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:48:07.775+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:48:07.776+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 49
[2025-10-09T11:48:07.776+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=49
[2025-10-09T11:48:07.776+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 49 (before was 49)
[2025-10-09T11:48:07.776+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:48:07.777+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:48:07.777+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 49
[2025-10-09T11:48:07.777+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=49
[2025-10-09T11:48:07.777+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 49 (before was 49)
[2025-10-09T11:48:07.777+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:48:07.778+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:48:07.778+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 49
[2025-10-09T11:48:07.778+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=49
[2025-10-09T11:48:07.778+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 49 (before was 49)
[2025-10-09T11:48:07.778+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:48:07.779+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:48:07.779+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 50
[2025-10-09T11:48:07.779+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=50
[2025-10-09T11:48:07.779+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 50 (before was 49)
[2025-10-09T11:48:07.780+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Restart observed: 49 -> 50
[2025-10-09T11:48:07.780+0000] {docker.py:438} INFO -    üéâ [DEBUG] Restart verified, breaking out of strategies loop
[2025-10-09T11:48:07.780+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:48:07.780+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:48:07.780+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 50
[2025-10-09T11:48:07.781+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=50
[2025-10-09T11:48:07.781+0000] {docker.py:438} INFO - ‚úÖ [DEBUG] Restart recorded for compose-post-service-67bcfcd5ff-bqrz2: 49 -> 50
[2025-10-09T11:48:07.781+0000] {docker.py:438} INFO - 
[2025-10-09T11:48:07.781+0000] {docker.py:438} INFO - üèÅ [DEBUG] restart_containers() finished. Processed 1 pods
[2025-10-09T11:48:07.782+0000] {docker.py:438} INFO -    [DEBUG] restart_containers returned 1 entries
[2025-10-09T11:48:07.782+0000] {docker.py:438} INFO - ‚úÖ [DEBUG] Successfully restarted this cycle: 1
[2025-10-09T11:48:07.782+0000] {docker.py:438} INFO -    üì¶ [DEBUG] compose-post-service-67bcfcd5ff-bqrz2: restart_verified
[2025-10-09T11:48:10.377+0000] {job.py:239} ERROR - Job heartbeat failed with error
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (127.0.0.1), port 5433 failed: FATAL:  the database system is in recovery mode


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/jobs/job.py", line 207, in heartbeat
    self._merge_from(Job._fetch_from_db(self, session))
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/retries.py", line 93, in wrapped_function
    for attempt in run_with_db_retries(max_retries=retries, logger=logger, **retry_kwargs):
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/retries.py", line 102, in wrapped_function
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/jobs/job.py", line 335, in _fetch_from_db
    session.merge(job)
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3056, in merge
    return self._merge(
           ^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3136, in _merge
    merged = self.get(
             ^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2853, in get
    return self._get_impl(
           ^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2975, in _get_impl
    return db_load_fn(
           ^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/loading.py", line 530, in load_on_pk_identity
    session.execute(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 750, in _connection_for_bind
    conn = bind.connect()
           ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/future/engine.py", line 412, in connect
    return super(Engine, self).connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3325, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3404, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3374, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2208, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: FATAL:  the database system is in recovery mode

(Background on this error at: https://sqlalche.me/e/14/e3q8)
[2025-10-09T11:48:10.965+0000] {job.py:254} ERROR - Job heartbeat failed with error. Scheduler is in unhealthy state
[2025-10-09T11:48:16.460+0000] {job.py:254} ERROR - Job heartbeat failed with error. Scheduler is in unhealthy state
[2025-10-09T11:48:21.559+0000] {job.py:229} INFO - Heartbeat recovered after 24.96 seconds
[2025-10-09T11:48:57.861+0000] {docker.py:438} INFO - ‚è≥ [DEBUG] Waiting 5 seconds until next cycle. Time remaining: 335s
[2025-10-09T11:48:58.064+0000] {docker.py:438} INFO - 
[2025-10-09T11:48:58.066+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T11:48:58.066+0000] {docker.py:438} INFO - üîÑ [DEBUG] Container Restart Cycle #4 at 2025-10-09 11:48:12
[2025-10-09T11:48:58.066+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T11:48:58.067+0000] {docker.py:438} INFO - üîÑ [DEBUG] Entered restart_containers()
[2025-10-09T11:48:58.067+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, qty=2, rand=True, mode=fixed, ns=default, order=alphabetic, container_name=compose-post-service, restart_command=None
[2025-10-09T11:48:58.068+0000] {docker.py:438} INFO - üîë [DEBUG] Kubernetes API client created
[2025-10-09T11:48:58.068+0000] {docker.py:438} INFO - üîç [DEBUG] Selecting pods now...
[2025-10-09T11:48:58.068+0000] {docker.py:438} INFO - üîç [DEBUG] Entered _select_pods()
[2025-10-09T11:48:58.068+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, all=False, rand=True, mode=fixed, qty=2, ns=default, order=alphabetic
[2025-10-09T11:48:58.068+0000] {docker.py:438} INFO -    [DEBUG] Listing pods with label_selector=app=compose-post-service
[2025-10-09T11:48:58.069+0000] {docker.py:438} INFO - üìã [DEBUG] Found 1 pods initially
[2025-10-09T11:48:58.069+0000] {docker.py:438} INFO - üé≤ [DEBUG] Random selection chosen: 1 pods
[2025-10-09T11:48:58.069+0000] {docker.py:438} INFO - ‚úÖ [DEBUG] Selected pods: ['compose-post-service-67bcfcd5ff-bqrz2']
[2025-10-09T11:48:58.069+0000] {docker.py:438} INFO - üìã [DEBUG] Pods selected: 1
[2025-10-09T11:48:58.069+0000] {docker.py:438} INFO - 
[2025-10-09T11:48:58.070+0000] {docker.py:438} INFO - üéØ [DEBUG] Processing pod: compose-post-service-67bcfcd5ff-bqrz2
[2025-10-09T11:48:58.070+0000] {docker.py:438} INFO - üì¶ [DEBUG] Using provided container: compose-post-service
[2025-10-09T11:48:58.070+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:48:58.070+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:48:58.070+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 50
[2025-10-09T11:48:58.071+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=50
[2025-10-09T11:48:58.071+0000] {docker.py:438} INFO - üìä [DEBUG] Restart count before action: 50
[2025-10-09T11:48:58.071+0000] {docker.py:438} INFO - üîß [DEBUG] Restart strategies to try: [['sh', '-c', 'kill -INT 1'], ['sh', '-c', 'kill -2 1'], ['sh', '-c', 'kill -TERM 1'], ['sh', '-c', 'kill -9 1']]
[2025-10-09T11:48:58.071+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #1: sh -c kill -INT 1
[2025-10-09T11:48:58.072+0000] {docker.py:438} INFO -    [DEBUG] Exec stream opened successfully, running command...
[2025-10-09T11:48:58.072+0000] {docker.py:438} INFO -    [DEBUG] run_forever returned/finished
[2025-10-09T11:48:58.072+0000] {docker.py:438} INFO -    üì§ [DEBUG] STDOUT (truncated): 
[2025-10-09T11:48:58.072+0000] {docker.py:438} INFO -    üì§ [DEBUG] STDERR (truncated): 
[2025-10-09T11:48:58.072+0000] {docker.py:438} INFO -    üì§ [DEBUG] CTRL_ERR: {"metadata":{},"status":"Success"}
[2025-10-09T11:48:58.073+0000] {docker.py:438} INFO -    ‚è≥ [DEBUG] Waiting up to 60s for restart count to increment...
[2025-10-09T11:48:58.073+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:48:58.073+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:48:58.073+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 50
[2025-10-09T11:48:58.073+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=50
[2025-10-09T11:48:58.074+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 50 (before was 50)
[2025-10-09T11:48:58.074+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:48:58.074+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:48:58.074+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 50
[2025-10-09T11:48:58.075+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=50
[2025-10-09T11:48:58.075+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 50 (before was 50)
[2025-10-09T11:48:58.075+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:48:58.075+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:48:58.075+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 50
[2025-10-09T11:48:58.076+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=50
[2025-10-09T11:48:58.076+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 50 (before was 50)
[2025-10-09T11:48:58.076+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:48:58.076+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:48:58.076+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 50
[2025-10-09T11:48:58.077+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=50
[2025-10-09T11:48:58.077+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 50 (before was 50)
[2025-10-09T11:48:58.077+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:48:58.077+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:48:58.077+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 50
[2025-10-09T11:48:58.077+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=50
[2025-10-09T11:48:58.078+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 50 (before was 50)
[2025-10-09T11:48:58.078+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:48:58.078+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:48:58.078+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 50
[2025-10-09T11:48:58.078+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=50
[2025-10-09T11:48:58.079+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 50 (before was 50)
[2025-10-09T11:48:58.079+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:48:58.079+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:48:58.079+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 50
[2025-10-09T11:48:58.080+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=50
[2025-10-09T11:48:58.080+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 50 (before was 50)
[2025-10-09T11:48:58.080+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:48:58.080+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:48:58.080+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 50
[2025-10-09T11:48:58.081+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=50
[2025-10-09T11:48:58.081+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 50 (before was 50)
[2025-10-09T11:48:58.081+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:48:58.081+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:48:58.081+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 50
[2025-10-09T11:48:58.082+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=50
[2025-10-09T11:48:58.082+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 50 (before was 50)
[2025-10-09T11:48:58.082+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:48:58.082+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:48:58.082+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 50
[2025-10-09T11:48:58.083+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=50
[2025-10-09T11:48:58.083+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 50 (before was 50)
[2025-10-09T11:48:58.083+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:48:58.083+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:48:58.083+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 50
[2025-10-09T11:48:58.084+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=50
[2025-10-09T11:48:58.084+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 50 (before was 50)
[2025-10-09T11:48:58.084+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:48:58.084+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:48:58.084+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 50
[2025-10-09T11:48:58.085+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=50
[2025-10-09T11:48:58.085+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 50 (before was 50)
[2025-10-09T11:48:58.085+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:48:58.085+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:48:58.085+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 50
[2025-10-09T11:48:58.086+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=50
[2025-10-09T11:48:58.086+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 50 (before was 50)
[2025-10-09T11:48:58.086+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:48:58.086+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:48:58.086+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 50
[2025-10-09T11:48:58.087+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=50
[2025-10-09T11:48:58.087+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 50 (before was 50)
[2025-10-09T11:48:58.087+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:48:58.087+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:48:58.087+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 50
[2025-10-09T11:48:58.088+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=50
[2025-10-09T11:48:58.088+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 50 (before was 50)
[2025-10-09T11:48:58.088+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:48:58.088+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:48:58.088+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 50
[2025-10-09T11:48:58.088+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=50
[2025-10-09T11:48:58.089+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 50 (before was 50)
[2025-10-09T11:48:58.089+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:48:58.089+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:48:58.089+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 50
[2025-10-09T11:48:58.090+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=50
[2025-10-09T11:48:58.090+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 50 (before was 50)
[2025-10-09T11:48:58.090+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:49:00.387+0000] {job.py:239} ERROR - Job heartbeat failed with error
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (127.0.0.1), port 5433 failed: FATAL:  the database system is in recovery mode


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/jobs/job.py", line 207, in heartbeat
    self._merge_from(Job._fetch_from_db(self, session))
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/retries.py", line 93, in wrapped_function
    for attempt in run_with_db_retries(max_retries=retries, logger=logger, **retry_kwargs):
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/retries.py", line 102, in wrapped_function
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/jobs/job.py", line 335, in _fetch_from_db
    session.merge(job)
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3056, in merge
    return self._merge(
           ^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3136, in _merge
    merged = self.get(
             ^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2853, in get
    return self._get_impl(
           ^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2975, in _get_impl
    return db_load_fn(
           ^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/loading.py", line 530, in load_on_pk_identity
    session.execute(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 750, in _connection_for_bind
    conn = bind.connect()
           ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/future/engine.py", line 412, in connect
    return super(Engine, self).connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3325, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3404, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3374, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2208, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: FATAL:  the database system is in recovery mode

(Background on this error at: https://sqlalche.me/e/14/e3q8)
[2025-10-09T11:49:01.262+0000] {job.py:254} ERROR - Job heartbeat failed with error. Scheduler is in unhealthy state
[2025-10-09T11:49:06.648+0000] {job.py:254} ERROR - Job heartbeat failed with error. Scheduler is in unhealthy state
[2025-10-09T11:49:11.740+0000] {job.py:229} INFO - Heartbeat recovered after 29.63 seconds
[2025-10-09T11:49:51.149+0000] {job.py:239} ERROR - Job heartbeat failed with error
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (127.0.0.1), port 5433 failed: FATAL:  the database system is in recovery mode


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/jobs/job.py", line 207, in heartbeat
    self._merge_from(Job._fetch_from_db(self, session))
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/retries.py", line 93, in wrapped_function
    for attempt in run_with_db_retries(max_retries=retries, logger=logger, **retry_kwargs):
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/retries.py", line 102, in wrapped_function
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/jobs/job.py", line 335, in _fetch_from_db
    session.merge(job)
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3056, in merge
    return self._merge(
           ^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3136, in _merge
    merged = self.get(
             ^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2853, in get
    return self._get_impl(
           ^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2975, in _get_impl
    return db_load_fn(
           ^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/loading.py", line 530, in load_on_pk_identity
    session.execute(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 750, in _connection_for_bind
    conn = bind.connect()
           ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/future/engine.py", line 412, in connect
    return super(Engine, self).connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3325, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3404, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3374, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2208, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: FATAL:  the database system is in recovery mode

(Background on this error at: https://sqlalche.me/e/14/e3q8)
[2025-10-09T11:49:51.408+0000] {job.py:254} ERROR - Job heartbeat failed with error. Scheduler is in unhealthy state
[2025-10-09T11:49:53.803+0000] {docker.py:438} INFO - [DEBUG] Found 1 container_status entries
[2025-10-09T11:49:53.804+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 50
[2025-10-09T11:49:53.804+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=50
[2025-10-09T11:49:53.805+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 50 (before was 50)
[2025-10-09T11:49:53.805+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:49:53.805+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:49:53.806+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 50
[2025-10-09T11:49:53.806+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=50
[2025-10-09T11:49:53.808+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 50 (before was 50)
[2025-10-09T11:49:53.809+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:49:53.810+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:49:53.810+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 50
[2025-10-09T11:49:53.810+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=50
[2025-10-09T11:49:53.811+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 50 (before was 50)
[2025-10-09T11:49:53.811+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:49:53.812+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:49:53.813+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 50
[2025-10-09T11:49:53.813+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=50
[2025-10-09T11:49:53.813+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 50 (before was 50)
[2025-10-09T11:49:53.813+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:49:53.814+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:49:53.814+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 50
[2025-10-09T11:49:53.815+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=50
[2025-10-09T11:49:53.816+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 50 (before was 50)
[2025-10-09T11:49:53.816+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:49:53.817+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:49:53.818+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 50
[2025-10-09T11:49:53.818+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=50
[2025-10-09T11:49:53.818+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 50 (before was 50)
[2025-10-09T11:49:53.819+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:49:53.819+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:49:53.819+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 51
[2025-10-09T11:49:53.820+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=51
[2025-10-09T11:49:53.820+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 51 (before was 50)
[2025-10-09T11:49:53.822+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Restart observed: 50 -> 51
[2025-10-09T11:49:53.822+0000] {docker.py:438} INFO -    üéâ [DEBUG] Restart verified, breaking out of strategies loop
[2025-10-09T11:49:53.822+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:49:53.823+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:49:53.823+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 51
[2025-10-09T11:49:53.823+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=51
[2025-10-09T11:49:53.824+0000] {docker.py:438} INFO - ‚úÖ [DEBUG] Restart recorded for compose-post-service-67bcfcd5ff-bqrz2: 50 -> 51
[2025-10-09T11:49:53.825+0000] {docker.py:438} INFO - 
[2025-10-09T11:49:53.825+0000] {docker.py:438} INFO - üèÅ [DEBUG] restart_containers() finished. Processed 1 pods
[2025-10-09T11:49:53.825+0000] {docker.py:438} INFO -    [DEBUG] restart_containers returned 1 entries
[2025-10-09T11:49:53.826+0000] {docker.py:438} INFO - ‚úÖ [DEBUG] Successfully restarted this cycle: 1
[2025-10-09T11:49:53.826+0000] {docker.py:438} INFO -    üì¶ [DEBUG] compose-post-service-67bcfcd5ff-bqrz2: restart_verified
[2025-10-09T11:49:53.827+0000] {docker.py:438} INFO - ‚è≥ [DEBUG] Waiting 5 seconds until next cycle. Time remaining: 272s
[2025-10-09T11:49:53.827+0000] {docker.py:438} INFO - 
[2025-10-09T11:49:53.828+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T11:49:53.828+0000] {docker.py:438} INFO - üîÑ [DEBUG] Container Restart Cycle #5 at 2025-10-09 11:49:15
[2025-10-09T11:49:53.828+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T11:49:53.829+0000] {docker.py:438} INFO - üîÑ [DEBUG] Entered restart_containers()
[2025-10-09T11:49:53.829+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, qty=2, rand=True, mode=fixed, ns=default, order=alphabetic, container_name=compose-post-service, restart_command=None
[2025-10-09T11:49:53.830+0000] {docker.py:438} INFO - üîë [DEBUG] Kubernetes API client created
[2025-10-09T11:49:53.831+0000] {docker.py:438} INFO - üîç [DEBUG] Selecting pods now...
[2025-10-09T11:49:53.831+0000] {docker.py:438} INFO - üîç [DEBUG] Entered _select_pods()
[2025-10-09T11:49:53.831+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, all=False, rand=True, mode=fixed, qty=2, ns=default, order=alphabetic
[2025-10-09T11:49:53.831+0000] {docker.py:438} INFO -    [DEBUG] Listing pods with label_selector=app=compose-post-service
[2025-10-09T11:49:53.832+0000] {docker.py:438} INFO - üìã [DEBUG] Found 1 pods initially
[2025-10-09T11:49:53.832+0000] {docker.py:438} INFO - üé≤ [DEBUG] Random selection chosen: 1 pods
[2025-10-09T11:49:53.833+0000] {docker.py:438} INFO - ‚úÖ [DEBUG] Selected pods: ['compose-post-service-67bcfcd5ff-bqrz2']
[2025-10-09T11:49:53.834+0000] {docker.py:438} INFO - üìã [DEBUG] Pods selected: 1
[2025-10-09T11:49:53.834+0000] {docker.py:438} INFO - 
[2025-10-09T11:49:53.834+0000] {docker.py:438} INFO - üéØ [DEBUG] Processing pod: compose-post-service-67bcfcd5ff-bqrz2
[2025-10-09T11:49:53.834+0000] {docker.py:438} INFO - üì¶ [DEBUG] Using provided container: compose-post-service
[2025-10-09T11:49:53.835+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:49:53.835+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:49:53.836+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 51
[2025-10-09T11:49:53.837+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=51
[2025-10-09T11:49:53.837+0000] {docker.py:438} INFO - üìä [DEBUG] Restart count before action: 51
[2025-10-09T11:49:53.837+0000] {docker.py:438} INFO - üîß [DEBUG] Restart strategies to try: [['sh', '-c', 'kill -INT 1'], ['sh', '-c', 'kill -2 1'], ['sh', '-c', 'kill -TERM 1'], ['sh', '-c', 'kill -9 1']]
[2025-10-09T11:49:53.837+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #1: sh -c kill -INT 1
[2025-10-09T11:49:53.838+0000] {docker.py:438} INFO -    [DEBUG] Exec stream opened successfully, running command...
[2025-10-09T11:49:53.838+0000] {docker.py:438} INFO -    [DEBUG] run_forever returned/finished
[2025-10-09T11:49:53.839+0000] {docker.py:438} INFO -    üì§ [DEBUG] STDOUT (truncated): 
[2025-10-09T11:49:53.840+0000] {docker.py:438} INFO -    üì§ [DEBUG] STDERR (truncated): 
[2025-10-09T11:49:53.840+0000] {docker.py:438} INFO -    üì§ [DEBUG] CTRL_ERR: {"metadata":{},"status":"Success"}
[2025-10-09T11:49:53.840+0000] {docker.py:438} INFO -    ‚è≥ [DEBUG] Waiting up to 60s for restart count to increment...
[2025-10-09T11:49:53.841+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:49:53.841+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:49:53.843+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 51
[2025-10-09T11:49:53.844+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=51
[2025-10-09T11:49:53.844+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 51 (before was 51)
[2025-10-09T11:49:53.846+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:49:53.847+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:49:53.847+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 51
[2025-10-09T11:49:53.849+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=51
[2025-10-09T11:49:53.849+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 51 (before was 51)
[2025-10-09T11:49:53.850+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:49:53.850+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:49:53.851+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 51
[2025-10-09T11:49:53.852+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=51
[2025-10-09T11:49:53.852+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 51 (before was 51)
[2025-10-09T11:49:53.854+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:49:53.855+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:49:53.855+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 51
[2025-10-09T11:49:53.855+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=51
[2025-10-09T11:49:53.855+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 51 (before was 51)
[2025-10-09T11:49:53.856+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:49:53.856+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:49:53.856+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 51
[2025-10-09T11:49:53.856+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=51
[2025-10-09T11:49:53.857+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 51 (before was 51)
[2025-10-09T11:49:53.857+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:49:53.859+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:49:53.859+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 51
[2025-10-09T11:49:53.860+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=51
[2025-10-09T11:49:53.860+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 51 (before was 51)
[2025-10-09T11:49:53.860+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:49:53.861+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:49:53.861+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 51
[2025-10-09T11:49:53.861+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=51
[2025-10-09T11:49:53.861+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 51 (before was 51)
[2025-10-09T11:49:53.862+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:49:53.862+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:49:53.862+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 51
[2025-10-09T11:49:53.863+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=51
[2025-10-09T11:49:53.863+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 51 (before was 51)
[2025-10-09T11:49:53.863+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:49:53.864+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:49:53.865+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 51
[2025-10-09T11:49:56.871+0000] {job.py:254} ERROR - Job heartbeat failed with error. Scheduler is in unhealthy state
[2025-10-09T11:50:01.937+0000] {job.py:229} INFO - Heartbeat recovered after 40.08 seconds
[2025-10-09T11:51:08.455+0000] {job.py:239} ERROR - Job heartbeat failed with error
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (127.0.0.1), port 5433 failed: FATAL:  the database system is in recovery mode


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/jobs/job.py", line 207, in heartbeat
    self._merge_from(Job._fetch_from_db(self, session))
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/retries.py", line 93, in wrapped_function
    for attempt in run_with_db_retries(max_retries=retries, logger=logger, **retry_kwargs):
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/retries.py", line 102, in wrapped_function
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/jobs/job.py", line 335, in _fetch_from_db
    session.merge(job)
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3056, in merge
    return self._merge(
           ^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3136, in _merge
    merged = self.get(
             ^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2853, in get
    return self._get_impl(
           ^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2975, in _get_impl
    return db_load_fn(
           ^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/loading.py", line 530, in load_on_pk_identity
    session.execute(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 750, in _connection_for_bind
    conn = bind.connect()
           ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/future/engine.py", line 412, in connect
    return super(Engine, self).connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3325, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3404, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3374, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2208, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: FATAL:  the database system is in recovery mode

(Background on this error at: https://sqlalche.me/e/14/e3q8)
[2025-10-09T11:51:09.612+0000] {job.py:254} ERROR - Job heartbeat failed with error. Scheduler is in unhealthy state
[2025-10-09T11:51:11.764+0000] {docker.py:438} INFO - ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=51
[2025-10-09T11:51:11.764+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 51 (before was 51)
[2025-10-09T11:51:11.765+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:51:11.765+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:51:11.769+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 51
[2025-10-09T11:51:11.769+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=51
[2025-10-09T11:51:11.770+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 51 (before was 51)
[2025-10-09T11:51:11.771+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:51:11.771+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:51:11.773+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 51
[2025-10-09T11:51:11.774+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=51
[2025-10-09T11:51:11.774+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 51 (before was 51)
[2025-10-09T11:51:11.774+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:51:11.775+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:51:11.778+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 51
[2025-10-09T11:51:11.780+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=51
[2025-10-09T11:51:11.780+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 51 (before was 51)
[2025-10-09T11:51:11.781+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:51:11.781+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:51:11.782+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 51
[2025-10-09T11:51:11.782+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=51
[2025-10-09T11:51:11.783+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 51 (before was 51)
[2025-10-09T11:51:11.783+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:51:11.784+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:51:11.785+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 51
[2025-10-09T11:51:11.785+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=51
[2025-10-09T11:51:11.786+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 51 (before was 51)
[2025-10-09T11:51:11.788+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:51:11.788+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:51:11.789+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 51
[2025-10-09T11:51:11.789+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=51
[2025-10-09T11:51:11.789+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 51 (before was 51)
[2025-10-09T11:51:11.789+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:51:11.790+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:51:11.790+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 51
[2025-10-09T11:51:11.792+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=51
[2025-10-09T11:51:11.792+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 51 (before was 51)
[2025-10-09T11:51:11.794+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:51:11.795+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:51:11.795+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 51
[2025-10-09T11:51:11.796+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=51
[2025-10-09T11:51:11.796+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 51 (before was 51)
[2025-10-09T11:51:11.797+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:51:11.798+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:51:11.799+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 51
[2025-10-09T11:51:11.799+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=51
[2025-10-09T11:51:11.801+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 51 (before was 51)
[2025-10-09T11:51:11.801+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:51:11.802+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:51:11.802+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 51
[2025-10-09T11:51:11.803+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=51
[2025-10-09T11:51:11.803+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 51 (before was 51)
[2025-10-09T11:51:11.804+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:51:11.805+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:51:11.806+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 51
[2025-10-09T11:51:11.807+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=51
[2025-10-09T11:51:11.807+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 51 (before was 51)
[2025-10-09T11:51:11.807+0000] {docker.py:438} INFO -    ‚ö†Ô∏è [DEBUG] This strategy did not result in a restart, going to next strategy if any
[2025-10-09T11:51:11.808+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #2: sh -c kill -2 1
[2025-10-09T11:51:11.811+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:51:11.812+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:50:19 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:51:11.813+0000] {docker.py:438} INFO - 
[2025-10-09T11:51:11.814+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #3: sh -c kill -TERM 1
[2025-10-09T11:51:11.817+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:51:11.817+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:50:19 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:51:11.818+0000] {docker.py:438} INFO - 
[2025-10-09T11:51:11.818+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #4: sh -c kill -9 1
[2025-10-09T11:51:11.820+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:51:11.820+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:50:20 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:51:11.821+0000] {docker.py:438} INFO - 
[2025-10-09T11:51:11.821+0000] {docker.py:438} INFO - ‚ùå [DEBUG] All strategies exhausted for pod compose-post-service-67bcfcd5ff-bqrz2 and no restart observed
[2025-10-09T11:51:11.822+0000] {docker.py:438} INFO - 
[2025-10-09T11:51:11.823+0000] {docker.py:438} INFO - üèÅ [DEBUG] restart_containers() finished. Processed 1 pods
[2025-10-09T11:51:11.823+0000] {docker.py:438} INFO -    [DEBUG] restart_containers returned 1 entries
[2025-10-09T11:51:11.825+0000] {docker.py:438} INFO - ‚úÖ [DEBUG] Successfully restarted this cycle: 0
[2025-10-09T11:51:11.826+0000] {docker.py:438} INFO - ‚ùå [DEBUG] Failed restarts this cycle: 1
[2025-10-09T11:51:11.826+0000] {docker.py:438} INFO -    - compose-post-service-67bcfcd5ff-bqrz2 status=restart_failed details={'pod_name': 'compose-post-service-67bcfcd5ff-bqrz2', 'container_name': 'compose-post-service', 'status': 'restart_failed', 'before_count': 51, 'stdout': '', 'stderr': '', 'ctrl_err': '{"metadata":{},"status":"Success"}'}
[2025-10-09T11:51:11.826+0000] {docker.py:438} INFO - ‚è≥ [DEBUG] Waiting 5 seconds until next cycle. Time remaining: 202s
[2025-10-09T11:51:11.827+0000] {docker.py:438} INFO - 
[2025-10-09T11:51:11.827+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T11:51:11.828+0000] {docker.py:438} INFO - üîÑ [DEBUG] Container Restart Cycle #6 at 2025-10-09 11:50:25
[2025-10-09T11:51:11.828+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T11:51:11.829+0000] {docker.py:438} INFO - üîÑ [DEBUG] Entered restart_containers()
[2025-10-09T11:51:11.830+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, qty=2, rand=True, mode=fixed, ns=default, order=alphabetic, container_name=compose-post-service, restart_command=None
[2025-10-09T11:51:11.831+0000] {docker.py:438} INFO - üîë [DEBUG] Kubernetes API client created
[2025-10-09T11:51:11.832+0000] {docker.py:438} INFO - üîç [DEBUG] Selecting pods now...
[2025-10-09T11:51:11.833+0000] {docker.py:438} INFO - üîç [DEBUG] Entered _select_pods()
[2025-10-09T11:51:11.833+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, all=False, rand=True, mode=fixed, qty=2, ns=default, order=alphabetic
[2025-10-09T11:51:11.833+0000] {docker.py:438} INFO -    [DEBUG] Listing pods with label_selector=app=compose-post-service
[2025-10-09T11:51:11.835+0000] {docker.py:438} INFO - üìã [DEBUG] Found 1 pods initially
[2025-10-09T11:51:11.836+0000] {docker.py:438} INFO - üé≤ [DEBUG] Random selection chosen: 1 pods
[2025-10-09T11:51:11.837+0000] {docker.py:438} INFO - ‚úÖ [DEBUG] Selected pods: ['compose-post-service-67bcfcd5ff-bqrz2']
[2025-10-09T11:51:11.838+0000] {docker.py:438} INFO - üìã [DEBUG] Pods selected: 1
[2025-10-09T11:51:11.838+0000] {docker.py:438} INFO - 
[2025-10-09T11:51:11.838+0000] {docker.py:438} INFO - üéØ [DEBUG] Processing pod: compose-post-service-67bcfcd5ff-bqrz2
[2025-10-09T11:51:11.839+0000] {docker.py:438} INFO - üì¶ [DEBUG] Using provided container: compose-post-service
[2025-10-09T11:51:11.839+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:51:11.839+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:51:11.840+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 52
[2025-10-09T11:51:11.841+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=52
[2025-10-09T11:51:11.842+0000] {docker.py:438} INFO - üìä [DEBUG] Restart count before action: 52
[2025-10-09T11:51:11.842+0000] {docker.py:438} INFO - üîß [DEBUG] Restart strategies to try: [['sh', '-c', 'kill -INT 1'], ['sh', '-c', 'kill -2 1'], ['sh', '-c', 'kill -TERM 1'], ['sh', '-c', 'kill -9 1']]
[2025-10-09T11:51:11.844+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #1: sh -c kill -INT 1
[2025-10-09T11:51:11.845+0000] {docker.py:438} INFO -    [DEBUG] Exec stream opened successfully, running command...
[2025-10-09T11:51:11.845+0000] {docker.py:438} INFO -    [DEBUG] run_forever returned/finished
[2025-10-09T11:51:11.845+0000] {docker.py:438} INFO -    üì§ [DEBUG] STDOUT (truncated): 
[2025-10-09T11:51:11.846+0000] {docker.py:438} INFO -    üì§ [DEBUG] STDERR (truncated): 
[2025-10-09T11:51:11.846+0000] {docker.py:438} INFO -    üì§ [DEBUG] CTRL_ERR: {"metadata":{},"status":"Success"}
[2025-10-09T11:51:11.847+0000] {docker.py:438} INFO -    ‚è≥ [DEBUG] Waiting up to 60s for restart count to increment...
[2025-10-09T11:51:11.848+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:51:11.849+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:51:11.849+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 52
[2025-10-09T11:51:11.850+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=52
[2025-10-09T11:51:11.851+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 52 (before was 52)
[2025-10-09T11:51:11.851+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:51:15.289+0000] {job.py:254} ERROR - Job heartbeat failed with error. Scheduler is in unhealthy state
[2025-10-09T11:51:20.343+0000] {job.py:229} INFO - Heartbeat recovered after 57.71 seconds
[2025-10-09T11:51:57.046+0000] {job.py:239} ERROR - Job heartbeat failed with error
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (127.0.0.1), port 5433 failed: FATAL:  the database system is in recovery mode


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/jobs/job.py", line 207, in heartbeat
    self._merge_from(Job._fetch_from_db(self, session))
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/retries.py", line 93, in wrapped_function
    for attempt in run_with_db_retries(max_retries=retries, logger=logger, **retry_kwargs):
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/retries.py", line 102, in wrapped_function
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/jobs/job.py", line 335, in _fetch_from_db
    session.merge(job)
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3056, in merge
    return self._merge(
           ^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3136, in _merge
    merged = self.get(
             ^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2853, in get
    return self._get_impl(
           ^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2975, in _get_impl
    return db_load_fn(
           ^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/loading.py", line 530, in load_on_pk_identity
    session.execute(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 750, in _connection_for_bind
    conn = bind.connect()
           ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/future/engine.py", line 412, in connect
    return super(Engine, self).connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3325, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3404, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3374, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2208, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: FATAL:  the database system is in recovery mode

(Background on this error at: https://sqlalche.me/e/14/e3q8)
[2025-10-09T11:51:57.704+0000] {job.py:254} ERROR - Job heartbeat failed with error. Scheduler is in unhealthy state
[2025-10-09T11:52:02.783+0000] {job.py:229} INFO - Heartbeat recovered after 27.05 seconds
[2025-10-09T11:52:11.109+0000] {docker.py:438} INFO - [DEBUG] Found 1 container_status entries
[2025-10-09T11:52:11.110+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 52
[2025-10-09T11:52:11.110+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=52
[2025-10-09T11:52:11.112+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 52 (before was 52)
[2025-10-09T11:52:11.113+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:52:11.113+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:52:11.113+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 52
[2025-10-09T11:52:11.114+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=52
[2025-10-09T11:52:11.114+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 52 (before was 52)
[2025-10-09T11:52:11.118+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:52:11.118+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:52:11.119+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 52
[2025-10-09T11:52:11.119+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=52
[2025-10-09T11:52:11.121+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 52 (before was 52)
[2025-10-09T11:52:11.122+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:52:11.122+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:52:11.122+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 52
[2025-10-09T11:52:11.123+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=52
[2025-10-09T11:52:11.123+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 52 (before was 52)
[2025-10-09T11:52:11.124+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:52:11.125+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:52:11.125+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 52
[2025-10-09T11:52:11.126+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=52
[2025-10-09T11:52:11.127+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 52 (before was 52)
[2025-10-09T11:52:11.127+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:52:11.129+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:52:11.129+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 52
[2025-10-09T11:52:11.129+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=52
[2025-10-09T11:52:11.130+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 52 (before was 52)
[2025-10-09T11:52:11.130+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:52:11.132+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:52:11.133+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 52
[2025-10-09T11:52:11.133+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=52
[2025-10-09T11:52:11.133+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 52 (before was 52)
[2025-10-09T11:52:11.134+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:52:11.134+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:52:11.137+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 52
[2025-10-09T11:52:11.138+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=52
[2025-10-09T11:52:11.138+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 52 (before was 52)
[2025-10-09T11:52:11.139+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:52:11.139+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:52:11.140+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 52
[2025-10-09T11:52:11.141+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=52
[2025-10-09T11:52:11.141+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 52 (before was 52)
[2025-10-09T11:52:11.141+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:52:11.142+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:52:11.142+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 52
[2025-10-09T11:52:11.145+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=52
[2025-10-09T11:52:11.146+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 52 (before was 52)
[2025-10-09T11:52:11.146+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:52:11.147+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:52:11.147+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 52
[2025-10-09T11:52:11.148+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=52
[2025-10-09T11:52:11.149+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 52 (before was 52)
[2025-10-09T11:52:11.150+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:52:11.151+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:52:11.153+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 52
[2025-10-09T11:52:11.154+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=52
[2025-10-09T11:52:11.154+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 52 (before was 52)
[2025-10-09T11:52:11.154+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:52:11.155+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:52:11.155+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 52
[2025-10-09T11:52:11.157+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=52
[2025-10-09T11:52:11.157+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 52 (before was 52)
[2025-10-09T11:52:11.160+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:52:11.161+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:52:11.161+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 52
[2025-10-09T11:52:11.162+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=52
[2025-10-09T11:52:11.162+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 52 (before was 52)
[2025-10-09T11:52:11.162+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:52:11.163+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:52:11.164+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 52
[2025-10-09T11:52:11.165+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=52
[2025-10-09T11:52:11.165+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 52 (before was 52)
[2025-10-09T11:52:11.166+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:52:11.167+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:52:11.169+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 52
[2025-10-09T11:52:11.169+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=52
[2025-10-09T11:52:11.169+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 52 (before was 52)
[2025-10-09T11:52:11.170+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:52:11.170+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:52:11.172+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 52
[2025-10-09T11:52:11.173+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=52
[2025-10-09T11:52:11.174+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 52 (before was 52)
[2025-10-09T11:52:11.175+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:52:11.175+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:52:11.176+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 52
[2025-10-09T11:52:11.177+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=52
[2025-10-09T11:52:11.177+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 52 (before was 52)
[2025-10-09T11:52:11.177+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:52:11.178+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:52:11.179+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 52
[2025-10-09T11:52:11.180+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=52
[2025-10-09T11:52:11.180+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 52 (before was 52)
[2025-10-09T11:52:11.180+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:52:11.181+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:52:11.181+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 52
[2025-10-09T11:52:11.183+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=52
[2025-10-09T11:52:11.184+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 52 (before was 52)
[2025-10-09T11:52:11.184+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:52:11.184+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:52:11.185+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 52
[2025-10-09T11:52:11.187+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=52
[2025-10-09T11:52:11.188+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 52 (before was 52)
[2025-10-09T11:52:11.188+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:52:11.190+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:52:11.191+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 52
[2025-10-09T11:52:11.191+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=52
[2025-10-09T11:52:11.191+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 52 (before was 52)
[2025-10-09T11:52:11.192+0000] {docker.py:438} INFO -    ‚ö†Ô∏è [DEBUG] This strategy did not result in a restart, going to next strategy if any
[2025-10-09T11:52:11.192+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #2: sh -c kill -2 1
[2025-10-09T11:52:11.192+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:52:11.193+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:52:11 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:52:26.599+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #3: sh -c kill -TERM 1
[2025-10-09T11:52:26.606+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:52:26.607+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:52:11 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:52:26.607+0000] {docker.py:438} INFO - 
[2025-10-09T11:52:26.607+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #4: sh -c kill -9 1
[2025-10-09T11:52:26.608+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:52:26.608+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:52:11 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:52:26.610+0000] {docker.py:438} INFO - 
[2025-10-09T11:52:26.611+0000] {docker.py:438} INFO - ‚ùå [DEBUG] All strategies exhausted for pod compose-post-service-67bcfcd5ff-bqrz2 and no restart observed
[2025-10-09T11:52:26.611+0000] {docker.py:438} INFO - 
[2025-10-09T11:52:26.615+0000] {docker.py:438} INFO - üèÅ [DEBUG] restart_containers() finished. Processed 1 pods
[2025-10-09T11:52:26.616+0000] {docker.py:438} INFO -    [DEBUG] restart_containers returned 1 entries
[2025-10-09T11:52:26.616+0000] {docker.py:438} INFO - ‚úÖ [DEBUG] Successfully restarted this cycle: 0
[2025-10-09T11:52:26.616+0000] {docker.py:438} INFO - ‚ùå [DEBUG] Failed restarts this cycle: 1
[2025-10-09T11:52:26.617+0000] {docker.py:438} INFO -    - compose-post-service-67bcfcd5ff-bqrz2 status=restart_failed details={'pod_name': 'compose-post-service-67bcfcd5ff-bqrz2', 'container_name': 'compose-post-service', 'status': 'restart_failed', 'before_count': 52, 'stdout': '', 'stderr': '', 'ctrl_err': '{"metadata":{},"status":"Success"}'}
[2025-10-09T11:52:26.617+0000] {docker.py:438} INFO - ‚è≥ [DEBUG] Waiting 5 seconds until next cycle. Time remaining: 90s
[2025-10-09T11:52:26.617+0000] {docker.py:438} INFO - 
[2025-10-09T11:52:26.618+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T11:52:26.618+0000] {docker.py:438} INFO - üîÑ [DEBUG] Container Restart Cycle #7 at 2025-10-09 11:52:16
[2025-10-09T11:52:26.618+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T11:52:26.623+0000] {docker.py:438} INFO - üîÑ [DEBUG] Entered restart_containers()
[2025-10-09T11:52:26.623+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, qty=2, rand=True, mode=fixed, ns=default, order=alphabetic, container_name=compose-post-service, restart_command=None
[2025-10-09T11:52:26.623+0000] {docker.py:438} INFO - üîë [DEBUG] Kubernetes API client created
[2025-10-09T11:52:26.624+0000] {docker.py:438} INFO - üîç [DEBUG] Selecting pods now...
[2025-10-09T11:52:26.624+0000] {docker.py:438} INFO - üîç [DEBUG] Entered _select_pods()
[2025-10-09T11:52:26.628+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, all=False, rand=True, mode=fixed, qty=2, ns=default, order=alphabetic
[2025-10-09T11:52:26.629+0000] {docker.py:438} INFO -    [DEBUG] Listing pods with label_selector=app=compose-post-service
[2025-10-09T11:52:26.629+0000] {docker.py:438} INFO - üìã [DEBUG] Found 1 pods initially
[2025-10-09T11:52:26.631+0000] {docker.py:438} INFO - üé≤ [DEBUG] Random selection chosen: 1 pods
[2025-10-09T11:52:26.632+0000] {docker.py:438} INFO - ‚úÖ [DEBUG] Selected pods: ['compose-post-service-67bcfcd5ff-bqrz2']
[2025-10-09T11:52:26.633+0000] {docker.py:438} INFO - üìã [DEBUG] Pods selected: 1
[2025-10-09T11:52:26.633+0000] {docker.py:438} INFO - 
[2025-10-09T11:52:26.633+0000] {docker.py:438} INFO - üéØ [DEBUG] Processing pod: compose-post-service-67bcfcd5ff-bqrz2
[2025-10-09T11:52:26.634+0000] {docker.py:438} INFO - üì¶ [DEBUG] Using provided container: compose-post-service
[2025-10-09T11:52:26.634+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:52:26.637+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:52:26.637+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 52
[2025-10-09T11:52:26.637+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=52
[2025-10-09T11:52:26.638+0000] {docker.py:438} INFO - üìä [DEBUG] Restart count before action: 52
[2025-10-09T11:52:26.638+0000] {docker.py:438} INFO - üîß [DEBUG] Restart strategies to try: [['sh', '-c', 'kill -INT 1'], ['sh', '-c', 'kill -2 1'], ['sh', '-c', 'kill -TERM 1'], ['sh', '-c', 'kill -9 1']]
[2025-10-09T11:52:26.640+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #1: sh -c kill -INT 1
[2025-10-09T11:52:26.641+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:52:26.643+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:52:18 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:52:26.644+0000] {docker.py:438} INFO - 
[2025-10-09T11:52:26.644+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #2: sh -c kill -2 1
[2025-10-09T11:52:26.644+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:52:26.645+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:52:18 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:52:26.645+0000] {docker.py:438} INFO - 
[2025-10-09T11:52:26.645+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #3: sh -c kill -TERM 1
[2025-10-09T11:52:26.645+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:52:26.646+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:52:18 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:52:26.646+0000] {docker.py:438} INFO - 
[2025-10-09T11:52:26.648+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #4: sh -c kill -9 1
[2025-10-09T11:52:26.649+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:52:26.649+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:52:19 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:52:26.649+0000] {docker.py:438} INFO - 
[2025-10-09T11:52:26.650+0000] {docker.py:438} INFO - ‚ùå [DEBUG] All strategies exhausted for pod compose-post-service-67bcfcd5ff-bqrz2 and no restart observed
[2025-10-09T11:52:26.650+0000] {docker.py:438} INFO - 
[2025-10-09T11:52:26.651+0000] {docker.py:438} INFO - üèÅ [DEBUG] restart_containers() finished. Processed 1 pods
[2025-10-09T11:52:26.652+0000] {docker.py:438} INFO -    [DEBUG] restart_containers returned 1 entries
[2025-10-09T11:52:26.652+0000] {docker.py:438} INFO - ‚úÖ [DEBUG] Successfully restarted this cycle: 0
[2025-10-09T11:52:26.655+0000] {docker.py:438} INFO - ‚ùå [DEBUG] Failed restarts this cycle: 1
[2025-10-09T11:52:26.656+0000] {docker.py:438} INFO -    - compose-post-service-67bcfcd5ff-bqrz2 status=restart_failed details={'pod_name': 'compose-post-service-67bcfcd5ff-bqrz2', 'container_name': 'compose-post-service', 'status': 'restart_failed', 'before_count': 52, 'stdout': None, 'stderr': None, 'ctrl_err': None}
[2025-10-09T11:52:26.656+0000] {docker.py:438} INFO - ‚è≥ [DEBUG] Waiting 5 seconds until next cycle. Time remaining: 83s
[2025-10-09T11:52:26.657+0000] {docker.py:438} INFO - 
[2025-10-09T11:52:26.657+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T11:52:26.657+0000] {docker.py:438} INFO - üîÑ [DEBUG] Container Restart Cycle #8 at 2025-10-09 11:52:24
[2025-10-09T11:52:26.658+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T11:52:26.658+0000] {docker.py:438} INFO - üîÑ [DEBUG] Entered restart_containers()
[2025-10-09T11:52:26.658+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, qty=2, rand=True, mode=fixed, ns=default, order=alphabetic, container_name=compose-post-service, restart_command=None
[2025-10-09T11:52:26.661+0000] {docker.py:438} INFO - üîë [DEBUG] Kubernetes API client created
[2025-10-09T11:52:26.661+0000] {docker.py:438} INFO - üîç [DEBUG] Selecting pods now...
[2025-10-09T11:52:26.662+0000] {docker.py:438} INFO - üîç [DEBUG] Entered _select_pods()
[2025-10-09T11:52:26.663+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, all=False, rand=True, mode=fixed, qty=2, ns=default, order=alphabetic
[2025-10-09T11:52:26.665+0000] {docker.py:438} INFO -    [DEBUG] Listing pods with label_selector=app=compose-post-service
[2025-10-09T11:52:26.666+0000] {docker.py:438} INFO - üìã [DEBUG] Found 1 pods initially
[2025-10-09T11:52:26.667+0000] {docker.py:438} INFO - üé≤ [DEBUG] Random selection chosen: 1 pods
[2025-10-09T11:52:26.669+0000] {docker.py:438} INFO - ‚úÖ [DEBUG] Selected pods: ['compose-post-service-67bcfcd5ff-bqrz2']
[2025-10-09T11:52:26.670+0000] {docker.py:438} INFO - üìã [DEBUG] Pods selected: 1
[2025-10-09T11:52:26.670+0000] {docker.py:438} INFO - 
[2025-10-09T11:52:26.670+0000] {docker.py:438} INFO - üéØ [DEBUG] Processing pod: compose-post-service-67bcfcd5ff-bqrz2
[2025-10-09T11:52:26.671+0000] {docker.py:438} INFO - üì¶ [DEBUG] Using provided container: compose-post-service
[2025-10-09T11:52:26.671+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:52:26.674+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:52:26.675+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 52
[2025-10-09T11:52:26.677+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=52
[2025-10-09T11:52:26.678+0000] {docker.py:438} INFO - üìä [DEBUG] Restart count before action: 52
[2025-10-09T11:52:26.678+0000] {docker.py:438} INFO - üîß [DEBUG] Restart strategies to try: [['sh', '-c', 'kill -INT 1'], ['sh', '-c', 'kill -2 1'], ['sh', '-c', 'kill -TERM 1'], ['sh', '-c', 'kill -9 1']]
[2025-10-09T11:52:26.680+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #1: sh -c kill -INT 1
[2025-10-09T11:52:26.681+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:52:26.681+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:52:25 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:52:26.681+0000] {docker.py:438} INFO - 
[2025-10-09T11:52:26.682+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #2: sh -c kill -2 1
[2025-10-09T11:52:26.682+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:52:26.684+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:52:25 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:52:26.685+0000] {docker.py:438} INFO - 
[2025-10-09T11:52:26.685+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #3: sh -c kill -TERM 1
[2025-10-09T11:52:26.685+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:52:26.686+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:52:26 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:52:26.686+0000] {docker.py:438} INFO - 
[2025-10-09T11:52:26.688+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #4: sh -c kill -9 1
[2025-10-09T11:52:26.689+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:52:26.689+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:52:26 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:52:26.689+0000] {docker.py:438} INFO - 
[2025-10-09T11:52:26.690+0000] {docker.py:438} INFO - ‚ùå [DEBUG] All strategies exhausted for pod compose-post-service-67bcfcd5ff-bqrz2 and no restart observed
[2025-10-09T11:52:26.690+0000] {docker.py:438} INFO - 
[2025-10-09T11:52:26.692+0000] {docker.py:438} INFO - üèÅ [DEBUG] restart_containers() finished. Processed 1 pods
[2025-10-09T11:52:26.692+0000] {docker.py:438} INFO -    [DEBUG] restart_containers returned 1 entries
[2025-10-09T11:52:26.692+0000] {docker.py:438} INFO - ‚úÖ [DEBUG] Successfully restarted this cycle: 0
[2025-10-09T11:52:26.693+0000] {docker.py:438} INFO - ‚ùå [DEBUG] Failed restarts this cycle: 1
[2025-10-09T11:52:26.693+0000] {docker.py:438} INFO -    - compose-post-service-67bcfcd5ff-bqrz2 status=restart_failed details={'pod_name': 'compose-post-service-67bcfcd5ff-bqrz2', 'container_name': 'compose-post-service', 'status': 'restart_failed', 'before_count': 52, 'stdout': None, 'stderr': None, 'ctrl_err': None}
[2025-10-09T11:52:38.116+0000] {job.py:239} ERROR - Job heartbeat failed with error
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (127.0.0.1), port 5433 failed: FATAL:  the database system is in recovery mode


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/jobs/job.py", line 207, in heartbeat
    self._merge_from(Job._fetch_from_db(self, session))
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/retries.py", line 93, in wrapped_function
    for attempt in run_with_db_retries(max_retries=retries, logger=logger, **retry_kwargs):
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/retries.py", line 102, in wrapped_function
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/jobs/job.py", line 335, in _fetch_from_db
    session.merge(job)
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3056, in merge
    return self._merge(
           ^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3136, in _merge
    merged = self.get(
             ^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2853, in get
    return self._get_impl(
           ^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2975, in _get_impl
    return db_load_fn(
           ^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/loading.py", line 530, in load_on_pk_identity
    session.execute(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 750, in _connection_for_bind
    conn = bind.connect()
           ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/future/engine.py", line 412, in connect
    return super(Engine, self).connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3325, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3404, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3374, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2208, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: FATAL:  the database system is in recovery mode

(Background on this error at: https://sqlalche.me/e/14/e3q8)
[2025-10-09T11:52:39.261+0000] {job.py:254} ERROR - Job heartbeat failed with error. Scheduler is in unhealthy state
[2025-10-09T11:52:45.264+0000] {job.py:254} ERROR - Job heartbeat failed with error. Scheduler is in unhealthy state
[2025-10-09T11:52:50.318+0000] {job.py:229} INFO - Heartbeat recovered after 27.02 seconds
[2025-10-09T11:52:52.228+0000] {docker.py:438} INFO - ‚è≥ [DEBUG] Waiting 5 seconds until next cycle. Time remaining: 75s
[2025-10-09T11:52:52.229+0000] {docker.py:438} INFO - 
[2025-10-09T11:52:52.230+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T11:52:52.232+0000] {docker.py:438} INFO - üîÑ [DEBUG] Container Restart Cycle #9 at 2025-10-09 11:52:32
[2025-10-09T11:52:52.233+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T11:52:52.233+0000] {docker.py:438} INFO - üîÑ [DEBUG] Entered restart_containers()
[2025-10-09T11:52:52.233+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, qty=2, rand=True, mode=fixed, ns=default, order=alphabetic, container_name=compose-post-service, restart_command=None
[2025-10-09T11:52:52.234+0000] {docker.py:438} INFO - üîë [DEBUG] Kubernetes API client created
[2025-10-09T11:52:52.234+0000] {docker.py:438} INFO - üîç [DEBUG] Selecting pods now...
[2025-10-09T11:52:52.238+0000] {docker.py:438} INFO - üîç [DEBUG] Entered _select_pods()
[2025-10-09T11:52:52.238+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, all=False, rand=True, mode=fixed, qty=2, ns=default, order=alphabetic
[2025-10-09T11:52:52.238+0000] {docker.py:438} INFO -    [DEBUG] Listing pods with label_selector=app=compose-post-service
[2025-10-09T11:52:52.239+0000] {docker.py:438} INFO - üìã [DEBUG] Found 1 pods initially
[2025-10-09T11:52:52.243+0000] {docker.py:438} INFO - üé≤ [DEBUG] Random selection chosen: 1 pods
[2025-10-09T11:52:52.244+0000] {docker.py:438} INFO - ‚úÖ [DEBUG] Selected pods: ['compose-post-service-67bcfcd5ff-bqrz2']
[2025-10-09T11:52:52.244+0000] {docker.py:438} INFO - üìã [DEBUG] Pods selected: 1
[2025-10-09T11:52:52.245+0000] {docker.py:438} INFO - 
[2025-10-09T11:52:52.245+0000] {docker.py:438} INFO - üéØ [DEBUG] Processing pod: compose-post-service-67bcfcd5ff-bqrz2
[2025-10-09T11:52:52.248+0000] {docker.py:438} INFO - üì¶ [DEBUG] Using provided container: compose-post-service
[2025-10-09T11:52:52.248+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:52:52.249+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:52:52.249+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 52
[2025-10-09T11:52:52.249+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=52
[2025-10-09T11:52:52.250+0000] {docker.py:438} INFO - üìä [DEBUG] Restart count before action: 52
[2025-10-09T11:52:52.254+0000] {docker.py:438} INFO - üîß [DEBUG] Restart strategies to try: [['sh', '-c', 'kill -INT 1'], ['sh', '-c', 'kill -2 1'], ['sh', '-c', 'kill -TERM 1'], ['sh', '-c', 'kill -9 1']]
[2025-10-09T11:52:52.255+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #1: sh -c kill -INT 1
[2025-10-09T11:52:52.255+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:52:52.256+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:52:38 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:52:52.256+0000] {docker.py:438} INFO - 
[2025-10-09T11:52:52.260+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #2: sh -c kill -2 1
[2025-10-09T11:52:52.261+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:52:52.262+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:52:38 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:52:52.264+0000] {docker.py:438} INFO - 
[2025-10-09T11:52:52.265+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #3: sh -c kill -TERM 1
[2025-10-09T11:52:52.266+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:52:52.266+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:52:39 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:52:52.267+0000] {docker.py:438} INFO - 
[2025-10-09T11:52:52.268+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #4: sh -c kill -9 1
[2025-10-09T11:52:52.268+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:52:52.269+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:52:39 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:52:52.270+0000] {docker.py:438} INFO - 
[2025-10-09T11:52:52.270+0000] {docker.py:438} INFO - ‚ùå [DEBUG] All strategies exhausted for pod compose-post-service-67bcfcd5ff-bqrz2 and no restart observed
[2025-10-09T11:52:52.272+0000] {docker.py:438} INFO - 
[2025-10-09T11:52:52.272+0000] {docker.py:438} INFO - üèÅ [DEBUG] restart_containers() finished. Processed 1 pods
[2025-10-09T11:52:52.273+0000] {docker.py:438} INFO -    [DEBUG] restart_containers returned 1 entries
[2025-10-09T11:52:52.274+0000] {docker.py:438} INFO - ‚úÖ [DEBUG] Successfully restarted this cycle: 0
[2025-10-09T11:52:52.274+0000] {docker.py:438} INFO - ‚ùå [DEBUG] Failed restarts this cycle: 1
[2025-10-09T11:52:52.274+0000] {docker.py:438} INFO -    - compose-post-service-67bcfcd5ff-bqrz2 status=restart_failed details={'pod_name': 'compose-post-service-67bcfcd5ff-bqrz2', 'container_name': 'compose-post-service', 'status': 'restart_failed', 'before_count': 52, 'stdout': None, 'stderr': None, 'ctrl_err': None}
[2025-10-09T11:52:52.276+0000] {docker.py:438} INFO - ‚è≥ [DEBUG] Waiting 5 seconds until next cycle. Time remaining: 62s
[2025-10-09T11:52:52.277+0000] {docker.py:438} INFO - 
[2025-10-09T11:52:52.277+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T11:52:52.277+0000] {docker.py:438} INFO - üîÑ [DEBUG] Container Restart Cycle #10 at 2025-10-09 11:52:44
[2025-10-09T11:52:52.278+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T11:52:52.278+0000] {docker.py:438} INFO - üîÑ [DEBUG] Entered restart_containers()
[2025-10-09T11:52:52.279+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, qty=2, rand=True, mode=fixed, ns=default, order=alphabetic, container_name=compose-post-service, restart_command=None
[2025-10-09T11:52:52.280+0000] {docker.py:438} INFO - üîë [DEBUG] Kubernetes API client created
[2025-10-09T11:52:52.280+0000] {docker.py:438} INFO - üîç [DEBUG] Selecting pods now...
[2025-10-09T11:52:52.281+0000] {docker.py:438} INFO - üîç [DEBUG] Entered _select_pods()
[2025-10-09T11:52:52.283+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, all=False, rand=True, mode=fixed, qty=2, ns=default, order=alphabetic
[2025-10-09T11:52:52.284+0000] {docker.py:438} INFO -    [DEBUG] Listing pods with label_selector=app=compose-post-service
[2025-10-09T11:52:52.284+0000] {docker.py:438} INFO - üìã [DEBUG] Found 1 pods initially
[2025-10-09T11:52:52.284+0000] {docker.py:438} INFO - üé≤ [DEBUG] Random selection chosen: 1 pods
[2025-10-09T11:52:52.285+0000] {docker.py:438} INFO - ‚úÖ [DEBUG] Selected pods: ['compose-post-service-67bcfcd5ff-bqrz2']
[2025-10-09T11:52:52.285+0000] {docker.py:438} INFO - üìã [DEBUG] Pods selected: 1
[2025-10-09T11:52:52.286+0000] {docker.py:438} INFO - 
[2025-10-09T11:52:52.287+0000] {docker.py:438} INFO - üéØ [DEBUG] Processing pod: compose-post-service-67bcfcd5ff-bqrz2
[2025-10-09T11:52:52.287+0000] {docker.py:438} INFO - üì¶ [DEBUG] Using provided container: compose-post-service
[2025-10-09T11:52:52.288+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:52:52.289+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:52:52.289+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 52
[2025-10-09T11:52:52.290+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=52
[2025-10-09T11:52:52.291+0000] {docker.py:438} INFO - üìä [DEBUG] Restart count before action: 52
[2025-10-09T11:52:52.291+0000] {docker.py:438} INFO - üîß [DEBUG] Restart strategies to try: [['sh', '-c', 'kill -INT 1'], ['sh', '-c', 'kill -2 1'], ['sh', '-c', 'kill -TERM 1'], ['sh', '-c', 'kill -9 1']]
[2025-10-09T11:52:52.292+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #1: sh -c kill -INT 1
[2025-10-09T11:52:52.293+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:52:52.293+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:52:45 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:52:52.293+0000] {docker.py:438} INFO - 
[2025-10-09T11:52:52.294+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #2: sh -c kill -2 1
[2025-10-09T11:52:52.296+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:52:52.297+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:52:45 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:52:52.297+0000] {docker.py:438} INFO - 
[2025-10-09T11:52:52.297+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #3: sh -c kill -TERM 1
[2025-10-09T11:52:52.298+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:52:52.298+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:52:46 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:52:52.299+0000] {docker.py:438} INFO - 
[2025-10-09T11:52:52.300+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #4: sh -c kill -9 1
[2025-10-09T11:52:52.300+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:52:52.300+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:52:46 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:52:52.300+0000] {docker.py:438} INFO - 
[2025-10-09T11:52:52.301+0000] {docker.py:438} INFO - ‚ùå [DEBUG] All strategies exhausted for pod compose-post-service-67bcfcd5ff-bqrz2 and no restart observed
[2025-10-09T11:52:52.301+0000] {docker.py:438} INFO - 
[2025-10-09T11:52:52.304+0000] {docker.py:438} INFO - üèÅ [DEBUG] restart_containers() finished. Processed 1 pods
[2025-10-09T11:52:52.305+0000] {docker.py:438} INFO -    [DEBUG] restart_containers returned 1 entries
[2025-10-09T11:52:52.306+0000] {docker.py:438} INFO - ‚úÖ [DEBUG] Successfully restarted this cycle: 0
[2025-10-09T11:52:52.306+0000] {docker.py:438} INFO - ‚ùå [DEBUG] Failed restarts this cycle: 1
[2025-10-09T11:52:52.308+0000] {docker.py:438} INFO -    - compose-post-service-67bcfcd5ff-bqrz2 status=restart_failed details={'pod_name': 'compose-post-service-67bcfcd5ff-bqrz2', 'container_name': 'compose-post-service', 'status': 'restart_failed', 'before_count': 52, 'stdout': None, 'stderr': None, 'ctrl_err': None}
[2025-10-09T11:52:52.309+0000] {docker.py:438} INFO - ‚è≥ [DEBUG] Waiting 5 seconds until next cycle. Time remaining: 55s
[2025-10-09T11:52:52.309+0000] {docker.py:438} INFO - 
[2025-10-09T11:52:52.309+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T11:52:52.310+0000] {docker.py:438} INFO - üîÑ [DEBUG] Container Restart Cycle #11 at 2025-10-09 11:52:51
[2025-10-09T11:52:52.310+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T11:52:52.310+0000] {docker.py:438} INFO - üîÑ [DEBUG] Entered restart_containers()
[2025-10-09T11:52:52.312+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, qty=2, rand=True, mode=fixed, ns=default, order=alphabetic, container_name=compose-post-service, restart_command=None
[2025-10-09T11:52:52.312+0000] {docker.py:438} INFO - üîë [DEBUG] Kubernetes API client created
[2025-10-09T11:52:52.314+0000] {docker.py:438} INFO - üîç [DEBUG] Selecting pods now...
[2025-10-09T11:52:52.315+0000] {docker.py:438} INFO - üîç [DEBUG] Entered _select_pods()
[2025-10-09T11:52:52.316+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, all=False, rand=True, mode=fixed, qty=2, ns=default, order=alphabetic
[2025-10-09T11:52:52.316+0000] {docker.py:438} INFO -    [DEBUG] Listing pods with label_selector=app=compose-post-service
[2025-10-09T11:52:52.317+0000] {docker.py:438} INFO - üìã [DEBUG] Found 1 pods initially
[2025-10-09T11:52:52.317+0000] {docker.py:438} INFO - üé≤ [DEBUG] Random selection chosen: 1 pods
[2025-10-09T11:52:52.318+0000] {docker.py:438} INFO - ‚úÖ [DEBUG] Selected pods: ['compose-post-service-67bcfcd5ff-bqrz2']
[2025-10-09T11:52:52.319+0000] {docker.py:438} INFO - üìã [DEBUG] Pods selected: 1
[2025-10-09T11:52:52.320+0000] {docker.py:438} INFO - 
[2025-10-09T11:52:52.320+0000] {docker.py:438} INFO - üéØ [DEBUG] Processing pod: compose-post-service-67bcfcd5ff-bqrz2
[2025-10-09T11:53:14.315+0000] {job.py:239} ERROR - Job heartbeat failed with error
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (127.0.0.1), port 5433 failed: FATAL:  the database system is in recovery mode


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/jobs/job.py", line 207, in heartbeat
    self._merge_from(Job._fetch_from_db(self, session))
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/retries.py", line 93, in wrapped_function
    for attempt in run_with_db_retries(max_retries=retries, logger=logger, **retry_kwargs):
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/retries.py", line 102, in wrapped_function
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/jobs/job.py", line 335, in _fetch_from_db
    session.merge(job)
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3056, in merge
    return self._merge(
           ^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3136, in _merge
    merged = self.get(
             ^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2853, in get
    return self._get_impl(
           ^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2975, in _get_impl
    return db_load_fn(
           ^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/loading.py", line 530, in load_on_pk_identity
    session.execute(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 750, in _connection_for_bind
    conn = bind.connect()
           ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/future/engine.py", line 412, in connect
    return super(Engine, self).connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3325, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3404, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3374, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2208, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: FATAL:  the database system is in recovery mode

(Background on this error at: https://sqlalche.me/e/14/e3q8)
[2025-10-09T11:53:14.817+0000] {docker.py:438} INFO - üì¶ [DEBUG] Using provided container: compose-post-service
[2025-10-09T11:53:14.855+0000] {job.py:254} ERROR - Job heartbeat failed with error. Scheduler is in unhealthy state
[2025-10-09T11:53:14.856+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:53:14.856+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:53:14.857+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 52
[2025-10-09T11:53:14.857+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=52
[2025-10-09T11:53:14.857+0000] {docker.py:438} INFO - üìä [DEBUG] Restart count before action: 52
[2025-10-09T11:53:14.857+0000] {docker.py:438} INFO - üîß [DEBUG] Restart strategies to try: [['sh', '-c', 'kill -INT 1'], ['sh', '-c', 'kill -2 1'], ['sh', '-c', 'kill -TERM 1'], ['sh', '-c', 'kill -9 1']]
[2025-10-09T11:53:14.857+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #1: sh -c kill -INT 1
[2025-10-09T11:53:14.858+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:53:14.858+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:52:52 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:53:14.858+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:14.858+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #2: sh -c kill -2 1
[2025-10-09T11:53:14.859+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:53:14.859+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:52:53 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:53:14.859+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:14.859+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #3: sh -c kill -TERM 1
[2025-10-09T11:53:14.859+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:53:14.860+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:52:53 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:53:14.860+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:14.860+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #4: sh -c kill -9 1
[2025-10-09T11:53:14.860+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:53:14.860+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:52:53 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:53:14.861+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:14.861+0000] {docker.py:438} INFO - ‚ùå [DEBUG] All strategies exhausted for pod compose-post-service-67bcfcd5ff-bqrz2 and no restart observed
[2025-10-09T11:53:14.861+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:14.862+0000] {docker.py:438} INFO - üèÅ [DEBUG] restart_containers() finished. Processed 1 pods
[2025-10-09T11:53:14.862+0000] {docker.py:438} INFO -    [DEBUG] restart_containers returned 1 entries
[2025-10-09T11:53:14.862+0000] {docker.py:438} INFO - ‚úÖ [DEBUG] Successfully restarted this cycle: 0
[2025-10-09T11:53:14.862+0000] {docker.py:438} INFO - ‚ùå [DEBUG] Failed restarts this cycle: 1
[2025-10-09T11:53:14.863+0000] {docker.py:438} INFO -    - compose-post-service-67bcfcd5ff-bqrz2 status=restart_failed details={'pod_name': 'compose-post-service-67bcfcd5ff-bqrz2', 'container_name': 'compose-post-service', 'status': 'restart_failed', 'before_count': 52, 'stdout': None, 'stderr': None, 'ctrl_err': None}
[2025-10-09T11:53:14.863+0000] {docker.py:438} INFO - ‚è≥ [DEBUG] Waiting 5 seconds until next cycle. Time remaining: 48s
[2025-10-09T11:53:14.863+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:14.863+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T11:53:14.863+0000] {docker.py:438} INFO - üîÑ [DEBUG] Container Restart Cycle #12 at 2025-10-09 11:52:58
[2025-10-09T11:53:14.864+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T11:53:14.864+0000] {docker.py:438} INFO - üîÑ [DEBUG] Entered restart_containers()
[2025-10-09T11:53:14.864+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, qty=2, rand=True, mode=fixed, ns=default, order=alphabetic, container_name=compose-post-service, restart_command=None
[2025-10-09T11:53:14.864+0000] {docker.py:438} INFO - üîë [DEBUG] Kubernetes API client created
[2025-10-09T11:53:14.864+0000] {docker.py:438} INFO - üîç [DEBUG] Selecting pods now...
[2025-10-09T11:53:14.865+0000] {docker.py:438} INFO - üîç [DEBUG] Entered _select_pods()
[2025-10-09T11:53:14.865+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, all=False, rand=True, mode=fixed, qty=2, ns=default, order=alphabetic
[2025-10-09T11:53:14.865+0000] {docker.py:438} INFO -    [DEBUG] Listing pods with label_selector=app=compose-post-service
[2025-10-09T11:53:14.865+0000] {docker.py:438} INFO - üìã [DEBUG] Found 1 pods initially
[2025-10-09T11:53:14.865+0000] {docker.py:438} INFO - üé≤ [DEBUG] Random selection chosen: 1 pods
[2025-10-09T11:53:14.866+0000] {docker.py:438} INFO - ‚úÖ [DEBUG] Selected pods: ['compose-post-service-67bcfcd5ff-bqrz2']
[2025-10-09T11:53:14.866+0000] {docker.py:438} INFO - üìã [DEBUG] Pods selected: 1
[2025-10-09T11:53:14.866+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:14.866+0000] {docker.py:438} INFO - üéØ [DEBUG] Processing pod: compose-post-service-67bcfcd5ff-bqrz2
[2025-10-09T11:53:14.866+0000] {docker.py:438} INFO - üì¶ [DEBUG] Using provided container: compose-post-service
[2025-10-09T11:53:14.867+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:53:14.867+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:53:14.867+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 52
[2025-10-09T11:53:14.867+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=52
[2025-10-09T11:53:14.867+0000] {docker.py:438} INFO - üìä [DEBUG] Restart count before action: 52
[2025-10-09T11:53:14.867+0000] {docker.py:438} INFO - üîß [DEBUG] Restart strategies to try: [['sh', '-c', 'kill -INT 1'], ['sh', '-c', 'kill -2 1'], ['sh', '-c', 'kill -TERM 1'], ['sh', '-c', 'kill -9 1']]
[2025-10-09T11:53:14.868+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #1: sh -c kill -INT 1
[2025-10-09T11:53:14.868+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:53:14.868+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:52:59 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:53:14.868+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:14.868+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #2: sh -c kill -2 1
[2025-10-09T11:53:14.869+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:53:14.869+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:53:00 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:53:14.869+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:14.869+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #3: sh -c kill -TERM 1
[2025-10-09T11:53:14.869+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:53:14.870+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:53:00 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:53:14.870+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:14.870+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #4: sh -c kill -9 1
[2025-10-09T11:53:14.870+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:53:14.870+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:53:00 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:53:14.871+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:14.871+0000] {docker.py:438} INFO - ‚ùå [DEBUG] All strategies exhausted for pod compose-post-service-67bcfcd5ff-bqrz2 and no restart observed
[2025-10-09T11:53:14.871+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:14.871+0000] {docker.py:438} INFO - üèÅ [DEBUG] restart_containers() finished. Processed 1 pods
[2025-10-09T11:53:14.872+0000] {docker.py:438} INFO -    [DEBUG] restart_containers returned 1 entries
[2025-10-09T11:53:14.872+0000] {docker.py:438} INFO - ‚úÖ [DEBUG] Successfully restarted this cycle: 0
[2025-10-09T11:53:14.872+0000] {docker.py:438} INFO - ‚ùå [DEBUG] Failed restarts this cycle: 1
[2025-10-09T11:53:14.872+0000] {docker.py:438} INFO -    - compose-post-service-67bcfcd5ff-bqrz2 status=restart_failed details={'pod_name': 'compose-post-service-67bcfcd5ff-bqrz2', 'container_name': 'compose-post-service', 'status': 'restart_failed', 'before_count': 52, 'stdout': None, 'stderr': None, 'ctrl_err': None}
[2025-10-09T11:53:14.873+0000] {docker.py:438} INFO - ‚è≥ [DEBUG] Waiting 5 seconds until next cycle. Time remaining: 41s
[2025-10-09T11:53:14.873+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:14.873+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T11:53:14.873+0000] {docker.py:438} INFO - üîÑ [DEBUG] Container Restart Cycle #13 at 2025-10-09 11:53:07
[2025-10-09T11:53:14.873+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T11:53:14.874+0000] {docker.py:438} INFO - üîÑ [DEBUG] Entered restart_containers()
[2025-10-09T11:53:14.874+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, qty=2, rand=True, mode=fixed, ns=default, order=alphabetic, container_name=compose-post-service, restart_command=None
[2025-10-09T11:53:14.874+0000] {docker.py:438} INFO - üîë [DEBUG] Kubernetes API client created
[2025-10-09T11:53:14.874+0000] {docker.py:438} INFO - üîç [DEBUG] Selecting pods now...
[2025-10-09T11:53:14.874+0000] {docker.py:438} INFO - üîç [DEBUG] Entered _select_pods()
[2025-10-09T11:53:14.875+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, all=False, rand=True, mode=fixed, qty=2, ns=default, order=alphabetic
[2025-10-09T11:53:14.875+0000] {docker.py:438} INFO -    [DEBUG] Listing pods with label_selector=app=compose-post-service
[2025-10-09T11:53:14.875+0000] {docker.py:438} INFO - üìã [DEBUG] Found 1 pods initially
[2025-10-09T11:53:14.875+0000] {docker.py:438} INFO - üé≤ [DEBUG] Random selection chosen: 1 pods
[2025-10-09T11:53:14.875+0000] {docker.py:438} INFO - ‚úÖ [DEBUG] Selected pods: ['compose-post-service-67bcfcd5ff-bqrz2']
[2025-10-09T11:53:14.876+0000] {docker.py:438} INFO - üìã [DEBUG] Pods selected: 1
[2025-10-09T11:53:14.876+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:14.876+0000] {docker.py:438} INFO - üéØ [DEBUG] Processing pod: compose-post-service-67bcfcd5ff-bqrz2
[2025-10-09T11:53:14.876+0000] {docker.py:438} INFO - üì¶ [DEBUG] Using provided container: compose-post-service
[2025-10-09T11:53:14.876+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:53:14.877+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:53:14.877+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 52
[2025-10-09T11:53:14.877+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=52
[2025-10-09T11:53:14.877+0000] {docker.py:438} INFO - üìä [DEBUG] Restart count before action: 52
[2025-10-09T11:53:14.878+0000] {docker.py:438} INFO - üîß [DEBUG] Restart strategies to try: [['sh', '-c', 'kill -INT 1'], ['sh', '-c', 'kill -2 1'], ['sh', '-c', 'kill -TERM 1'], ['sh', '-c', 'kill -9 1']]
[2025-10-09T11:53:14.878+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #1: sh -c kill -INT 1
[2025-10-09T11:53:14.878+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:53:14.878+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:53:14 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:53:14.878+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:14.879+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #2: sh -c kill -2 1
[2025-10-09T11:53:14.879+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:53:14.879+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:53:14 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:53:20.435+0000] {job.py:254} ERROR - Job heartbeat failed with error. Scheduler is in unhealthy state
[2025-10-09T11:53:25.495+0000] {job.py:229} INFO - Heartbeat recovered after 24.99 seconds
[2025-10-09T11:53:29.675+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #3: sh -c kill -TERM 1
[2025-10-09T11:53:29.676+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:53:29.676+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:53:14 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:53:29.677+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:29.678+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #4: sh -c kill -9 1
[2025-10-09T11:53:29.679+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:53:29.681+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:53:15 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:53:29.682+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:29.682+0000] {docker.py:438} INFO - ‚ùå [DEBUG] All strategies exhausted for pod compose-post-service-67bcfcd5ff-bqrz2 and no restart observed
[2025-10-09T11:53:29.682+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:29.683+0000] {docker.py:438} INFO - üèÅ [DEBUG] restart_containers() finished. Processed 1 pods
[2025-10-09T11:53:29.683+0000] {docker.py:438} INFO -    [DEBUG] restart_containers returned 1 entries
[2025-10-09T11:53:29.683+0000] {docker.py:438} INFO - ‚úÖ [DEBUG] Successfully restarted this cycle: 0
[2025-10-09T11:53:29.684+0000] {docker.py:438} INFO - ‚ùå [DEBUG] Failed restarts this cycle: 1
[2025-10-09T11:53:29.684+0000] {docker.py:438} INFO -    - compose-post-service-67bcfcd5ff-bqrz2 status=restart_failed details={'pod_name': 'compose-post-service-67bcfcd5ff-bqrz2', 'container_name': 'compose-post-service', 'status': 'restart_failed', 'before_count': 52, 'stdout': None, 'stderr': None, 'ctrl_err': None}
[2025-10-09T11:53:29.685+0000] {docker.py:438} INFO - ‚è≥ [DEBUG] Waiting 5 seconds until next cycle. Time remaining: 27s
[2025-10-09T11:53:29.688+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:29.689+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T11:53:29.689+0000] {docker.py:438} INFO - üîÑ [DEBUG] Container Restart Cycle #14 at 2025-10-09 11:53:20
[2025-10-09T11:53:29.691+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T11:53:29.692+0000] {docker.py:438} INFO - üîÑ [DEBUG] Entered restart_containers()
[2025-10-09T11:53:29.692+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, qty=2, rand=True, mode=fixed, ns=default, order=alphabetic, container_name=compose-post-service, restart_command=None
[2025-10-09T11:53:29.692+0000] {docker.py:438} INFO - üîë [DEBUG] Kubernetes API client created
[2025-10-09T11:53:29.692+0000] {docker.py:438} INFO - üîç [DEBUG] Selecting pods now...
[2025-10-09T11:53:29.693+0000] {docker.py:438} INFO - üîç [DEBUG] Entered _select_pods()
[2025-10-09T11:53:29.693+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, all=False, rand=True, mode=fixed, qty=2, ns=default, order=alphabetic
[2025-10-09T11:53:29.696+0000] {docker.py:438} INFO -    [DEBUG] Listing pods with label_selector=app=compose-post-service
[2025-10-09T11:53:29.696+0000] {docker.py:438} INFO - üìã [DEBUG] Found 1 pods initially
[2025-10-09T11:53:29.696+0000] {docker.py:438} INFO - üé≤ [DEBUG] Random selection chosen: 1 pods
[2025-10-09T11:53:29.697+0000] {docker.py:438} INFO - ‚úÖ [DEBUG] Selected pods: ['compose-post-service-67bcfcd5ff-bqrz2']
[2025-10-09T11:53:29.701+0000] {docker.py:438} INFO - üìã [DEBUG] Pods selected: 1
[2025-10-09T11:53:29.702+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:29.702+0000] {docker.py:438} INFO - üéØ [DEBUG] Processing pod: compose-post-service-67bcfcd5ff-bqrz2
[2025-10-09T11:53:29.702+0000] {docker.py:438} INFO - üì¶ [DEBUG] Using provided container: compose-post-service
[2025-10-09T11:53:29.703+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:53:29.703+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:53:29.705+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 52
[2025-10-09T11:53:29.706+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=52
[2025-10-09T11:53:29.706+0000] {docker.py:438} INFO - üìä [DEBUG] Restart count before action: 52
[2025-10-09T11:53:29.706+0000] {docker.py:438} INFO - üîß [DEBUG] Restart strategies to try: [['sh', '-c', 'kill -INT 1'], ['sh', '-c', 'kill -2 1'], ['sh', '-c', 'kill -TERM 1'], ['sh', '-c', 'kill -9 1']]
[2025-10-09T11:53:29.707+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #1: sh -c kill -INT 1
[2025-10-09T11:53:29.710+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:53:29.710+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:53:21 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:53:29.710+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:29.712+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #2: sh -c kill -2 1
[2025-10-09T11:53:29.712+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:53:29.713+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:53:21 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:53:29.714+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:29.715+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #3: sh -c kill -TERM 1
[2025-10-09T11:53:29.715+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:53:29.715+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:53:22 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:53:29.716+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:29.716+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #4: sh -c kill -9 1
[2025-10-09T11:53:29.719+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:53:29.719+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:53:22 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:53:29.720+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:29.720+0000] {docker.py:438} INFO - ‚ùå [DEBUG] All strategies exhausted for pod compose-post-service-67bcfcd5ff-bqrz2 and no restart observed
[2025-10-09T11:53:29.720+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:29.721+0000] {docker.py:438} INFO - üèÅ [DEBUG] restart_containers() finished. Processed 1 pods
[2025-10-09T11:53:29.721+0000] {docker.py:438} INFO -    [DEBUG] restart_containers returned 1 entries
[2025-10-09T11:53:29.725+0000] {docker.py:438} INFO - ‚úÖ [DEBUG] Successfully restarted this cycle: 0
[2025-10-09T11:53:29.725+0000] {docker.py:438} INFO - ‚ùå [DEBUG] Failed restarts this cycle: 1
[2025-10-09T11:53:29.726+0000] {docker.py:438} INFO -    - compose-post-service-67bcfcd5ff-bqrz2 status=restart_failed details={'pod_name': 'compose-post-service-67bcfcd5ff-bqrz2', 'container_name': 'compose-post-service', 'status': 'restart_failed', 'before_count': 52, 'stdout': None, 'stderr': None, 'ctrl_err': None}
[2025-10-09T11:53:29.727+0000] {docker.py:438} INFO - ‚è≥ [DEBUG] Waiting 5 seconds until next cycle. Time remaining: 20s
[2025-10-09T11:53:29.728+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:29.729+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T11:53:29.730+0000] {docker.py:438} INFO - üîÑ [DEBUG] Container Restart Cycle #15 at 2025-10-09 11:53:27
[2025-10-09T11:53:29.730+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T11:53:29.731+0000] {docker.py:438} INFO - üîÑ [DEBUG] Entered restart_containers()
[2025-10-09T11:53:29.731+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, qty=2, rand=True, mode=fixed, ns=default, order=alphabetic, container_name=compose-post-service, restart_command=None
[2025-10-09T11:53:29.734+0000] {docker.py:438} INFO - üîë [DEBUG] Kubernetes API client created
[2025-10-09T11:53:29.734+0000] {docker.py:438} INFO - üîç [DEBUG] Selecting pods now...
[2025-10-09T11:53:29.734+0000] {docker.py:438} INFO - üîç [DEBUG] Entered _select_pods()
[2025-10-09T11:53:29.735+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, all=False, rand=True, mode=fixed, qty=2, ns=default, order=alphabetic
[2025-10-09T11:53:29.735+0000] {docker.py:438} INFO -    [DEBUG] Listing pods with label_selector=app=compose-post-service
[2025-10-09T11:53:29.739+0000] {docker.py:438} INFO - üìã [DEBUG] Found 1 pods initially
[2025-10-09T11:53:29.739+0000] {docker.py:438} INFO - üé≤ [DEBUG] Random selection chosen: 1 pods
[2025-10-09T11:53:29.739+0000] {docker.py:438} INFO - ‚úÖ [DEBUG] Selected pods: ['compose-post-service-67bcfcd5ff-bqrz2']
[2025-10-09T11:53:29.740+0000] {docker.py:438} INFO - üìã [DEBUG] Pods selected: 1
[2025-10-09T11:53:29.740+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:29.740+0000] {docker.py:438} INFO - üéØ [DEBUG] Processing pod: compose-post-service-67bcfcd5ff-bqrz2
[2025-10-09T11:53:29.741+0000] {docker.py:438} INFO - üì¶ [DEBUG] Using provided container: compose-post-service
[2025-10-09T11:53:29.741+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:53:29.744+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:53:29.745+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 52
[2025-10-09T11:53:29.745+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=52
[2025-10-09T11:53:29.745+0000] {docker.py:438} INFO - üìä [DEBUG] Restart count before action: 52
[2025-10-09T11:53:29.749+0000] {docker.py:438} INFO - üîß [DEBUG] Restart strategies to try: [['sh', '-c', 'kill -INT 1'], ['sh', '-c', 'kill -2 1'], ['sh', '-c', 'kill -TERM 1'], ['sh', '-c', 'kill -9 1']]
[2025-10-09T11:53:29.750+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #1: sh -c kill -INT 1
[2025-10-09T11:53:29.750+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:53:29.750+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:53:28 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:53:29.751+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:29.751+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #2: sh -c kill -2 1
[2025-10-09T11:53:29.751+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:53:29.753+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:53:28 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:53:29.754+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:29.755+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #3: sh -c kill -TERM 1
[2025-10-09T11:53:29.755+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:53:29.757+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:53:29 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:53:29.758+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:29.758+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #4: sh -c kill -9 1
[2025-10-09T11:53:29.758+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:53:29.759+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:53:29 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:53:29.759+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:29.765+0000] {docker.py:438} INFO - ‚ùå [DEBUG] All strategies exhausted for pod compose-post-service-67bcfcd5ff-bqrz2 and no restart observed
[2025-10-09T11:53:29.765+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:29.765+0000] {docker.py:438} INFO - üèÅ [DEBUG] restart_containers() finished. Processed 1 pods
[2025-10-09T11:53:29.766+0000] {docker.py:438} INFO -    [DEBUG] restart_containers returned 1 entries
[2025-10-09T11:53:29.766+0000] {docker.py:438} INFO - ‚úÖ [DEBUG] Successfully restarted this cycle: 0
[2025-10-09T11:53:29.767+0000] {docker.py:438} INFO - ‚ùå [DEBUG] Failed restarts this cycle: 1
[2025-10-09T11:53:29.767+0000] {docker.py:438} INFO -    - compose-post-service-67bcfcd5ff-bqrz2 status=restart_failed details={'pod_name': 'compose-post-service-67bcfcd5ff-bqrz2', 'container_name': 'compose-post-service', 'status': 'restart_failed', 'before_count': 52, 'stdout': None, 'stderr': None, 'ctrl_err': None}
[2025-10-09T11:53:43.782+0000] {docker.py:438} INFO - [32m[2025-10-09 11:53:43 INFO] Let's rollback...
[2025-10-09T11:53:43.789+0000] {docker.py:438} INFO - [32m[2025-10-09 11:53:43 INFO] Rollback: verify-pods-running
[2025-10-09T11:53:43.789+0000] {docker.py:438} INFO - [32m[2025-10-09 11:53:43 INFO] Probe: verify-pods-running
[2025-10-09T11:53:44.164+0000] {docker.py:438} INFO - [32m[2025-10-09 11:53:44 INFO] Experiment ended with status: completed
[2025-10-09T11:53:44.171+0000] {docker.py:438} INFO - ‚è≥ [DEBUG] Waiting 5 seconds until next cycle. Time remaining: 12s
[2025-10-09T11:53:44.172+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:44.174+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T11:53:44.175+0000] {docker.py:438} INFO - üîÑ [DEBUG] Container Restart Cycle #16 at 2025-10-09 11:53:34
[2025-10-09T11:53:44.175+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T11:53:44.175+0000] {docker.py:438} INFO - üîÑ [DEBUG] Entered restart_containers()
[2025-10-09T11:53:44.176+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, qty=2, rand=True, mode=fixed, ns=default, order=alphabetic, container_name=compose-post-service, restart_command=None
[2025-10-09T11:53:44.176+0000] {docker.py:438} INFO - üîë [DEBUG] Kubernetes API client created
[2025-10-09T11:53:44.178+0000] {docker.py:438} INFO - üîç [DEBUG] Selecting pods now...
[2025-10-09T11:53:44.179+0000] {docker.py:438} INFO - üîç [DEBUG] Entered _select_pods()
[2025-10-09T11:53:44.179+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, all=False, rand=True, mode=fixed, qty=2, ns=default, order=alphabetic
[2025-10-09T11:53:44.180+0000] {docker.py:438} INFO -    [DEBUG] Listing pods with label_selector=app=compose-post-service
[2025-10-09T11:53:44.180+0000] {docker.py:438} INFO - üìã [DEBUG] Found 1 pods initially
[2025-10-09T11:53:44.180+0000] {docker.py:438} INFO - üé≤ [DEBUG] Random selection chosen: 1 pods
[2025-10-09T11:53:44.180+0000] {docker.py:438} INFO - ‚úÖ [DEBUG] Selected pods: ['compose-post-service-67bcfcd5ff-bqrz2']
[2025-10-09T11:53:44.181+0000] {docker.py:438} INFO - üìã [DEBUG] Pods selected: 1
[2025-10-09T11:53:44.183+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:44.184+0000] {docker.py:438} INFO - üéØ [DEBUG] Processing pod: compose-post-service-67bcfcd5ff-bqrz2
[2025-10-09T11:53:44.184+0000] {docker.py:438} INFO - üì¶ [DEBUG] Using provided container: compose-post-service
[2025-10-09T11:53:44.184+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:53:44.185+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:53:44.185+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 52
[2025-10-09T11:53:44.187+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=52
[2025-10-09T11:53:44.188+0000] {docker.py:438} INFO - üìä [DEBUG] Restart count before action: 52
[2025-10-09T11:53:44.188+0000] {docker.py:438} INFO - üîß [DEBUG] Restart strategies to try: [['sh', '-c', 'kill -INT 1'], ['sh', '-c', 'kill -2 1'], ['sh', '-c', 'kill -TERM 1'], ['sh', '-c', 'kill -9 1']]
[2025-10-09T11:53:44.188+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #1: sh -c kill -INT 1
[2025-10-09T11:53:44.189+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:53:44.189+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:53:35 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:53:44.192+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:44.192+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #2: sh -c kill -2 1
[2025-10-09T11:53:44.192+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:53:44.193+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:53:36 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:53:44.193+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:44.195+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #3: sh -c kill -TERM 1
[2025-10-09T11:53:44.195+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:53:44.196+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:53:36 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:53:44.196+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:44.199+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #4: sh -c kill -9 1
[2025-10-09T11:53:44.200+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:53:44.200+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:53:36 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:53:44.200+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:44.201+0000] {docker.py:438} INFO - ‚ùå [DEBUG] All strategies exhausted for pod compose-post-service-67bcfcd5ff-bqrz2 and no restart observed
[2025-10-09T11:53:44.201+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:44.203+0000] {docker.py:438} INFO - üèÅ [DEBUG] restart_containers() finished. Processed 1 pods
[2025-10-09T11:53:44.204+0000] {docker.py:438} INFO -    [DEBUG] restart_containers returned 1 entries
[2025-10-09T11:53:44.204+0000] {docker.py:438} INFO - ‚úÖ [DEBUG] Successfully restarted this cycle: 0
[2025-10-09T11:53:44.205+0000] {docker.py:438} INFO - ‚ùå [DEBUG] Failed restarts this cycle: 1
[2025-10-09T11:53:44.205+0000] {docker.py:438} INFO -    - compose-post-service-67bcfcd5ff-bqrz2 status=restart_failed details={'pod_name': 'compose-post-service-67bcfcd5ff-bqrz2', 'container_name': 'compose-post-service', 'status': 'restart_failed', 'before_count': 52, 'stdout': None, 'stderr': None, 'ctrl_err': None}
[2025-10-09T11:53:44.206+0000] {docker.py:438} INFO - ‚è≥ [DEBUG] Waiting 5 seconds until next cycle. Time remaining: 5s
[2025-10-09T11:53:44.206+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:44.207+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T11:53:44.207+0000] {docker.py:438} INFO - üîÑ [DEBUG] Container Restart Cycle #17 at 2025-10-09 11:53:41
[2025-10-09T11:53:44.209+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T11:53:44.210+0000] {docker.py:438} INFO - üîÑ [DEBUG] Entered restart_containers()
[2025-10-09T11:53:44.210+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, qty=2, rand=True, mode=fixed, ns=default, order=alphabetic, container_name=compose-post-service, restart_command=None
[2025-10-09T11:53:44.210+0000] {docker.py:438} INFO - üîë [DEBUG] Kubernetes API client created
[2025-10-09T11:53:44.211+0000] {docker.py:438} INFO - üîç [DEBUG] Selecting pods now...
[2025-10-09T11:53:44.211+0000] {docker.py:438} INFO - üîç [DEBUG] Entered _select_pods()
[2025-10-09T11:53:44.211+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, all=False, rand=True, mode=fixed, qty=2, ns=default, order=alphabetic
[2025-10-09T11:53:44.214+0000] {docker.py:438} INFO -    [DEBUG] Listing pods with label_selector=app=compose-post-service
[2025-10-09T11:53:44.214+0000] {docker.py:438} INFO - üìã [DEBUG] Found 1 pods initially
[2025-10-09T11:53:44.216+0000] {docker.py:438} INFO - üé≤ [DEBUG] Random selection chosen: 1 pods
[2025-10-09T11:53:44.217+0000] {docker.py:438} INFO - ‚úÖ [DEBUG] Selected pods: ['compose-post-service-67bcfcd5ff-bqrz2']
[2025-10-09T11:53:44.217+0000] {docker.py:438} INFO - üìã [DEBUG] Pods selected: 1
[2025-10-09T11:53:44.217+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:44.219+0000] {docker.py:438} INFO - üéØ [DEBUG] Processing pod: compose-post-service-67bcfcd5ff-bqrz2
[2025-10-09T11:53:44.220+0000] {docker.py:438} INFO - üì¶ [DEBUG] Using provided container: compose-post-service
[2025-10-09T11:53:44.220+0000] {docker.py:438} INFO - üîç [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T11:53:44.220+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T11:53:44.221+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 52
[2025-10-09T11:53:44.221+0000] {docker.py:438} INFO -    ‚úÖ [DEBUG] Matched container compose-post-service, restart_count=52
[2025-10-09T11:53:44.222+0000] {docker.py:438} INFO - üìä [DEBUG] Restart count before action: 52
[2025-10-09T11:53:44.223+0000] {docker.py:438} INFO - üîß [DEBUG] Restart strategies to try: [['sh', '-c', 'kill -INT 1'], ['sh', '-c', 'kill -2 1'], ['sh', '-c', 'kill -TERM 1'], ['sh', '-c', 'kill -9 1']]
[2025-10-09T11:53:44.223+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #1: sh -c kill -INT 1
[2025-10-09T11:53:44.223+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:53:44.225+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:53:42 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:53:44.228+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:44.228+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #2: sh -c kill -2 1
[2025-10-09T11:53:44.229+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:53:44.230+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:53:43 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:53:44.231+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:44.231+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #3: sh -c kill -TERM 1
[2025-10-09T11:53:44.232+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:53:44.233+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:53:43 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:53:44.233+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:44.235+0000] {docker.py:438} INFO - ‚û°Ô∏è [DEBUG] Trying restart strategy #4: sh -c kill -9 1
[2025-10-09T11:53:44.235+0000] {docker.py:438} INFO -    ‚ùå [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T11:53:44.236+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 11:53:43 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T11:53:44.236+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:44.236+0000] {docker.py:438} INFO - ‚ùå [DEBUG] All strategies exhausted for pod compose-post-service-67bcfcd5ff-bqrz2 and no restart observed
[2025-10-09T11:53:44.237+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:44.237+0000] {docker.py:438} INFO - üèÅ [DEBUG] restart_containers() finished. Processed 1 pods
[2025-10-09T11:53:44.241+0000] {docker.py:438} INFO -    [DEBUG] restart_containers returned 1 entries
[2025-10-09T11:53:44.241+0000] {docker.py:438} INFO - ‚úÖ [DEBUG] Successfully restarted this cycle: 0
[2025-10-09T11:53:44.241+0000] {docker.py:438} INFO - ‚ùå [DEBUG] Failed restarts this cycle: 1
[2025-10-09T11:53:44.242+0000] {docker.py:438} INFO -    - compose-post-service-67bcfcd5ff-bqrz2 status=restart_failed details={'pod_name': 'compose-post-service-67bcfcd5ff-bqrz2', 'container_name': 'compose-post-service', 'status': 'restart_failed', 'before_count': 52, 'stdout': None, 'stderr': None, 'ctrl_err': None}
[2025-10-09T11:53:44.242+0000] {docker.py:438} INFO - ‚è∞ [DEBUG] Less than 5 seconds remaining (-2s). Stopping continuous run.
[2025-10-09T11:53:44.244+0000] {docker.py:438} INFO - 
[2025-10-09T11:53:44.245+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T11:53:44.245+0000] {docker.py:438} INFO - üèÅ [DEBUG] Continuous restart experiment completed
[2025-10-09T11:53:44.245+0000] {docker.py:438} INFO - üìà Total cycles: 17
[2025-10-09T11:53:44.246+0000] {docker.py:438} INFO - üì¶ Total containers restarted: 4
[2025-10-09T11:53:44.246+0000] {docker.py:438} INFO - ‚è±Ô∏è Total duration: 402 seconds
[2025-10-09T11:53:44.248+0000] {docker.py:438} INFO - üìä Average cycle time: 23.6 seconds
[2025-10-09T11:53:44.848+0000] {docker.py:438} INFO - Container restart experiment completed successfully
[2025-10-09T11:53:45.523+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2025-10-09T11:53:45.524+0000] {taskinstance.py:352} INFO - Marking task as SUCCESS. dag_id=Container_Restart, task_id=apply_container_restart_docker, run_id=scheduled__2025-10-09T11:00:00+00:00, execution_date=20251009T110000, start_date=20251009T114537, end_date=20251009T115345
[2025-10-09T11:53:45.617+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2025-10-09T11:53:45.665+0000] {taskinstance.py:3900} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-10-09T11:53:45.673+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
