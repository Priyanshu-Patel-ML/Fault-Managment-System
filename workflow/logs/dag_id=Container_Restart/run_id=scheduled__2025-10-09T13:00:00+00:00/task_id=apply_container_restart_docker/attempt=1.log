[2025-10-09T13:45:19.760+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-10-09T13:45:19.828+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: Container_Restart.apply_container_restart_docker scheduled__2025-10-09T13:00:00+00:00 [queued]>
[2025-10-09T13:45:19.892+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: Container_Restart.apply_container_restart_docker scheduled__2025-10-09T13:00:00+00:00 [queued]>
[2025-10-09T13:45:19.893+0000] {taskinstance.py:2865} INFO - Starting attempt 1 of 1
[2025-10-09T13:45:19.969+0000] {taskinstance.py:2888} INFO - Executing <Task(DockerOperator): apply_container_restart_docker> on 2025-10-09 13:00:00+00:00
[2025-10-09T13:45:19.991+0000] {standard_task_runner.py:72} INFO - Started process 2046 to run task
[2025-10-09T13:45:20.016+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'Container_Restart', 'apply_container_restart_docker', 'scheduled__2025-10-09T13:00:00+00:00', '--job-id', '6580', '--raw', '--subdir', 'DAGS_FOLDER/dag_factory.py', '--cfg-path', '/tmp/tmplxflw966']
[2025-10-09T13:45:20.025+0000] {standard_task_runner.py:105} INFO - Job 6580: Subtask apply_container_restart_docker
[2025-10-09T13:45:20.292+0000] {task_command.py:467} INFO - Running <TaskInstance: Container_Restart.apply_container_restart_docker scheduled__2025-10-09T13:00:00+00:00 [running]> on host workflow.y2twbfvcjkaujnl2bmtbxunhcb.cx.internal.cloudapp.net
[2025-10-09T13:45:20.708+0000] {taskinstance.py:3131} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='Container_Restart' AIRFLOW_CTX_TASK_ID='apply_container_restart_docker' AIRFLOW_CTX_EXECUTION_DATE='2025-10-09T13:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-10-09T13:00:00+00:00'
[2025-10-09T13:45:20.712+0000] {taskinstance.py:731} INFO - ::endgroup::
[2025-10-09T13:45:20.904+0000] {docker.py:367} INFO - Starting docker container from image priyanshu01ce/***_chaos:latest
[2025-10-09T13:45:22.133+0000] {docker.py:438} INFO - The container is run as root user. For security, consider using a regular user account.
[2025-10-09T13:46:01.153+0000] {job.py:239} ERROR - Job heartbeat failed with error
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (127.0.0.1), port 5433 failed: FATAL:  the database system is in recovery mode


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/jobs/job.py", line 207, in heartbeat
    self._merge_from(Job._fetch_from_db(self, session))
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/retries.py", line 93, in wrapped_function
    for attempt in run_with_db_retries(max_retries=retries, logger=logger, **retry_kwargs):
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/retries.py", line 102, in wrapped_function
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/jobs/job.py", line 335, in _fetch_from_db
    session.merge(job)
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3056, in merge
    return self._merge(
           ^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3136, in _merge
    merged = self.get(
             ^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2853, in get
    return self._get_impl(
           ^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2975, in _get_impl
    return db_load_fn(
           ^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/loading.py", line 530, in load_on_pk_identity
    session.execute(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 750, in _connection_for_bind
    conn = bind.connect()
           ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/future/engine.py", line 412, in connect
    return super(Engine, self).connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3325, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3404, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3374, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2208, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: FATAL:  the database system is in recovery mode

(Background on this error at: https://sqlalche.me/e/14/e3q8)
[2025-10-09T13:46:02.652+0000] {job.py:254} ERROR - Job heartbeat failed with error. Scheduler is in unhealthy state
[2025-10-09T13:46:08.163+0000] {job.py:254} ERROR - Job heartbeat failed with error. Scheduler is in unhealthy state
[2025-10-09T13:46:13.238+0000] {job.py:229} INFO - Heartbeat recovered after 27.71 seconds
[2025-10-09T13:46:37.115+0000] {job.py:239} ERROR - Job heartbeat failed with error
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (127.0.0.1), port 5433 failed: FATAL:  the database system is in recovery mode


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/jobs/job.py", line 207, in heartbeat
    self._merge_from(Job._fetch_from_db(self, session))
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/retries.py", line 93, in wrapped_function
    for attempt in run_with_db_retries(max_retries=retries, logger=logger, **retry_kwargs):
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/retries.py", line 102, in wrapped_function
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/jobs/job.py", line 335, in _fetch_from_db
    session.merge(job)
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3056, in merge
    return self._merge(
           ^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3136, in _merge
    merged = self.get(
             ^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2853, in get
    return self._get_impl(
           ^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2975, in _get_impl
    return db_load_fn(
           ^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/loading.py", line 530, in load_on_pk_identity
    session.execute(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 750, in _connection_for_bind
    conn = bind.connect()
           ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/future/engine.py", line 412, in connect
    return super(Engine, self).connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3325, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3404, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3374, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2208, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: FATAL:  the database system is in recovery mode

(Background on this error at: https://sqlalche.me/e/14/e3q8)
[2025-10-09T13:46:38.102+0000] {job.py:254} ERROR - Job heartbeat failed with error. Scheduler is in unhealthy state
[2025-10-09T13:46:43.981+0000] {job.py:254} ERROR - Job heartbeat failed with error. Scheduler is in unhealthy state
[2025-10-09T13:46:49.049+0000] {job.py:229} INFO - Heartbeat recovered after 25.60 seconds
[2025-10-09T13:46:49.295+0000] {docker.py:438} INFO - 
[2025-10-09T13:46:49.331+0000] {docker.py:438} INFO - total 3404
[2025-10-09T13:46:49.332+0000] {docker.py:438} INFO - drwxr-xr-x 5    1000 1000    4096 Oct  9 06:39 .
[2025-10-09T13:46:49.332+0000] {docker.py:438} INFO - drwxr-xr-x 1 *** root    4096 Sep 26 10:44 ..
[2025-10-09T13:46:49.332+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    1193 Sep  8 07:02 API_Latency.json
[2025-10-09T13:46:49.333+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000     729 Sep  9 10:30 API_Timeout.json
[2025-10-09T13:46:49.334+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    1243 Sep 30 18:21 CPU_Stress_Test_Azure.yaml
[2025-10-09T13:46:49.334+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    1331 Oct  7 18:22 Continuous_Load_Test_Azure.yaml
[2025-10-09T13:46:49.334+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    1233 Sep 30 18:18 Load_Test_Azure.yaml
[2025-10-09T13:46:49.335+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    1267 Oct  9 06:39 Memory_Stress_Test_Azure.yaml
[2025-10-09T13:46:49.335+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    1178 Sep 30 18:19 Stress_Test_Azure.yaml
[2025-10-09T13:46:49.337+0000] {docker.py:438} INFO - drwxrwxr-x 2 root    root    4096 Oct  9 06:43 __pycache__
[2025-10-09T13:46:49.338+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    8875 Sep 25 16:54 chaosk6_actions.py
[2025-10-09T13:46:49.338+0000] {docker.py:438} INFO - -rw-rw-r-- 1 root    root 2945497 Oct  9 13:11 chaostoolkit.log
[2025-10-09T13:46:49.339+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    3213 Sep  9 09:11 combined-sequential.json
[2025-10-09T13:46:49.340+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000     502 Sep 16 05:31 connection_test_experiment.json
[2025-10-09T13:46:49.341+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    1420 Sep 24 06:53 container_restart.json
[2025-10-09T13:46:49.342+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000   16452 Sep 26 09:59 container_restart.py
[2025-10-09T13:46:49.342+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    1313 Oct  9 06:32 container_restart_Azure.yaml
[2025-10-09T13:46:49.342+0000] {docker.py:438} INFO - -rw-rw-r-- 1    1000 1000    6679 Oct  9 06:37 continuos_memory_stress.py
[2025-10-09T13:46:49.343+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    1409 Sep 18 12:30 continuous_load_test.json
[2025-10-09T13:46:49.343+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    1637 Sep 25 10:13 cordon-uncordon-node.json
[2025-10-09T13:46:49.345+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    1637 Sep 25 04:39 cordon_test.json
[2025-10-09T13:46:49.345+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    1034 Sep 30 18:27 cordon_uncordon_node_Azure.yaml
[2025-10-09T13:46:49.347+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    1203 Sep 30 06:51 cpu_stress_ng.json
[2025-10-09T13:46:49.348+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    1771 Sep 24 07:40 db_cleanup.json
[2025-10-09T13:46:49.348+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    6399 Sep 24 07:40 db_cleanup.py
[2025-10-09T13:46:49.348+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    1169 Sep 30 18:15 db_cleanup_docker_Azure.yaml
[2025-10-09T13:46:49.349+0000] {docker.py:438} INFO - -rw-rw-r-- 1    1000 1000    1076 Oct  9 06:38 gradual_memory_stress.json
[2025-10-09T13:46:49.349+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    3295 Oct  9 13:11 journal.json
[2025-10-09T13:46:49.349+0000] {docker.py:438} INFO - -rw-rw-r-- 1 root    root  272340 Oct  9 13:46 k6_continuous_load.log
[2025-10-09T13:46:49.351+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    3981 Oct  9 12:51 k6_continuous_summary.json
[2025-10-09T13:46:49.352+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    3433 Sep 25 09:28 k6_summary.json
[2025-10-09T13:46:49.352+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000     989 Sep 30 09:24 kubernetes_actions.json
[2025-10-09T13:46:49.352+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000   10961 Sep 30 09:23 kubernetes_actions.py
[2025-10-09T13:46:49.353+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000     945 Sep 21 16:40 load_test.json
[2025-10-09T13:46:49.353+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000     528 Sep 17 12:13 max_connection_experiment.json
[2025-10-09T13:46:49.355+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    1227 Sep 13 15:20 memory-stress-rollback.json
[2025-10-09T13:46:49.356+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    1421 Sep 29 05:20 mongo_db_container_restart.json
[2025-10-09T13:46:49.356+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    7586 Sep 18 05:54 mongodb_actions.py
[2025-10-09T13:46:49.356+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    2136 Sep 18 11:23 mongodb_connection.json
[2025-10-09T13:46:49.357+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000     597 Sep 16 09:17 mongodb_network_latency_experiment.json
[2025-10-09T13:46:49.357+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    3657 Sep 18 05:42 mongodb_probes.py
[2025-10-09T13:46:49.359+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    6161 Sep 12 08:04 pod_restart.py
[2025-10-09T13:46:49.360+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    1497 Sep 30 05:50 redis_config_faults.py
[2025-10-09T13:46:49.360+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000     862 Sep 30 05:50 redis_experiment.json
[2025-10-09T13:46:49.360+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000     945 Sep 18 06:53 redis_load.json
[2025-10-09T13:46:49.361+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    1299 Sep 30 18:14 redis_memory_stress_Azure.yaml
[2025-10-09T13:46:49.361+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000    1284 Sep 25 10:53 run_load_test_with_cleanup.py
[2025-10-09T13:46:49.364+0000] {docker.py:438} INFO - drwxr-xr-x 2    1000 1000    4096 Oct  8 01:13 scripts
[2025-10-09T13:46:49.364+0000] {docker.py:438} INFO - drwxr-xr-x 4    1000 1000    4096 Sep 30 09:41 socialNetwork
[2025-10-09T13:46:49.364+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000     821 Sep 26 13:20 stress_test.json
[2025-10-09T13:46:49.365+0000] {docker.py:438} INFO - -rw-r--r-- 1    1000 1000     367 Sep 17 07:24 test_params.json
[2025-10-09T13:46:49.365+0000] {docker.py:438} INFO - Starting continuous container restart experiment...
[2025-10-09T13:46:52.906+0000] {docker.py:438} INFO - [32m[2025-10-09 13:46:52 INFO] Validating the experiment's syntax
[2025-10-09T13:46:57.072+0000] {docker.py:438} INFO - [32m[2025-10-09 13:46:57 INFO] Experiment looks valid
[2025-10-09T13:46:57.073+0000] {docker.py:438} INFO - [32m[2025-10-09 13:46:57 INFO] Running experiment: Continuous Container Restart Experiment
[2025-10-09T13:46:57.091+0000] {docker.py:438} INFO - [32m[2025-10-09 13:46:57 INFO] Steady-state strategy: default
[2025-10-09T13:46:57.093+0000] {docker.py:438} INFO - [32m[2025-10-09 13:46:57 INFO] Rollbacks strategy: default
[2025-10-09T13:46:57.094+0000] {docker.py:438} INFO - [32m[2025-10-09 13:46:57 INFO] No steady state hypothesis defined. That's ok, just exploring.
[2025-10-09T13:46:57.095+0000] {docker.py:438} INFO - [32m[2025-10-09 13:46:57 INFO] Playing your experiment's method now...
[2025-10-09T13:46:57.098+0000] {docker.py:438} INFO - [32m[2025-10-09 13:46:57 INFO] Action: continuous-container-restart
[2025-10-09T13:47:35.410+0000] {job.py:239} ERROR - Job heartbeat failed with error
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (127.0.0.1), port 5433 failed: FATAL:  the database system is in recovery mode


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/jobs/job.py", line 207, in heartbeat
    self._merge_from(Job._fetch_from_db(self, session))
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/retries.py", line 93, in wrapped_function
    for attempt in run_with_db_retries(max_retries=retries, logger=logger, **retry_kwargs):
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/retries.py", line 102, in wrapped_function
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/jobs/job.py", line 335, in _fetch_from_db
    session.merge(job)
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3056, in merge
    return self._merge(
           ^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3136, in _merge
    merged = self.get(
             ^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2853, in get
    return self._get_impl(
           ^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2975, in _get_impl
    return db_load_fn(
           ^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/loading.py", line 530, in load_on_pk_identity
    session.execute(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 750, in _connection_for_bind
    conn = bind.connect()
           ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/future/engine.py", line 412, in connect
    return super(Engine, self).connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3325, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3404, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3374, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2208, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: FATAL:  the database system is in recovery mode

(Background on this error at: https://sqlalche.me/e/14/e3q8)
[2025-10-09T13:47:36.247+0000] {job.py:254} ERROR - Job heartbeat failed with error. Scheduler is in unhealthy state
[2025-10-09T13:47:36.498+0000] {docker.py:438} INFO - ðŸš€ [DEBUG] Entered restart_containers_continuous()
[2025-10-09T13:47:36.499+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, interval=5, duration=400, ns=default, container_name=compose-post-service
[2025-10-09T13:47:36.499+0000] {docker.py:438} INFO - 
[2025-10-09T13:47:36.501+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:47:36.502+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Container Restart Cycle #1 at 2025-10-09 13:46:57
[2025-10-09T13:47:36.502+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:47:36.502+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Entered restart_containers()
[2025-10-09T13:47:36.503+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, qty=2, rand=True, mode=fixed, ns=default, order=alphabetic, container_name=compose-post-service, restart_command=None
[2025-10-09T13:47:36.503+0000] {docker.py:438} INFO - ðŸ”‘ [DEBUG] Kubernetes API client created
[2025-10-09T13:47:36.506+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Selecting pods now...
[2025-10-09T13:47:36.506+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Entered _select_pods()
[2025-10-09T13:47:36.507+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, all=False, rand=True, mode=fixed, qty=2, ns=default, order=alphabetic
[2025-10-09T13:47:36.507+0000] {docker.py:438} INFO -    [DEBUG] Listing pods with label_selector=app=compose-post-service
[2025-10-09T13:47:36.508+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Found 1 pods initially
[2025-10-09T13:47:36.508+0000] {docker.py:438} INFO - ðŸŽ² [DEBUG] Random selection chosen: 1 pods
[2025-10-09T13:47:36.508+0000] {docker.py:438} INFO - âœ… [DEBUG] Selected pods: ['compose-post-service-67bcfcd5ff-bqrz2']
[2025-10-09T13:47:36.509+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Pods selected: 1
[2025-10-09T13:47:36.510+0000] {docker.py:438} INFO - 
[2025-10-09T13:47:36.511+0000] {docker.py:438} INFO - ðŸŽ¯ [DEBUG] Processing pod: compose-post-service-67bcfcd5ff-bqrz2
[2025-10-09T13:47:36.511+0000] {docker.py:438} INFO - ðŸ“¦ [DEBUG] Using provided container: compose-post-service
[2025-10-09T13:47:36.511+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:47:36.512+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:47:36.513+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 71
[2025-10-09T13:47:36.514+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=71
[2025-10-09T13:47:36.514+0000] {docker.py:438} INFO - ðŸ“Š [DEBUG] Restart count before action: 71
[2025-10-09T13:47:36.514+0000] {docker.py:438} INFO - ðŸ”§ [DEBUG] Restart strategies to try: [['sh', '-c', 'kill -INT 1'], ['sh', '-c', 'kill -2 1'], ['sh', '-c', 'kill -TERM 1'], ['sh', '-c', 'kill -9 1']]
[2025-10-09T13:47:36.515+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #1: sh -c kill -INT 1
[2025-10-09T13:47:36.515+0000] {docker.py:438} INFO -    [DEBUG] Exec stream opened successfully, running command...
[2025-10-09T13:47:36.516+0000] {docker.py:438} INFO -    [DEBUG] run_forever returned/finished
[2025-10-09T13:47:36.516+0000] {docker.py:438} INFO -    ðŸ“¤ [DEBUG] STDOUT (truncated): 
[2025-10-09T13:47:36.517+0000] {docker.py:438} INFO -    ðŸ“¤ [DEBUG] STDERR (truncated): 
[2025-10-09T13:47:36.518+0000] {docker.py:438} INFO -    ðŸ“¤ [DEBUG] CTRL_ERR: {"metadata":{},"status":"Success"}
[2025-10-09T13:47:36.518+0000] {docker.py:438} INFO -    â³ [DEBUG] Waiting up to 60s for restart count to increment...
[2025-10-09T13:47:36.519+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:47:36.519+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:47:36.520+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 71
[2025-10-09T13:47:36.520+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=71
[2025-10-09T13:47:36.520+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 71 (before was 71)
[2025-10-09T13:47:36.521+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:47:36.522+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:47:36.522+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 72
[2025-10-09T13:47:36.522+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=72
[2025-10-09T13:47:36.522+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 72 (before was 71)
[2025-10-09T13:47:36.523+0000] {docker.py:438} INFO -    âœ… [DEBUG] Restart observed: 71 -> 72
[2025-10-09T13:47:36.523+0000] {docker.py:438} INFO -    ðŸŽ‰ [DEBUG] Restart verified, breaking out of strategies loop
[2025-10-09T13:47:36.525+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:47:36.526+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:47:36.526+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 72
[2025-10-09T13:47:36.528+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=72
[2025-10-09T13:47:36.529+0000] {docker.py:438} INFO - âœ… [DEBUG] Restart recorded for compose-post-service-67bcfcd5ff-bqrz2: 71 -> 72
[2025-10-09T13:47:36.529+0000] {docker.py:438} INFO - 
[2025-10-09T13:47:36.529+0000] {docker.py:438} INFO - ðŸ [DEBUG] restart_containers() finished. Processed 1 pods
[2025-10-09T13:47:36.530+0000] {docker.py:438} INFO -    [DEBUG] restart_containers returned 1 entries
[2025-10-09T13:47:36.530+0000] {docker.py:438} INFO - âœ… [DEBUG] Successfully restarted this cycle: 1
[2025-10-09T13:47:36.530+0000] {docker.py:438} INFO -    ðŸ“¦ [DEBUG] compose-post-service-67bcfcd5ff-bqrz2: restart_verified
[2025-10-09T13:47:36.531+0000] {docker.py:438} INFO - â³ [DEBUG] Waiting 5 seconds until next cycle. Time remaining: 396s
[2025-10-09T13:47:36.531+0000] {docker.py:438} INFO - 
[2025-10-09T13:47:36.532+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:47:36.533+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Container Restart Cycle #2 at 2025-10-09 13:47:06
[2025-10-09T13:47:36.533+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:47:36.534+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Entered restart_containers()
[2025-10-09T13:47:36.535+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, qty=2, rand=True, mode=fixed, ns=default, order=alphabetic, container_name=compose-post-service, restart_command=None
[2025-10-09T13:47:36.535+0000] {docker.py:438} INFO - ðŸ”‘ [DEBUG] Kubernetes API client created
[2025-10-09T13:47:36.536+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Selecting pods now...
[2025-10-09T13:47:36.536+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Entered _select_pods()
[2025-10-09T13:47:36.536+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, all=False, rand=True, mode=fixed, qty=2, ns=default, order=alphabetic
[2025-10-09T13:47:36.537+0000] {docker.py:438} INFO -    [DEBUG] Listing pods with label_selector=app=compose-post-service
[2025-10-09T13:47:36.537+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Found 1 pods initially
[2025-10-09T13:47:36.537+0000] {docker.py:438} INFO - ðŸŽ² [DEBUG] Random selection chosen: 1 pods
[2025-10-09T13:47:36.538+0000] {docker.py:438} INFO - âœ… [DEBUG] Selected pods: ['compose-post-service-67bcfcd5ff-bqrz2']
[2025-10-09T13:47:36.539+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Pods selected: 1
[2025-10-09T13:47:36.539+0000] {docker.py:438} INFO - 
[2025-10-09T13:47:36.540+0000] {docker.py:438} INFO - ðŸŽ¯ [DEBUG] Processing pod: compose-post-service-67bcfcd5ff-bqrz2
[2025-10-09T13:47:36.541+0000] {docker.py:438} INFO - ðŸ“¦ [DEBUG] Using provided container: compose-post-service
[2025-10-09T13:47:36.541+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:47:36.541+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:47:36.541+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 72
[2025-10-09T13:47:36.542+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=72
[2025-10-09T13:47:36.542+0000] {docker.py:438} INFO - ðŸ“Š [DEBUG] Restart count before action: 72
[2025-10-09T13:47:36.542+0000] {docker.py:438} INFO - ðŸ”§ [DEBUG] Restart strategies to try: [['sh', '-c', 'kill -INT 1'], ['sh', '-c', 'kill -2 1'], ['sh', '-c', 'kill -TERM 1'], ['sh', '-c', 'kill -9 1']]
[2025-10-09T13:47:36.543+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #1: sh -c kill -INT 1
[2025-10-09T13:47:36.543+0000] {docker.py:438} INFO -    [DEBUG] Exec stream opened successfully, running command...
[2025-10-09T13:47:36.544+0000] {docker.py:438} INFO -    [DEBUG] run_forever returned/finished
[2025-10-09T13:47:36.545+0000] {docker.py:438} INFO -    ðŸ“¤ [DEBUG] STDOUT (truncated): 
[2025-10-09T13:47:36.545+0000] {docker.py:438} INFO -    ðŸ“¤ [DEBUG] STDERR (truncated): 
[2025-10-09T13:47:36.548+0000] {docker.py:438} INFO -    ðŸ“¤ [DEBUG] CTRL_ERR: {"metadata":{},"status":"Success"}
[2025-10-09T13:47:36.549+0000] {docker.py:438} INFO -    â³ [DEBUG] Waiting up to 60s for restart count to increment...
[2025-10-09T13:47:36.550+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:47:36.550+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:47:36.551+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 72
[2025-10-09T13:47:36.551+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=72
[2025-10-09T13:47:36.551+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 72 (before was 72)
[2025-10-09T13:47:36.552+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:47:36.552+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:47:36.554+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 72
[2025-10-09T13:47:36.555+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=72
[2025-10-09T13:47:36.555+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 72 (before was 72)
[2025-10-09T13:47:36.555+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:47:36.556+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:47:36.556+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 72
[2025-10-09T13:47:36.556+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=72
[2025-10-09T13:47:36.556+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 72 (before was 72)
[2025-10-09T13:47:36.557+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:47:36.557+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:47:36.557+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 73
[2025-10-09T13:47:36.557+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=73
[2025-10-09T13:47:36.558+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 73 (before was 72)
[2025-10-09T13:47:36.558+0000] {docker.py:438} INFO -    âœ… [DEBUG] Restart observed: 72 -> 73
[2025-10-09T13:47:36.559+0000] {docker.py:438} INFO -    ðŸŽ‰ [DEBUG] Restart verified, breaking out of strategies loop
[2025-10-09T13:47:36.560+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:47:36.560+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:47:36.560+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 73
[2025-10-09T13:47:36.561+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=73
[2025-10-09T13:47:36.561+0000] {docker.py:438} INFO - âœ… [DEBUG] Restart recorded for compose-post-service-67bcfcd5ff-bqrz2: 72 -> 73
[2025-10-09T13:47:36.562+0000] {docker.py:438} INFO - 
[2025-10-09T13:47:36.563+0000] {docker.py:438} INFO - ðŸ [DEBUG] restart_containers() finished. Processed 1 pods
[2025-10-09T13:47:36.563+0000] {docker.py:438} INFO -    [DEBUG] restart_containers returned 1 entries
[2025-10-09T13:47:36.563+0000] {docker.py:438} INFO - âœ… [DEBUG] Successfully restarted this cycle: 1
[2025-10-09T13:47:36.564+0000] {docker.py:438} INFO -    ðŸ“¦ [DEBUG] compose-post-service-67bcfcd5ff-bqrz2: restart_verified
[2025-10-09T13:47:36.564+0000] {docker.py:438} INFO - â³ [DEBUG] Waiting 5 seconds until next cycle. Time remaining: 366s
[2025-10-09T13:47:36.564+0000] {docker.py:438} INFO - 
[2025-10-09T13:47:36.565+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:47:36.565+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Container Restart Cycle #3 at 2025-10-09 13:47:36
[2025-10-09T13:47:36.567+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:47:36.568+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Entered restart_containers()
[2025-10-09T13:47:36.568+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, qty=2, rand=True, mode=fixed, ns=default, order=alphabetic, container_name=compose-post-service, restart_command=None
[2025-10-09T13:47:42.343+0000] {job.py:254} ERROR - Job heartbeat failed with error. Scheduler is in unhealthy state
[2025-10-09T13:47:47.417+0000] {job.py:229} INFO - Heartbeat recovered after 37.89 seconds
[2025-10-09T13:48:08.502+0000] {job.py:239} ERROR - Job heartbeat failed with error
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (127.0.0.1), port 5433 failed: FATAL:  the database system is in recovery mode


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/jobs/job.py", line 207, in heartbeat
    self._merge_from(Job._fetch_from_db(self, session))
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/retries.py", line 93, in wrapped_function
    for attempt in run_with_db_retries(max_retries=retries, logger=logger, **retry_kwargs):
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/retries.py", line 102, in wrapped_function
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/jobs/job.py", line 335, in _fetch_from_db
    session.merge(job)
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3056, in merge
    return self._merge(
           ^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3136, in _merge
    merged = self.get(
             ^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2853, in get
    return self._get_impl(
           ^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2975, in _get_impl
    return db_load_fn(
           ^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/loading.py", line 530, in load_on_pk_identity
    session.execute(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 750, in _connection_for_bind
    conn = bind.connect()
           ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/future/engine.py", line 412, in connect
    return super(Engine, self).connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3325, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3404, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3374, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2208, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: FATAL:  the database system is in recovery mode

(Background on this error at: https://sqlalche.me/e/14/e3q8)
[2025-10-09T13:48:09.589+0000] {job.py:254} ERROR - Job heartbeat failed with error. Scheduler is in unhealthy state
[2025-10-09T13:48:14.690+0000] {docker.py:438} INFO - ðŸ”‘ [DEBUG] Kubernetes API client created
[2025-10-09T13:48:14.691+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Selecting pods now...
[2025-10-09T13:48:14.692+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Entered _select_pods()
[2025-10-09T13:48:14.694+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, all=False, rand=True, mode=fixed, qty=2, ns=default, order=alphabetic
[2025-10-09T13:48:14.695+0000] {docker.py:438} INFO -    [DEBUG] Listing pods with label_selector=app=compose-post-service
[2025-10-09T13:48:14.695+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Found 1 pods initially
[2025-10-09T13:48:14.696+0000] {docker.py:438} INFO - ðŸŽ² [DEBUG] Random selection chosen: 1 pods
[2025-10-09T13:48:14.696+0000] {docker.py:438} INFO - âœ… [DEBUG] Selected pods: ['compose-post-service-67bcfcd5ff-bqrz2']
[2025-10-09T13:48:14.698+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Pods selected: 1
[2025-10-09T13:48:14.699+0000] {docker.py:438} INFO - 
[2025-10-09T13:48:14.701+0000] {docker.py:438} INFO - ðŸŽ¯ [DEBUG] Processing pod: compose-post-service-67bcfcd5ff-bqrz2
[2025-10-09T13:48:14.706+0000] {docker.py:438} INFO - ðŸ“¦ [DEBUG] Using provided container: compose-post-service
[2025-10-09T13:48:14.706+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:48:14.706+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:48:14.707+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 73
[2025-10-09T13:48:14.711+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=73
[2025-10-09T13:48:14.712+0000] {docker.py:438} INFO - ðŸ“Š [DEBUG] Restart count before action: 73
[2025-10-09T13:48:14.714+0000] {docker.py:438} INFO - ðŸ”§ [DEBUG] Restart strategies to try: [['sh', '-c', 'kill -INT 1'], ['sh', '-c', 'kill -2 1'], ['sh', '-c', 'kill -TERM 1'], ['sh', '-c', 'kill -9 1']]
[2025-10-09T13:48:14.717+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #1: sh -c kill -INT 1
[2025-10-09T13:48:14.718+0000] {docker.py:438} INFO -    [DEBUG] Exec stream opened successfully, running command...
[2025-10-09T13:48:14.718+0000] {docker.py:438} INFO -    [DEBUG] run_forever returned/finished
[2025-10-09T13:48:14.718+0000] {docker.py:438} INFO -    ðŸ“¤ [DEBUG] STDOUT (truncated): 
[2025-10-09T13:48:14.719+0000] {docker.py:438} INFO -    ðŸ“¤ [DEBUG] STDERR (truncated): 
[2025-10-09T13:48:14.719+0000] {docker.py:438} INFO -    ðŸ“¤ [DEBUG] CTRL_ERR: {"metadata":{},"status":"Success"}
[2025-10-09T13:48:14.723+0000] {docker.py:438} INFO -    â³ [DEBUG] Waiting up to 60s for restart count to increment...
[2025-10-09T13:48:14.723+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:48:14.724+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:48:14.728+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 73
[2025-10-09T13:48:14.729+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=73
[2025-10-09T13:48:14.729+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 73 (before was 73)
[2025-10-09T13:48:14.729+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:48:14.730+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:48:14.730+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 73
[2025-10-09T13:48:14.730+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=73
[2025-10-09T13:48:14.732+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 73 (before was 73)
[2025-10-09T13:48:14.732+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:48:14.733+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:48:14.733+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 73
[2025-10-09T13:48:14.733+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=73
[2025-10-09T13:48:14.734+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 73 (before was 73)
[2025-10-09T13:48:14.734+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:48:14.734+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:48:14.736+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 73
[2025-10-09T13:48:14.736+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=73
[2025-10-09T13:48:14.736+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 73 (before was 73)
[2025-10-09T13:48:14.737+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:48:14.737+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:48:14.737+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 73
[2025-10-09T13:48:14.739+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=73
[2025-10-09T13:48:14.739+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 73 (before was 73)
[2025-10-09T13:48:14.739+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:48:14.740+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:48:14.740+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 73
[2025-10-09T13:48:14.741+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=73
[2025-10-09T13:48:14.742+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 73 (before was 73)
[2025-10-09T13:48:14.742+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:48:14.742+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:48:14.743+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 73
[2025-10-09T13:48:14.743+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=73
[2025-10-09T13:48:14.745+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 73 (before was 73)
[2025-10-09T13:48:14.746+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:48:14.746+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:48:14.746+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 73
[2025-10-09T13:48:14.747+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=73
[2025-10-09T13:48:14.747+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 73 (before was 73)
[2025-10-09T13:48:14.752+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:48:14.753+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:48:14.753+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 73
[2025-10-09T13:48:14.753+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=73
[2025-10-09T13:48:14.754+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 73 (before was 73)
[2025-10-09T13:48:14.754+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:48:14.760+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:48:14.762+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 73
[2025-10-09T13:48:14.763+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=73
[2025-10-09T13:48:14.763+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 73 (before was 73)
[2025-10-09T13:48:14.765+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:48:14.765+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:48:14.765+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 73
[2025-10-09T13:48:14.766+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=73
[2025-10-09T13:48:14.766+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 73 (before was 73)
[2025-10-09T13:48:14.770+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:48:14.770+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:48:14.770+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 73
[2025-10-09T13:48:14.771+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=73
[2025-10-09T13:48:14.771+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 73 (before was 73)
[2025-10-09T13:48:14.776+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:48:14.777+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:48:14.777+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 74
[2025-10-09T13:48:14.777+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=74
[2025-10-09T13:48:14.778+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 74 (before was 73)
[2025-10-09T13:48:14.778+0000] {docker.py:438} INFO -    âœ… [DEBUG] Restart observed: 73 -> 74
[2025-10-09T13:48:14.781+0000] {docker.py:438} INFO -    ðŸŽ‰ [DEBUG] Restart verified, breaking out of strategies loop
[2025-10-09T13:48:14.781+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:48:14.782+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:48:14.782+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 74
[2025-10-09T13:48:14.784+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=74
[2025-10-09T13:48:14.785+0000] {docker.py:438} INFO - âœ… [DEBUG] Restart recorded for compose-post-service-67bcfcd5ff-bqrz2: 73 -> 74
[2025-10-09T13:48:14.785+0000] {docker.py:438} INFO - 
[2025-10-09T13:48:14.786+0000] {docker.py:438} INFO - ðŸ [DEBUG] restart_containers() finished. Processed 1 pods
[2025-10-09T13:48:14.786+0000] {docker.py:438} INFO -    [DEBUG] restart_containers returned 1 entries
[2025-10-09T13:48:14.787+0000] {docker.py:438} INFO - âœ… [DEBUG] Successfully restarted this cycle: 1
[2025-10-09T13:48:14.788+0000] {docker.py:438} INFO -    ðŸ“¦ [DEBUG] compose-post-service-67bcfcd5ff-bqrz2: restart_verified
[2025-10-09T13:48:14.788+0000] {docker.py:438} INFO - â³ [DEBUG] Waiting 5 seconds until next cycle. Time remaining: 329s
[2025-10-09T13:48:14.788+0000] {docker.py:438} INFO - 
[2025-10-09T13:48:14.789+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:48:14.789+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Container Restart Cycle #4 at 2025-10-09 13:48:13
[2025-10-09T13:48:14.791+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:48:14.792+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Entered restart_containers()
[2025-10-09T13:48:14.792+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, qty=2, rand=True, mode=fixed, ns=default, order=alphabetic, container_name=compose-post-service, restart_command=None
[2025-10-09T13:48:14.792+0000] {docker.py:438} INFO - ðŸ”‘ [DEBUG] Kubernetes API client created
[2025-10-09T13:48:14.793+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Selecting pods now...
[2025-10-09T13:48:14.793+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Entered _select_pods()
[2025-10-09T13:48:14.793+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, all=False, rand=True, mode=fixed, qty=2, ns=default, order=alphabetic
[2025-10-09T13:48:14.794+0000] {docker.py:438} INFO -    [DEBUG] Listing pods with label_selector=app=compose-post-service
[2025-10-09T13:48:14.794+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Found 1 pods initially
[2025-10-09T13:48:14.794+0000] {docker.py:438} INFO - ðŸŽ² [DEBUG] Random selection chosen: 1 pods
[2025-10-09T13:48:14.795+0000] {docker.py:438} INFO - âœ… [DEBUG] Selected pods: ['compose-post-service-67bcfcd5ff-bqrz2']
[2025-10-09T13:48:14.795+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Pods selected: 1
[2025-10-09T13:48:14.800+0000] {docker.py:438} INFO - 
[2025-10-09T13:48:14.801+0000] {docker.py:438} INFO - ðŸŽ¯ [DEBUG] Processing pod: compose-post-service-67bcfcd5ff-bqrz2
[2025-10-09T13:48:14.801+0000] {docker.py:438} INFO - ðŸ“¦ [DEBUG] Using provided container: compose-post-service
[2025-10-09T13:48:14.801+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:48:14.802+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:48:15.519+0000] {job.py:254} ERROR - Job heartbeat failed with error. Scheduler is in unhealthy state
[2025-10-09T13:48:20.655+0000] {job.py:229} INFO - Heartbeat recovered after 23.08 seconds
[2025-10-09T13:49:04.451+0000] {job.py:239} ERROR - Job heartbeat failed with error
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (127.0.0.1), port 5433 failed: FATAL:  the database system is in recovery mode


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/jobs/job.py", line 207, in heartbeat
    self._merge_from(Job._fetch_from_db(self, session))
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/retries.py", line 93, in wrapped_function
    for attempt in run_with_db_retries(max_retries=retries, logger=logger, **retry_kwargs):
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/retries.py", line 102, in wrapped_function
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/jobs/job.py", line 335, in _fetch_from_db
    session.merge(job)
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3056, in merge
    return self._merge(
           ^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3136, in _merge
    merged = self.get(
             ^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2853, in get
    return self._get_impl(
           ^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2975, in _get_impl
    return db_load_fn(
           ^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/loading.py", line 530, in load_on_pk_identity
    session.execute(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 750, in _connection_for_bind
    conn = bind.connect()
           ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/future/engine.py", line 412, in connect
    return super(Engine, self).connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3325, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3404, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3374, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2208, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: FATAL:  the database system is in recovery mode

(Background on this error at: https://sqlalche.me/e/14/e3q8)
[2025-10-09T13:49:05.046+0000] {job.py:254} ERROR - Job heartbeat failed with error. Scheduler is in unhealthy state
[2025-10-09T13:49:09.289+0000] {docker.py:438} INFO - [DEBUG] container: compose-post-service, restart_count: 74
[2025-10-09T13:49:09.290+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=74
[2025-10-09T13:49:09.290+0000] {docker.py:438} INFO - ðŸ“Š [DEBUG] Restart count before action: 74
[2025-10-09T13:49:09.291+0000] {docker.py:438} INFO - ðŸ”§ [DEBUG] Restart strategies to try: [['sh', '-c', 'kill -INT 1'], ['sh', '-c', 'kill -2 1'], ['sh', '-c', 'kill -TERM 1'], ['sh', '-c', 'kill -9 1']]
[2025-10-09T13:49:09.291+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #1: sh -c kill -INT 1
[2025-10-09T13:49:09.292+0000] {docker.py:438} INFO -    [DEBUG] Exec stream opened successfully, running command...
[2025-10-09T13:49:09.292+0000] {docker.py:438} INFO -    [DEBUG] run_forever returned/finished
[2025-10-09T13:49:09.293+0000] {docker.py:438} INFO -    ðŸ“¤ [DEBUG] STDOUT (truncated): 
[2025-10-09T13:49:09.293+0000] {docker.py:438} INFO -    ðŸ“¤ [DEBUG] STDERR (truncated): 
[2025-10-09T13:49:09.293+0000] {docker.py:438} INFO -    ðŸ“¤ [DEBUG] CTRL_ERR: {"metadata":{},"status":"Success"}
[2025-10-09T13:49:09.294+0000] {docker.py:438} INFO -    â³ [DEBUG] Waiting up to 60s for restart count to increment...
[2025-10-09T13:49:09.294+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:49:09.295+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:49:09.295+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 74
[2025-10-09T13:49:09.296+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=74
[2025-10-09T13:49:09.296+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 74 (before was 74)
[2025-10-09T13:49:09.296+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:49:09.297+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:49:09.297+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 74
[2025-10-09T13:49:09.297+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=74
[2025-10-09T13:49:09.297+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 74 (before was 74)
[2025-10-09T13:49:09.298+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:49:09.298+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:49:09.298+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 74
[2025-10-09T13:49:09.299+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=74
[2025-10-09T13:49:09.299+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 74 (before was 74)
[2025-10-09T13:49:09.299+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:49:09.299+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:49:09.300+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 74
[2025-10-09T13:49:09.300+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=74
[2025-10-09T13:49:09.300+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 74 (before was 74)
[2025-10-09T13:49:09.301+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:49:09.301+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:49:09.301+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 74
[2025-10-09T13:49:09.302+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=74
[2025-10-09T13:49:09.302+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 74 (before was 74)
[2025-10-09T13:49:09.302+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:49:09.302+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:49:09.303+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 74
[2025-10-09T13:49:09.303+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=74
[2025-10-09T13:49:09.303+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 74 (before was 74)
[2025-10-09T13:49:09.304+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:49:09.304+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:49:09.304+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 74
[2025-10-09T13:49:09.304+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=74
[2025-10-09T13:49:09.305+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 74 (before was 74)
[2025-10-09T13:49:09.305+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:49:09.305+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:49:09.306+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 74
[2025-10-09T13:49:09.306+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=74
[2025-10-09T13:49:09.306+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 74 (before was 74)
[2025-10-09T13:49:09.307+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:49:09.307+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:49:09.307+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 74
[2025-10-09T13:49:09.308+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=74
[2025-10-09T13:49:09.308+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 74 (before was 74)
[2025-10-09T13:49:09.308+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:49:09.308+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:49:09.309+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 74
[2025-10-09T13:49:09.309+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=74
[2025-10-09T13:49:09.309+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 74 (before was 74)
[2025-10-09T13:49:09.309+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:49:09.310+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:49:09.310+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 74
[2025-10-09T13:49:09.310+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=74
[2025-10-09T13:49:09.311+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 74 (before was 74)
[2025-10-09T13:49:09.311+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:49:09.311+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:49:09.312+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 74
[2025-10-09T13:49:09.312+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=74
[2025-10-09T13:49:09.312+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 74 (before was 74)
[2025-10-09T13:49:09.312+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:49:09.313+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:49:09.313+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 74
[2025-10-09T13:49:09.313+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=74
[2025-10-09T13:49:09.314+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 74 (before was 74)
[2025-10-09T13:49:09.314+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:49:09.314+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:49:09.314+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 74
[2025-10-09T13:49:09.315+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=74
[2025-10-09T13:49:09.315+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 74 (before was 74)
[2025-10-09T13:49:09.315+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:49:09.316+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:49:09.316+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 74
[2025-10-09T13:49:09.316+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=74
[2025-10-09T13:49:09.316+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 74 (before was 74)
[2025-10-09T13:49:09.317+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:49:09.317+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:49:09.317+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 74
[2025-10-09T13:49:09.318+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=74
[2025-10-09T13:49:09.318+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 74 (before was 74)
[2025-10-09T13:49:09.318+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:49:09.318+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:49:09.319+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 74
[2025-10-09T13:49:09.319+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=74
[2025-10-09T13:49:09.319+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 74 (before was 74)
[2025-10-09T13:49:09.320+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:49:09.320+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:49:09.320+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 74
[2025-10-09T13:49:09.320+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=74
[2025-10-09T13:49:09.321+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 74 (before was 74)
[2025-10-09T13:49:09.321+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:49:09.321+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:49:09.322+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 74
[2025-10-09T13:49:09.322+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=74
[2025-10-09T13:49:09.322+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 74 (before was 74)
[2025-10-09T13:49:09.322+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:49:09.323+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:49:09.323+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 74
[2025-10-09T13:49:09.323+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=74
[2025-10-09T13:49:09.324+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 74 (before was 74)
[2025-10-09T13:49:09.324+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:49:09.324+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:49:09.324+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 74
[2025-10-09T13:49:09.325+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=74
[2025-10-09T13:49:11.030+0000] {job.py:254} ERROR - Job heartbeat failed with error. Scheduler is in unhealthy state
[2025-10-09T13:49:16.118+0000] {job.py:229} INFO - Heartbeat recovered after 35.05 seconds
[2025-10-09T13:49:53.346+0000] {job.py:239} ERROR - Job heartbeat failed with error
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (127.0.0.1), port 5433 failed: FATAL:  the database system is in recovery mode


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/jobs/job.py", line 224, in heartbeat
    job = Job._update_heartbeat(job=self, session=session)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/retries.py", line 93, in wrapped_function
    for attempt in run_with_db_retries(max_retries=retries, logger=logger, **retry_kwargs):
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/retries.py", line 102, in wrapped_function
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/jobs/job.py", line 374, in _update_heartbeat
    orm_job: Job | None = session.scalar(select(Job).where(Job.id == job.id).limit(1))
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1747, in scalar
    return self.execute(
           ^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 750, in _connection_for_bind
    conn = bind.connect()
           ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/future/engine.py", line 412, in connect
    return super(Engine, self).connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3325, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3404, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3374, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2208, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: FATAL:  the database system is in recovery mode

(Background on this error at: https://sqlalche.me/e/14/e3q8)
[2025-10-09T13:49:54.092+0000] {job.py:254} ERROR - Job heartbeat failed with error. Scheduler is in unhealthy state
[2025-10-09T13:49:59.795+0000] {job.py:254} ERROR - Job heartbeat failed with error. Scheduler is in unhealthy state
[2025-10-09T13:50:01.777+0000] {docker.py:438} INFO - [DEBUG] Polled restart count: 74 (before was 74)
[2025-10-09T13:50:01.778+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:50:01.778+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:50:01.778+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 75
[2025-10-09T13:50:01.779+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=75
[2025-10-09T13:50:01.779+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 75 (before was 74)
[2025-10-09T13:50:01.779+0000] {docker.py:438} INFO -    âœ… [DEBUG] Restart observed: 74 -> 75
[2025-10-09T13:50:01.780+0000] {docker.py:438} INFO -    ðŸŽ‰ [DEBUG] Restart verified, breaking out of strategies loop
[2025-10-09T13:50:01.780+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:50:01.780+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:50:01.781+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 75
[2025-10-09T13:50:01.781+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=75
[2025-10-09T13:50:01.781+0000] {docker.py:438} INFO - âœ… [DEBUG] Restart recorded for compose-post-service-67bcfcd5ff-bqrz2: 74 -> 75
[2025-10-09T13:50:01.781+0000] {docker.py:438} INFO - 
[2025-10-09T13:50:01.782+0000] {docker.py:438} INFO - ðŸ [DEBUG] restart_containers() finished. Processed 1 pods
[2025-10-09T13:50:01.782+0000] {docker.py:438} INFO -    [DEBUG] restart_containers returned 1 entries
[2025-10-09T13:50:01.782+0000] {docker.py:438} INFO - âœ… [DEBUG] Successfully restarted this cycle: 1
[2025-10-09T13:50:01.782+0000] {docker.py:438} INFO -    ðŸ“¦ [DEBUG] compose-post-service-67bcfcd5ff-bqrz2: restart_verified
[2025-10-09T13:50:01.783+0000] {docker.py:438} INFO - â³ [DEBUG] Waiting 5 seconds until next cycle. Time remaining: 266s
[2025-10-09T13:50:01.783+0000] {docker.py:438} INFO - 
[2025-10-09T13:50:01.783+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:50:01.783+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Container Restart Cycle #5 at 2025-10-09 13:49:16
[2025-10-09T13:50:01.784+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:50:01.784+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Entered restart_containers()
[2025-10-09T13:50:01.784+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, qty=2, rand=True, mode=fixed, ns=default, order=alphabetic, container_name=compose-post-service, restart_command=None
[2025-10-09T13:50:01.784+0000] {docker.py:438} INFO - ðŸ”‘ [DEBUG] Kubernetes API client created
[2025-10-09T13:50:01.784+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Selecting pods now...
[2025-10-09T13:50:01.785+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Entered _select_pods()
[2025-10-09T13:50:01.785+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, all=False, rand=True, mode=fixed, qty=2, ns=default, order=alphabetic
[2025-10-09T13:50:01.785+0000] {docker.py:438} INFO -    [DEBUG] Listing pods with label_selector=app=compose-post-service
[2025-10-09T13:50:01.785+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Found 1 pods initially
[2025-10-09T13:50:01.785+0000] {docker.py:438} INFO - ðŸŽ² [DEBUG] Random selection chosen: 1 pods
[2025-10-09T13:50:01.786+0000] {docker.py:438} INFO - âœ… [DEBUG] Selected pods: ['compose-post-service-67bcfcd5ff-bqrz2']
[2025-10-09T13:50:01.786+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Pods selected: 1
[2025-10-09T13:50:01.787+0000] {docker.py:438} INFO - 
[2025-10-09T13:50:01.787+0000] {docker.py:438} INFO - ðŸŽ¯ [DEBUG] Processing pod: compose-post-service-67bcfcd5ff-bqrz2
[2025-10-09T13:50:01.787+0000] {docker.py:438} INFO - ðŸ“¦ [DEBUG] Using provided container: compose-post-service
[2025-10-09T13:50:01.787+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:50:01.787+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:50:01.788+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 75
[2025-10-09T13:50:01.788+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=75
[2025-10-09T13:50:01.788+0000] {docker.py:438} INFO - ðŸ“Š [DEBUG] Restart count before action: 75
[2025-10-09T13:50:01.788+0000] {docker.py:438} INFO - ðŸ”§ [DEBUG] Restart strategies to try: [['sh', '-c', 'kill -INT 1'], ['sh', '-c', 'kill -2 1'], ['sh', '-c', 'kill -TERM 1'], ['sh', '-c', 'kill -9 1']]
[2025-10-09T13:50:01.788+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #1: sh -c kill -INT 1
[2025-10-09T13:50:01.789+0000] {docker.py:438} INFO -    [DEBUG] Exec stream opened successfully, running command...
[2025-10-09T13:50:01.789+0000] {docker.py:438} INFO -    [DEBUG] run_forever returned/finished
[2025-10-09T13:50:01.789+0000] {docker.py:438} INFO -    ðŸ“¤ [DEBUG] STDOUT (truncated): 
[2025-10-09T13:50:01.789+0000] {docker.py:438} INFO -    ðŸ“¤ [DEBUG] STDERR (truncated): 
[2025-10-09T13:50:01.790+0000] {docker.py:438} INFO -    ðŸ“¤ [DEBUG] CTRL_ERR: {"metadata":{},"status":"Success"}
[2025-10-09T13:50:01.790+0000] {docker.py:438} INFO -    â³ [DEBUG] Waiting up to 60s for restart count to increment...
[2025-10-09T13:50:01.790+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:50:01.790+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:50:01.790+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 75
[2025-10-09T13:50:01.791+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=75
[2025-10-09T13:50:01.791+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 75 (before was 75)
[2025-10-09T13:50:01.791+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:50:01.791+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:50:01.791+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 75
[2025-10-09T13:50:01.792+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=75
[2025-10-09T13:50:01.792+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 75 (before was 75)
[2025-10-09T13:50:01.792+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:50:01.793+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:50:01.793+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 75
[2025-10-09T13:50:01.793+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=75
[2025-10-09T13:50:01.793+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 75 (before was 75)
[2025-10-09T13:50:01.793+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:50:01.794+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:50:01.794+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 75
[2025-10-09T13:50:01.795+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=75
[2025-10-09T13:50:01.795+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 75 (before was 75)
[2025-10-09T13:50:01.796+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:50:01.797+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:50:01.798+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 75
[2025-10-09T13:50:01.799+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=75
[2025-10-09T13:50:01.799+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 75 (before was 75)
[2025-10-09T13:50:01.802+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:50:01.803+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:50:01.803+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 75
[2025-10-09T13:50:01.804+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=75
[2025-10-09T13:50:01.804+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 75 (before was 75)
[2025-10-09T13:50:01.805+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:50:01.807+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:50:01.807+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 75
[2025-10-09T13:50:01.809+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=75
[2025-10-09T13:50:01.810+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 75 (before was 75)
[2025-10-09T13:50:01.811+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:50:01.811+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:50:01.814+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 75
[2025-10-09T13:50:01.816+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=75
[2025-10-09T13:50:01.818+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 75 (before was 75)
[2025-10-09T13:50:01.818+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:50:01.819+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:50:01.819+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 75
[2025-10-09T13:50:01.820+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=75
[2025-10-09T13:50:01.820+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 75 (before was 75)
[2025-10-09T13:50:01.820+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:50:01.821+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:50:01.824+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 75
[2025-10-09T13:50:01.825+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=75
[2025-10-09T13:50:01.825+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 75 (before was 75)
[2025-10-09T13:50:01.826+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:50:01.826+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:50:01.826+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 75
[2025-10-09T13:50:01.827+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=75
[2025-10-09T13:50:01.827+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 75 (before was 75)
[2025-10-09T13:50:01.827+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:50:01.827+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:50:01.827+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 75
[2025-10-09T13:50:01.828+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=75
[2025-10-09T13:50:01.828+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 75 (before was 75)
[2025-10-09T13:50:01.828+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:50:01.828+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:50:01.828+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 75
[2025-10-09T13:50:01.829+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=75
[2025-10-09T13:50:01.829+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 75 (before was 75)
[2025-10-09T13:50:01.829+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:50:01.829+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:50:01.829+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 75
[2025-10-09T13:50:01.830+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=75
[2025-10-09T13:50:01.830+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 75 (before was 75)
[2025-10-09T13:50:04.821+0000] {job.py:229} INFO - Heartbeat recovered after 38.53 seconds
[2025-10-09T13:50:28.160+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:50:28.160+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:50:28.161+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 75
[2025-10-09T13:50:28.161+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=75
[2025-10-09T13:50:28.161+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 75 (before was 75)
[2025-10-09T13:50:28.162+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:50:28.162+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:50:28.162+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 75
[2025-10-09T13:50:28.163+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=75
[2025-10-09T13:50:28.163+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 75 (before was 75)
[2025-10-09T13:50:28.163+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:50:28.164+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:50:28.164+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 75
[2025-10-09T13:50:28.164+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=75
[2025-10-09T13:50:28.164+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 75 (before was 75)
[2025-10-09T13:50:28.165+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:50:28.165+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:50:28.165+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 75
[2025-10-09T13:50:28.166+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=75
[2025-10-09T13:50:28.166+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 75 (before was 75)
[2025-10-09T13:50:28.166+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:50:28.166+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:50:28.167+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 75
[2025-10-09T13:50:28.167+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=75
[2025-10-09T13:50:28.167+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 75 (before was 75)
[2025-10-09T13:50:28.167+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:50:28.168+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:50:28.168+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 75
[2025-10-09T13:50:28.168+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=75
[2025-10-09T13:50:28.168+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 75 (before was 75)
[2025-10-09T13:50:28.169+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:50:28.169+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:50:28.169+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 75
[2025-10-09T13:50:28.170+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=75
[2025-10-09T13:50:28.170+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 75 (before was 75)
[2025-10-09T13:50:28.170+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:50:28.170+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:50:28.171+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 75
[2025-10-09T13:50:28.171+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=75
[2025-10-09T13:50:28.171+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 75 (before was 75)
[2025-10-09T13:50:28.171+0000] {docker.py:438} INFO -    âš ï¸ [DEBUG] This strategy did not result in a restart, going to next strategy if any
[2025-10-09T13:50:28.172+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #2: sh -c kill -2 1
[2025-10-09T13:50:28.172+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:50:28.172+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:50:20 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:50:28.173+0000] {docker.py:438} INFO - 
[2025-10-09T13:50:28.173+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #3: sh -c kill -TERM 1
[2025-10-09T13:50:28.173+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:50:28.173+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:50:21 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:50:28.174+0000] {docker.py:438} INFO - 
[2025-10-09T13:50:28.174+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #4: sh -c kill -9 1
[2025-10-09T13:50:28.174+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:50:28.175+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:50:21 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:50:28.175+0000] {docker.py:438} INFO - 
[2025-10-09T13:50:28.175+0000] {docker.py:438} INFO - âŒ [DEBUG] All strategies exhausted for pod compose-post-service-67bcfcd5ff-bqrz2 and no restart observed
[2025-10-09T13:50:28.176+0000] {docker.py:438} INFO - 
[2025-10-09T13:50:28.176+0000] {docker.py:438} INFO - ðŸ [DEBUG] restart_containers() finished. Processed 1 pods
[2025-10-09T13:50:28.176+0000] {docker.py:438} INFO -    [DEBUG] restart_containers returned 1 entries
[2025-10-09T13:50:28.176+0000] {docker.py:438} INFO - âœ… [DEBUG] Successfully restarted this cycle: 0
[2025-10-09T13:50:28.177+0000] {docker.py:438} INFO - âŒ [DEBUG] Failed restarts this cycle: 1
[2025-10-09T13:50:28.177+0000] {docker.py:438} INFO -    - compose-post-service-67bcfcd5ff-bqrz2 status=restart_failed details={'pod_name': 'compose-post-service-67bcfcd5ff-bqrz2', 'container_name': 'compose-post-service', 'status': 'restart_failed', 'before_count': 75, 'stdout': '', 'stderr': '', 'ctrl_err': '{"metadata":{},"status":"Success"}'}
[2025-10-09T13:50:28.177+0000] {docker.py:438} INFO - â³ [DEBUG] Waiting 5 seconds until next cycle. Time remaining: 196s
[2025-10-09T13:50:28.177+0000] {docker.py:438} INFO - 
[2025-10-09T13:50:28.178+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:50:28.178+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Container Restart Cycle #6 at 2025-10-09 13:50:26
[2025-10-09T13:50:28.178+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:50:28.179+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Entered restart_containers()
[2025-10-09T13:50:28.179+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, qty=2, rand=True, mode=fixed, ns=default, order=alphabetic, container_name=compose-post-service, restart_command=None
[2025-10-09T13:50:28.179+0000] {docker.py:438} INFO - ðŸ”‘ [DEBUG] Kubernetes API client created
[2025-10-09T13:50:28.179+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Selecting pods now...
[2025-10-09T13:50:28.180+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Entered _select_pods()
[2025-10-09T13:50:28.180+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, all=False, rand=True, mode=fixed, qty=2, ns=default, order=alphabetic
[2025-10-09T13:50:28.180+0000] {docker.py:438} INFO -    [DEBUG] Listing pods with label_selector=app=compose-post-service
[2025-10-09T13:50:28.181+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Found 1 pods initially
[2025-10-09T13:50:28.181+0000] {docker.py:438} INFO - ðŸŽ² [DEBUG] Random selection chosen: 1 pods
[2025-10-09T13:50:28.181+0000] {docker.py:438} INFO - âœ… [DEBUG] Selected pods: ['compose-post-service-67bcfcd5ff-bqrz2']
[2025-10-09T13:50:28.181+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Pods selected: 1
[2025-10-09T13:50:28.181+0000] {docker.py:438} INFO - 
[2025-10-09T13:50:28.182+0000] {docker.py:438} INFO - ðŸŽ¯ [DEBUG] Processing pod: compose-post-service-67bcfcd5ff-bqrz2
[2025-10-09T13:50:28.182+0000] {docker.py:438} INFO - ðŸ“¦ [DEBUG] Using provided container: compose-post-service
[2025-10-09T13:50:28.182+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:50:28.183+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:50:28.183+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 75
[2025-10-09T13:50:28.183+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=75
[2025-10-09T13:50:28.183+0000] {docker.py:438} INFO - ðŸ“Š [DEBUG] Restart count before action: 75
[2025-10-09T13:50:28.184+0000] {docker.py:438} INFO - ðŸ”§ [DEBUG] Restart strategies to try: [['sh', '-c', 'kill -INT 1'], ['sh', '-c', 'kill -2 1'], ['sh', '-c', 'kill -TERM 1'], ['sh', '-c', 'kill -9 1']]
[2025-10-09T13:50:28.184+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #1: sh -c kill -INT 1
[2025-10-09T13:50:28.184+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:50:28.184+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:50:27 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:50:28.185+0000] {docker.py:438} INFO - 
[2025-10-09T13:50:28.185+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #2: sh -c kill -2 1
[2025-10-09T13:50:28.186+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:50:28.186+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:50:27 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:50:28.186+0000] {docker.py:438} INFO - 
[2025-10-09T13:50:28.187+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #3: sh -c kill -TERM 1
[2025-10-09T13:50:28.187+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:50:28.187+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:50:27 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:50:28.187+0000] {docker.py:438} INFO - 
[2025-10-09T13:50:28.188+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #4: sh -c kill -9 1
[2025-10-09T13:50:28.188+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:50:28.188+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:50:28 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:50:28.189+0000] {docker.py:438} INFO - 
[2025-10-09T13:50:28.189+0000] {docker.py:438} INFO - âŒ [DEBUG] All strategies exhausted for pod compose-post-service-67bcfcd5ff-bqrz2 and no restart observed
[2025-10-09T13:50:28.189+0000] {docker.py:438} INFO - 
[2025-10-09T13:50:28.189+0000] {docker.py:438} INFO - ðŸ [DEBUG] restart_containers() finished. Processed 1 pods
[2025-10-09T13:50:28.190+0000] {docker.py:438} INFO -    [DEBUG] restart_containers returned 1 entries
[2025-10-09T13:50:28.190+0000] {docker.py:438} INFO - âœ… [DEBUG] Successfully restarted this cycle: 0
[2025-10-09T13:50:28.190+0000] {docker.py:438} INFO - âŒ [DEBUG] Failed restarts this cycle: 1
[2025-10-09T13:50:28.191+0000] {docker.py:438} INFO -    - compose-post-service-67bcfcd5ff-bqrz2 status=restart_failed details={'pod_name': 'compose-post-service-67bcfcd5ff-bqrz2', 'container_name': 'compose-post-service', 'status': 'restart_failed', 'before_count': 75, 'stdout': None, 'stderr': None, 'ctrl_err': None}
[2025-10-09T13:50:28.191+0000] {docker.py:438} INFO - â³ [DEBUG] Waiting 5 seconds until next cycle. Time remaining: 189s
[2025-10-09T13:50:46.984+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:50:46.985+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Container Restart Cycle #7 at 2025-10-09 13:50:33
[2025-10-09T13:50:46.986+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:50:46.987+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Entered restart_containers()
[2025-10-09T13:50:46.987+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, qty=2, rand=True, mode=fixed, ns=default, order=alphabetic, container_name=compose-post-service, restart_command=None
[2025-10-09T13:50:46.988+0000] {docker.py:438} INFO - ðŸ”‘ [DEBUG] Kubernetes API client created
[2025-10-09T13:50:46.988+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Selecting pods now...
[2025-10-09T13:50:46.988+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Entered _select_pods()
[2025-10-09T13:50:46.989+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, all=False, rand=True, mode=fixed, qty=2, ns=default, order=alphabetic
[2025-10-09T13:50:46.989+0000] {docker.py:438} INFO -    [DEBUG] Listing pods with label_selector=app=compose-post-service
[2025-10-09T13:50:46.990+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Found 1 pods initially
[2025-10-09T13:50:46.990+0000] {docker.py:438} INFO - ðŸŽ² [DEBUG] Random selection chosen: 1 pods
[2025-10-09T13:50:46.990+0000] {docker.py:438} INFO - âœ… [DEBUG] Selected pods: ['compose-post-service-67bcfcd5ff-bqrz2']
[2025-10-09T13:50:46.991+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Pods selected: 1
[2025-10-09T13:50:46.991+0000] {docker.py:438} INFO - 
[2025-10-09T13:50:46.994+0000] {docker.py:438} INFO - ðŸŽ¯ [DEBUG] Processing pod: compose-post-service-67bcfcd5ff-bqrz2
[2025-10-09T13:50:46.995+0000] {docker.py:438} INFO - ðŸ“¦ [DEBUG] Using provided container: compose-post-service
[2025-10-09T13:50:46.995+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:50:46.995+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:50:46.996+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 75
[2025-10-09T13:50:46.996+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=75
[2025-10-09T13:50:46.996+0000] {docker.py:438} INFO - ðŸ“Š [DEBUG] Restart count before action: 75
[2025-10-09T13:50:46.996+0000] {docker.py:438} INFO - ðŸ”§ [DEBUG] Restart strategies to try: [['sh', '-c', 'kill -INT 1'], ['sh', '-c', 'kill -2 1'], ['sh', '-c', 'kill -TERM 1'], ['sh', '-c', 'kill -9 1']]
[2025-10-09T13:50:46.997+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #1: sh -c kill -INT 1
[2025-10-09T13:50:46.997+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:50:46.997+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:50:33 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:50:46.998+0000] {docker.py:438} INFO - 
[2025-10-09T13:50:46.998+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #2: sh -c kill -2 1
[2025-10-09T13:50:46.998+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:50:46.999+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:50:34 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:50:46.999+0000] {docker.py:438} INFO - 
[2025-10-09T13:50:46.999+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #3: sh -c kill -TERM 1
[2025-10-09T13:50:47.000+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:50:47.000+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:50:34 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:50:47.001+0000] {docker.py:438} INFO - 
[2025-10-09T13:50:47.001+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #4: sh -c kill -9 1
[2025-10-09T13:50:47.001+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:50:47.002+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:50:34 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:50:47.002+0000] {docker.py:438} INFO - 
[2025-10-09T13:50:47.002+0000] {docker.py:438} INFO - âŒ [DEBUG] All strategies exhausted for pod compose-post-service-67bcfcd5ff-bqrz2 and no restart observed
[2025-10-09T13:50:47.003+0000] {docker.py:438} INFO - 
[2025-10-09T13:50:47.003+0000] {docker.py:438} INFO - ðŸ [DEBUG] restart_containers() finished. Processed 1 pods
[2025-10-09T13:50:47.003+0000] {docker.py:438} INFO -    [DEBUG] restart_containers returned 1 entries
[2025-10-09T13:50:47.003+0000] {docker.py:438} INFO - âœ… [DEBUG] Successfully restarted this cycle: 0
[2025-10-09T13:50:47.004+0000] {docker.py:438} INFO - âŒ [DEBUG] Failed restarts this cycle: 1
[2025-10-09T13:50:47.004+0000] {docker.py:438} INFO -    - compose-post-service-67bcfcd5ff-bqrz2 status=restart_failed details={'pod_name': 'compose-post-service-67bcfcd5ff-bqrz2', 'container_name': 'compose-post-service', 'status': 'restart_failed', 'before_count': 75, 'stdout': None, 'stderr': None, 'ctrl_err': None}
[2025-10-09T13:50:47.004+0000] {docker.py:438} INFO - â³ [DEBUG] Waiting 5 seconds until next cycle. Time remaining: 182s
[2025-10-09T13:50:47.005+0000] {docker.py:438} INFO - 
[2025-10-09T13:50:47.005+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:50:47.006+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Container Restart Cycle #8 at 2025-10-09 13:50:39
[2025-10-09T13:50:47.006+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:50:47.006+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Entered restart_containers()
[2025-10-09T13:50:47.007+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, qty=2, rand=True, mode=fixed, ns=default, order=alphabetic, container_name=compose-post-service, restart_command=None
[2025-10-09T13:50:47.007+0000] {docker.py:438} INFO - ðŸ”‘ [DEBUG] Kubernetes API client created
[2025-10-09T13:50:47.007+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Selecting pods now...
[2025-10-09T13:50:47.008+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Entered _select_pods()
[2025-10-09T13:50:47.008+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, all=False, rand=True, mode=fixed, qty=2, ns=default, order=alphabetic
[2025-10-09T13:50:47.008+0000] {docker.py:438} INFO -    [DEBUG] Listing pods with label_selector=app=compose-post-service
[2025-10-09T13:50:47.009+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Found 1 pods initially
[2025-10-09T13:50:47.009+0000] {docker.py:438} INFO - ðŸŽ² [DEBUG] Random selection chosen: 1 pods
[2025-10-09T13:50:47.009+0000] {docker.py:438} INFO - âœ… [DEBUG] Selected pods: ['compose-post-service-67bcfcd5ff-bqrz2']
[2025-10-09T13:50:47.009+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Pods selected: 1
[2025-10-09T13:50:47.010+0000] {docker.py:438} INFO - 
[2025-10-09T13:50:47.010+0000] {docker.py:438} INFO - ðŸŽ¯ [DEBUG] Processing pod: compose-post-service-67bcfcd5ff-bqrz2
[2025-10-09T13:50:47.010+0000] {docker.py:438} INFO - ðŸ“¦ [DEBUG] Using provided container: compose-post-service
[2025-10-09T13:50:47.010+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:50:47.011+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:50:47.011+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 75
[2025-10-09T13:50:47.011+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=75
[2025-10-09T13:50:47.011+0000] {docker.py:438} INFO - ðŸ“Š [DEBUG] Restart count before action: 75
[2025-10-09T13:50:47.011+0000] {docker.py:438} INFO - ðŸ”§ [DEBUG] Restart strategies to try: [['sh', '-c', 'kill -INT 1'], ['sh', '-c', 'kill -2 1'], ['sh', '-c', 'kill -TERM 1'], ['sh', '-c', 'kill -9 1']]
[2025-10-09T13:50:47.012+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #1: sh -c kill -INT 1
[2025-10-09T13:50:47.012+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:50:47.012+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:50:40 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:50:47.012+0000] {docker.py:438} INFO - 
[2025-10-09T13:50:47.013+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #2: sh -c kill -2 1
[2025-10-09T13:50:47.013+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:50:47.013+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:50:41 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:50:47.013+0000] {docker.py:438} INFO - 
[2025-10-09T13:50:47.014+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #3: sh -c kill -TERM 1
[2025-10-09T13:50:47.014+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:50:47.014+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:50:41 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:50:47.014+0000] {docker.py:438} INFO - 
[2025-10-09T13:50:47.014+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #4: sh -c kill -9 1
[2025-10-09T13:50:47.015+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:50:47.015+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:50:41 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:50:47.015+0000] {docker.py:438} INFO - 
[2025-10-09T13:50:47.015+0000] {docker.py:438} INFO - âŒ [DEBUG] All strategies exhausted for pod compose-post-service-67bcfcd5ff-bqrz2 and no restart observed
[2025-10-09T13:50:47.015+0000] {docker.py:438} INFO - 
[2025-10-09T13:50:47.016+0000] {docker.py:438} INFO - ðŸ [DEBUG] restart_containers() finished. Processed 1 pods
[2025-10-09T13:50:47.016+0000] {docker.py:438} INFO -    [DEBUG] restart_containers returned 1 entries
[2025-10-09T13:50:47.016+0000] {docker.py:438} INFO - âœ… [DEBUG] Successfully restarted this cycle: 0
[2025-10-09T13:50:47.016+0000] {docker.py:438} INFO - âŒ [DEBUG] Failed restarts this cycle: 1
[2025-10-09T13:50:47.017+0000] {docker.py:438} INFO -    - compose-post-service-67bcfcd5ff-bqrz2 status=restart_failed details={'pod_name': 'compose-post-service-67bcfcd5ff-bqrz2', 'container_name': 'compose-post-service', 'status': 'restart_failed', 'before_count': 75, 'stdout': None, 'stderr': None, 'ctrl_err': None}
[2025-10-09T13:50:47.017+0000] {docker.py:438} INFO - â³ [DEBUG] Waiting 5 seconds until next cycle. Time remaining: 175s
[2025-10-09T13:50:47.017+0000] {docker.py:438} INFO - 
[2025-10-09T13:50:47.017+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:50:47.017+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Container Restart Cycle #9 at 2025-10-09 13:50:46
[2025-10-09T13:50:47.018+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:50:47.018+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Entered restart_containers()
[2025-10-09T13:50:47.018+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, qty=2, rand=True, mode=fixed, ns=default, order=alphabetic, container_name=compose-post-service, restart_command=None
[2025-10-09T13:50:47.018+0000] {docker.py:438} INFO - ðŸ”‘ [DEBUG] Kubernetes API client created
[2025-10-09T13:50:47.018+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Selecting pods now...
[2025-10-09T13:50:47.019+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Entered _select_pods()
[2025-10-09T13:50:47.019+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, all=False, rand=True, mode=fixed, qty=2, ns=default, order=alphabetic
[2025-10-09T13:50:47.019+0000] {docker.py:438} INFO -    [DEBUG] Listing pods with label_selector=app=compose-post-service
[2025-10-09T13:50:47.019+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Found 1 pods initially
[2025-10-09T13:50:47.020+0000] {docker.py:438} INFO - ðŸŽ² [DEBUG] Random selection chosen: 1 pods
[2025-10-09T13:50:47.020+0000] {docker.py:438} INFO - âœ… [DEBUG] Selected pods: ['compose-post-service-67bcfcd5ff-bqrz2']
[2025-10-09T13:50:47.020+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Pods selected: 1
[2025-10-09T13:50:47.020+0000] {docker.py:438} INFO - 
[2025-10-09T13:50:47.020+0000] {docker.py:438} INFO - ðŸŽ¯ [DEBUG] Processing pod: compose-post-service-67bcfcd5ff-bqrz2
[2025-10-09T13:50:47.021+0000] {docker.py:438} INFO - ðŸ“¦ [DEBUG] Using provided container: compose-post-service
[2025-10-09T13:51:16.091+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:51:16.094+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:51:16.095+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 75
[2025-10-09T13:51:16.095+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=75
[2025-10-09T13:51:16.095+0000] {docker.py:438} INFO - ðŸ“Š [DEBUG] Restart count before action: 75
[2025-10-09T13:51:16.096+0000] {docker.py:438} INFO - ðŸ”§ [DEBUG] Restart strategies to try: [['sh', '-c', 'kill -INT 1'], ['sh', '-c', 'kill -2 1'], ['sh', '-c', 'kill -TERM 1'], ['sh', '-c', 'kill -9 1']]
[2025-10-09T13:51:16.096+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #1: sh -c kill -INT 1
[2025-10-09T13:51:16.097+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:51:16.098+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:50:47 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:51:16.098+0000] {docker.py:438} INFO - 
[2025-10-09T13:51:16.098+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #2: sh -c kill -2 1
[2025-10-09T13:51:16.099+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:51:16.100+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:50:47 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:51:16.100+0000] {docker.py:438} INFO - 
[2025-10-09T13:51:16.102+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #3: sh -c kill -TERM 1
[2025-10-09T13:51:16.102+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:51:16.102+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:50:48 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:51:16.103+0000] {docker.py:438} INFO - 
[2025-10-09T13:51:16.103+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #4: sh -c kill -9 1
[2025-10-09T13:51:16.104+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:51:16.104+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:50:48 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:51:16.104+0000] {docker.py:438} INFO - 
[2025-10-09T13:51:16.105+0000] {docker.py:438} INFO - âŒ [DEBUG] All strategies exhausted for pod compose-post-service-67bcfcd5ff-bqrz2 and no restart observed
[2025-10-09T13:51:16.106+0000] {docker.py:438} INFO - 
[2025-10-09T13:51:16.107+0000] {docker.py:438} INFO - ðŸ [DEBUG] restart_containers() finished. Processed 1 pods
[2025-10-09T13:51:16.107+0000] {docker.py:438} INFO -    [DEBUG] restart_containers returned 1 entries
[2025-10-09T13:51:16.107+0000] {docker.py:438} INFO - âœ… [DEBUG] Successfully restarted this cycle: 0
[2025-10-09T13:51:16.108+0000] {docker.py:438} INFO - âŒ [DEBUG] Failed restarts this cycle: 1
[2025-10-09T13:51:16.108+0000] {docker.py:438} INFO -    - compose-post-service-67bcfcd5ff-bqrz2 status=restart_failed details={'pod_name': 'compose-post-service-67bcfcd5ff-bqrz2', 'container_name': 'compose-post-service', 'status': 'restart_failed', 'before_count': 75, 'stdout': None, 'stderr': None, 'ctrl_err': None}
[2025-10-09T13:51:16.108+0000] {docker.py:438} INFO - â³ [DEBUG] Waiting 5 seconds until next cycle. Time remaining: 169s
[2025-10-09T13:51:16.109+0000] {docker.py:438} INFO - 
[2025-10-09T13:51:16.109+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:51:16.109+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Container Restart Cycle #10 at 2025-10-09 13:50:53
[2025-10-09T13:51:16.110+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:51:16.111+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Entered restart_containers()
[2025-10-09T13:51:16.111+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, qty=2, rand=True, mode=fixed, ns=default, order=alphabetic, container_name=compose-post-service, restart_command=None
[2025-10-09T13:51:16.111+0000] {docker.py:438} INFO - ðŸ”‘ [DEBUG] Kubernetes API client created
[2025-10-09T13:51:16.112+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Selecting pods now...
[2025-10-09T13:51:16.112+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Entered _select_pods()
[2025-10-09T13:51:16.113+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, all=False, rand=True, mode=fixed, qty=2, ns=default, order=alphabetic
[2025-10-09T13:51:16.113+0000] {docker.py:438} INFO -    [DEBUG] Listing pods with label_selector=app=compose-post-service
[2025-10-09T13:51:16.115+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Found 1 pods initially
[2025-10-09T13:51:16.116+0000] {docker.py:438} INFO - ðŸŽ² [DEBUG] Random selection chosen: 1 pods
[2025-10-09T13:51:16.116+0000] {docker.py:438} INFO - âœ… [DEBUG] Selected pods: ['compose-post-service-67bcfcd5ff-bqrz2']
[2025-10-09T13:51:16.116+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Pods selected: 1
[2025-10-09T13:51:16.117+0000] {docker.py:438} INFO - 
[2025-10-09T13:51:16.117+0000] {docker.py:438} INFO - ðŸŽ¯ [DEBUG] Processing pod: compose-post-service-67bcfcd5ff-bqrz2
[2025-10-09T13:51:16.117+0000] {docker.py:438} INFO - ðŸ“¦ [DEBUG] Using provided container: compose-post-service
[2025-10-09T13:51:16.118+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:51:16.118+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:51:16.119+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 76
[2025-10-09T13:51:16.119+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=76
[2025-10-09T13:51:16.119+0000] {docker.py:438} INFO - ðŸ“Š [DEBUG] Restart count before action: 76
[2025-10-09T13:51:16.120+0000] {docker.py:438} INFO - ðŸ”§ [DEBUG] Restart strategies to try: [['sh', '-c', 'kill -INT 1'], ['sh', '-c', 'kill -2 1'], ['sh', '-c', 'kill -TERM 1'], ['sh', '-c', 'kill -9 1']]
[2025-10-09T13:51:16.120+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #1: sh -c kill -INT 1
[2025-10-09T13:51:16.121+0000] {docker.py:438} INFO -    [DEBUG] Exec stream opened successfully, running command...
[2025-10-09T13:51:16.122+0000] {docker.py:438} INFO -    [DEBUG] run_forever returned/finished
[2025-10-09T13:51:16.122+0000] {docker.py:438} INFO -    ðŸ“¤ [DEBUG] STDOUT (truncated): 
[2025-10-09T13:51:16.124+0000] {docker.py:438} INFO -    ðŸ“¤ [DEBUG] STDERR (truncated): 
[2025-10-09T13:51:16.124+0000] {docker.py:438} INFO -    ðŸ“¤ [DEBUG] CTRL_ERR: {"metadata":{},"status":"Success"}
[2025-10-09T13:51:16.125+0000] {docker.py:438} INFO -    â³ [DEBUG] Waiting up to 60s for restart count to increment...
[2025-10-09T13:51:16.125+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:51:16.125+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:51:16.126+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 76
[2025-10-09T13:51:16.127+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=76
[2025-10-09T13:51:16.127+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 76 (before was 76)
[2025-10-09T13:51:16.128+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:51:16.128+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:51:16.129+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 76
[2025-10-09T13:51:16.130+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=76
[2025-10-09T13:51:16.131+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 76 (before was 76)
[2025-10-09T13:51:16.131+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:51:16.131+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:51:16.131+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 76
[2025-10-09T13:51:16.132+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=76
[2025-10-09T13:51:16.132+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 76 (before was 76)
[2025-10-09T13:51:16.132+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:51:16.133+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:51:16.133+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 76
[2025-10-09T13:51:16.133+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=76
[2025-10-09T13:51:16.135+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 76 (before was 76)
[2025-10-09T13:51:16.136+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:51:16.136+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:51:16.136+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 76
[2025-10-09T13:51:16.137+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=76
[2025-10-09T13:51:16.137+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 76 (before was 76)
[2025-10-09T13:51:16.137+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:51:16.137+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:51:16.138+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 76
[2025-10-09T13:51:16.138+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=76
[2025-10-09T13:51:16.140+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 76 (before was 76)
[2025-10-09T13:51:16.140+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:51:16.141+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:51:16.141+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 76
[2025-10-09T13:51:16.141+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=76
[2025-10-09T13:51:16.141+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 76 (before was 76)
[2025-10-09T13:51:16.142+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:51:16.142+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:51:16.142+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 76
[2025-10-09T13:51:16.143+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=76
[2025-10-09T13:51:16.143+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 76 (before was 76)
[2025-10-09T13:51:16.143+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:51:16.143+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:51:16.144+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 76
[2025-10-09T13:51:16.144+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=76
[2025-10-09T13:51:16.145+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 76 (before was 76)
[2025-10-09T13:51:16.146+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:51:16.146+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:51:16.147+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 76
[2025-10-09T13:51:16.148+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=76
[2025-10-09T13:51:16.148+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 76 (before was 76)
[2025-10-09T13:51:16.148+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:51:16.149+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:51:27.577+0000] {job.py:239} ERROR - Job heartbeat failed with error
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (127.0.0.1), port 5433 failed: FATAL:  the database system is in recovery mode


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/jobs/job.py", line 207, in heartbeat
    self._merge_from(Job._fetch_from_db(self, session))
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/retries.py", line 93, in wrapped_function
    for attempt in run_with_db_retries(max_retries=retries, logger=logger, **retry_kwargs):
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/retries.py", line 102, in wrapped_function
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/jobs/job.py", line 335, in _fetch_from_db
    session.merge(job)
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3056, in merge
    return self._merge(
           ^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3136, in _merge
    merged = self.get(
             ^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2853, in get
    return self._get_impl(
           ^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2975, in _get_impl
    return db_load_fn(
           ^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/loading.py", line 530, in load_on_pk_identity
    session.execute(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 750, in _connection_for_bind
    conn = bind.connect()
           ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/future/engine.py", line 412, in connect
    return super(Engine, self).connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3325, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3404, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3374, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2208, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: FATAL:  the database system is in recovery mode

(Background on this error at: https://sqlalche.me/e/14/e3q8)
[2025-10-09T13:51:27.603+0000] {job.py:245} ERROR - Job heartbeat failed with error. Scheduler may go into unhealthy state
[2025-10-09T13:51:32.652+0000] {job.py:229} INFO - Heartbeat recovered after 12.02 seconds
[2025-10-09T13:52:01.458+0000] {docker.py:438} INFO - [DEBUG] container: compose-post-service, restart_count: 76
[2025-10-09T13:52:01.464+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=76
[2025-10-09T13:52:01.465+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 76 (before was 76)
[2025-10-09T13:52:01.466+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:52:01.466+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:52:01.466+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 76
[2025-10-09T13:52:01.467+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=76
[2025-10-09T13:52:01.467+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 76 (before was 76)
[2025-10-09T13:52:01.467+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:52:01.469+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:52:01.469+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 76
[2025-10-09T13:52:01.469+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=76
[2025-10-09T13:52:01.469+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 76 (before was 76)
[2025-10-09T13:52:01.470+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:52:01.470+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:52:01.472+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 76
[2025-10-09T13:52:01.472+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=76
[2025-10-09T13:52:01.472+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 76 (before was 76)
[2025-10-09T13:52:01.473+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:52:01.473+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:52:01.473+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 76
[2025-10-09T13:52:01.475+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=76
[2025-10-09T13:52:01.476+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 76 (before was 76)
[2025-10-09T13:52:01.476+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:52:01.476+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:52:01.477+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 76
[2025-10-09T13:52:01.477+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=76
[2025-10-09T13:52:01.477+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 76 (before was 76)
[2025-10-09T13:52:01.478+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:52:01.478+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:52:01.478+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 76
[2025-10-09T13:52:01.478+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=76
[2025-10-09T13:52:01.479+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 76 (before was 76)
[2025-10-09T13:52:01.479+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:52:01.481+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:52:01.482+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 76
[2025-10-09T13:52:01.482+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=76
[2025-10-09T13:52:01.482+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 76 (before was 76)
[2025-10-09T13:52:01.482+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:52:01.483+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:52:01.483+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 76
[2025-10-09T13:52:01.483+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=76
[2025-10-09T13:52:01.484+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 76 (before was 76)
[2025-10-09T13:52:01.484+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:52:01.484+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:52:01.484+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 76
[2025-10-09T13:52:01.485+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=76
[2025-10-09T13:52:01.485+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 76 (before was 76)
[2025-10-09T13:52:01.487+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:52:01.488+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:52:01.488+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 76
[2025-10-09T13:52:01.488+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=76
[2025-10-09T13:52:01.488+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 76 (before was 76)
[2025-10-09T13:52:01.489+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:52:01.489+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:52:01.489+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 76
[2025-10-09T13:52:01.490+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=76
[2025-10-09T13:52:01.490+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 76 (before was 76)
[2025-10-09T13:52:01.490+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:52:01.490+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:52:01.491+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 76
[2025-10-09T13:52:01.491+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=76
[2025-10-09T13:52:01.493+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 76 (before was 76)
[2025-10-09T13:52:01.494+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:52:01.494+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:52:01.494+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 76
[2025-10-09T13:52:01.495+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=76
[2025-10-09T13:52:01.495+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 76 (before was 76)
[2025-10-09T13:52:01.495+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:52:01.497+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:52:01.498+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 76
[2025-10-09T13:52:01.498+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=76
[2025-10-09T13:52:01.498+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 76 (before was 76)
[2025-10-09T13:52:01.499+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:52:01.499+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:52:01.499+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 76
[2025-10-09T13:52:01.499+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=76
[2025-10-09T13:52:01.500+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 76 (before was 76)
[2025-10-09T13:52:01.500+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:52:01.500+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:52:01.501+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 76
[2025-10-09T13:52:01.501+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=76
[2025-10-09T13:52:01.501+0000] {docker.py:438} INFO -    [DEBUG] Polled restart count: 76 (before was 76)
[2025-10-09T13:52:01.503+0000] {docker.py:438} INFO -    âš ï¸ [DEBUG] This strategy did not result in a restart, going to next strategy if any
[2025-10-09T13:52:01.504+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #2: sh -c kill -2 1
[2025-10-09T13:52:01.504+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:52:01.504+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:51:55 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:52:01.505+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:01.505+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #3: sh -c kill -TERM 1
[2025-10-09T13:52:01.505+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:52:01.505+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:51:55 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:52:01.506+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:01.506+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #4: sh -c kill -9 1
[2025-10-09T13:52:01.506+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:52:01.507+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:51:56 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:52:01.507+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:01.509+0000] {docker.py:438} INFO - âŒ [DEBUG] All strategies exhausted for pod compose-post-service-67bcfcd5ff-bqrz2 and no restart observed
[2025-10-09T13:52:01.510+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:01.510+0000] {docker.py:438} INFO - ðŸ [DEBUG] restart_containers() finished. Processed 1 pods
[2025-10-09T13:52:01.510+0000] {docker.py:438} INFO -    [DEBUG] restart_containers returned 1 entries
[2025-10-09T13:52:01.510+0000] {docker.py:438} INFO - âœ… [DEBUG] Successfully restarted this cycle: 0
[2025-10-09T13:52:01.511+0000] {docker.py:438} INFO - âŒ [DEBUG] Failed restarts this cycle: 1
[2025-10-09T13:52:01.511+0000] {docker.py:438} INFO -    - compose-post-service-67bcfcd5ff-bqrz2 status=restart_failed details={'pod_name': 'compose-post-service-67bcfcd5ff-bqrz2', 'container_name': 'compose-post-service', 'status': 'restart_failed', 'before_count': 76, 'stdout': '', 'stderr': '', 'ctrl_err': '{"metadata":{},"status":"Success"}'}
[2025-10-09T13:52:01.511+0000] {docker.py:438} INFO - â³ [DEBUG] Waiting 5 seconds until next cycle. Time remaining: 101s
[2025-10-09T13:52:01.511+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:01.512+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:52:01.512+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Container Restart Cycle #11 at 2025-10-09 13:52:01
[2025-10-09T13:52:01.512+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:52:01.513+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Entered restart_containers()
[2025-10-09T13:52:01.513+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, qty=2, rand=True, mode=fixed, ns=default, order=alphabetic, container_name=compose-post-service, restart_command=None
[2025-10-09T13:52:01.515+0000] {docker.py:438} INFO - ðŸ”‘ [DEBUG] Kubernetes API client created
[2025-10-09T13:52:13.727+0000] {job.py:239} ERROR - Job heartbeat failed with error
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (127.0.0.1), port 5433 failed: FATAL:  the database system is in recovery mode


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/jobs/job.py", line 207, in heartbeat
    self._merge_from(Job._fetch_from_db(self, session))
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/retries.py", line 93, in wrapped_function
    for attempt in run_with_db_retries(max_retries=retries, logger=logger, **retry_kwargs):
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/retries.py", line 102, in wrapped_function
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/jobs/job.py", line 335, in _fetch_from_db
    session.merge(job)
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3056, in merge
    return self._merge(
           ^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3136, in _merge
    merged = self.get(
             ^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2853, in get
    return self._get_impl(
           ^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2975, in _get_impl
    return db_load_fn(
           ^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/loading.py", line 530, in load_on_pk_identity
    session.execute(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 750, in _connection_for_bind
    conn = bind.connect()
           ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/future/engine.py", line 412, in connect
    return super(Engine, self).connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3325, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3404, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3374, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2208, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: FATAL:  the database system is in recovery mode

(Background on this error at: https://sqlalche.me/e/14/e3q8)
[2025-10-09T13:52:13.806+0000] {job.py:254} ERROR - Job heartbeat failed with error. Scheduler is in unhealthy state
[2025-10-09T13:52:18.861+0000] {job.py:229} INFO - Heartbeat recovered after 15.85 seconds
[2025-10-09T13:52:20.807+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Selecting pods now...
[2025-10-09T13:52:20.808+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Entered _select_pods()
[2025-10-09T13:52:20.808+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, all=False, rand=True, mode=fixed, qty=2, ns=default, order=alphabetic
[2025-10-09T13:52:20.809+0000] {docker.py:438} INFO -    [DEBUG] Listing pods with label_selector=app=compose-post-service
[2025-10-09T13:52:20.813+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Found 1 pods initially
[2025-10-09T13:52:20.814+0000] {docker.py:438} INFO - ðŸŽ² [DEBUG] Random selection chosen: 1 pods
[2025-10-09T13:52:20.814+0000] {docker.py:438} INFO - âœ… [DEBUG] Selected pods: ['compose-post-service-67bcfcd5ff-bqrz2']
[2025-10-09T13:52:20.814+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Pods selected: 1
[2025-10-09T13:52:20.814+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:20.815+0000] {docker.py:438} INFO - ðŸŽ¯ [DEBUG] Processing pod: compose-post-service-67bcfcd5ff-bqrz2
[2025-10-09T13:52:20.815+0000] {docker.py:438} INFO - ðŸ“¦ [DEBUG] Using provided container: compose-post-service
[2025-10-09T13:52:20.820+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:52:20.820+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:52:20.820+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 76
[2025-10-09T13:52:20.821+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=76
[2025-10-09T13:52:20.821+0000] {docker.py:438} INFO - ðŸ“Š [DEBUG] Restart count before action: 76
[2025-10-09T13:52:20.823+0000] {docker.py:438} INFO - ðŸ”§ [DEBUG] Restart strategies to try: [['sh', '-c', 'kill -INT 1'], ['sh', '-c', 'kill -2 1'], ['sh', '-c', 'kill -TERM 1'], ['sh', '-c', 'kill -9 1']]
[2025-10-09T13:52:20.823+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #1: sh -c kill -INT 1
[2025-10-09T13:52:20.824+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:52:20.824+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:52:02 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:52:20.827+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:20.828+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #2: sh -c kill -2 1
[2025-10-09T13:52:20.828+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:52:20.828+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:52:02 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:52:20.829+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:20.829+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #3: sh -c kill -TERM 1
[2025-10-09T13:52:20.833+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:52:20.834+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:52:02 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:52:20.834+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:20.834+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #4: sh -c kill -9 1
[2025-10-09T13:52:20.835+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:52:20.835+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:52:03 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:52:20.837+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:20.837+0000] {docker.py:438} INFO - âŒ [DEBUG] All strategies exhausted for pod compose-post-service-67bcfcd5ff-bqrz2 and no restart observed
[2025-10-09T13:52:20.838+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:20.838+0000] {docker.py:438} INFO - ðŸ [DEBUG] restart_containers() finished. Processed 1 pods
[2025-10-09T13:52:20.838+0000] {docker.py:438} INFO -    [DEBUG] restart_containers returned 1 entries
[2025-10-09T13:52:20.839+0000] {docker.py:438} INFO - âœ… [DEBUG] Successfully restarted this cycle: 0
[2025-10-09T13:52:20.839+0000] {docker.py:438} INFO - âŒ [DEBUG] Failed restarts this cycle: 1
[2025-10-09T13:52:20.841+0000] {docker.py:438} INFO -    - compose-post-service-67bcfcd5ff-bqrz2 status=restart_failed details={'pod_name': 'compose-post-service-67bcfcd5ff-bqrz2', 'container_name': 'compose-post-service', 'status': 'restart_failed', 'before_count': 76, 'stdout': None, 'stderr': None, 'ctrl_err': None}
[2025-10-09T13:52:20.843+0000] {docker.py:438} INFO - â³ [DEBUG] Waiting 5 seconds until next cycle. Time remaining: 94s
[2025-10-09T13:52:20.844+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:20.844+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:52:20.844+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Container Restart Cycle #12 at 2025-10-09 13:52:09
[2025-10-09T13:52:20.845+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:52:20.845+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Entered restart_containers()
[2025-10-09T13:52:20.846+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, qty=2, rand=True, mode=fixed, ns=default, order=alphabetic, container_name=compose-post-service, restart_command=None
[2025-10-09T13:52:20.846+0000] {docker.py:438} INFO - ðŸ”‘ [DEBUG] Kubernetes API client created
[2025-10-09T13:52:20.847+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Selecting pods now...
[2025-10-09T13:52:20.847+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Entered _select_pods()
[2025-10-09T13:52:20.847+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, all=False, rand=True, mode=fixed, qty=2, ns=default, order=alphabetic
[2025-10-09T13:52:20.848+0000] {docker.py:438} INFO -    [DEBUG] Listing pods with label_selector=app=compose-post-service
[2025-10-09T13:52:20.848+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Found 1 pods initially
[2025-10-09T13:52:20.851+0000] {docker.py:438} INFO - ðŸŽ² [DEBUG] Random selection chosen: 1 pods
[2025-10-09T13:52:20.852+0000] {docker.py:438} INFO - âœ… [DEBUG] Selected pods: ['compose-post-service-67bcfcd5ff-bqrz2']
[2025-10-09T13:52:20.852+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Pods selected: 1
[2025-10-09T13:52:20.852+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:20.853+0000] {docker.py:438} INFO - ðŸŽ¯ [DEBUG] Processing pod: compose-post-service-67bcfcd5ff-bqrz2
[2025-10-09T13:52:20.853+0000] {docker.py:438} INFO - ðŸ“¦ [DEBUG] Using provided container: compose-post-service
[2025-10-09T13:52:20.855+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:52:20.855+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:52:20.856+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 76
[2025-10-09T13:52:20.856+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=76
[2025-10-09T13:52:20.856+0000] {docker.py:438} INFO - ðŸ“Š [DEBUG] Restart count before action: 76
[2025-10-09T13:52:20.857+0000] {docker.py:438} INFO - ðŸ”§ [DEBUG] Restart strategies to try: [['sh', '-c', 'kill -INT 1'], ['sh', '-c', 'kill -2 1'], ['sh', '-c', 'kill -TERM 1'], ['sh', '-c', 'kill -9 1']]
[2025-10-09T13:52:20.857+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #1: sh -c kill -INT 1
[2025-10-09T13:52:20.857+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:52:20.858+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:52:14 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:52:20.858+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:20.858+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #2: sh -c kill -2 1
[2025-10-09T13:52:20.859+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:52:20.859+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:52:14 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:52:20.859+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:20.860+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #3: sh -c kill -TERM 1
[2025-10-09T13:52:20.860+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:52:20.860+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:52:14 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:52:20.861+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:20.861+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #4: sh -c kill -9 1
[2025-10-09T13:52:20.861+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:52:20.862+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:52:15 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:52:20.862+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:20.862+0000] {docker.py:438} INFO - âŒ [DEBUG] All strategies exhausted for pod compose-post-service-67bcfcd5ff-bqrz2 and no restart observed
[2025-10-09T13:52:20.862+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:20.863+0000] {docker.py:438} INFO - ðŸ [DEBUG] restart_containers() finished. Processed 1 pods
[2025-10-09T13:52:20.863+0000] {docker.py:438} INFO -    [DEBUG] restart_containers returned 1 entries
[2025-10-09T13:52:20.863+0000] {docker.py:438} INFO - âœ… [DEBUG] Successfully restarted this cycle: 0
[2025-10-09T13:52:20.864+0000] {docker.py:438} INFO - âŒ [DEBUG] Failed restarts this cycle: 1
[2025-10-09T13:52:20.864+0000] {docker.py:438} INFO -    - compose-post-service-67bcfcd5ff-bqrz2 status=restart_failed details={'pod_name': 'compose-post-service-67bcfcd5ff-bqrz2', 'container_name': 'compose-post-service', 'status': 'restart_failed', 'before_count': 76, 'stdout': None, 'stderr': None, 'ctrl_err': None}
[2025-10-09T13:52:20.864+0000] {docker.py:438} INFO - â³ [DEBUG] Waiting 5 seconds until next cycle. Time remaining: 82s
[2025-10-09T13:52:20.865+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:20.865+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:52:20.865+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Container Restart Cycle #13 at 2025-10-09 13:52:20
[2025-10-09T13:52:20.866+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:52:20.866+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Entered restart_containers()
[2025-10-09T13:52:20.866+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, qty=2, rand=True, mode=fixed, ns=default, order=alphabetic, container_name=compose-post-service, restart_command=None
[2025-10-09T13:52:20.867+0000] {docker.py:438} INFO - ðŸ”‘ [DEBUG] Kubernetes API client created
[2025-10-09T13:52:20.867+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Selecting pods now...
[2025-10-09T13:52:20.867+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Entered _select_pods()
[2025-10-09T13:52:20.868+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, all=False, rand=True, mode=fixed, qty=2, ns=default, order=alphabetic
[2025-10-09T13:52:20.868+0000] {docker.py:438} INFO -    [DEBUG] Listing pods with label_selector=app=compose-post-service
[2025-10-09T13:52:20.868+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Found 1 pods initially
[2025-10-09T13:52:20.868+0000] {docker.py:438} INFO - ðŸŽ² [DEBUG] Random selection chosen: 1 pods
[2025-10-09T13:52:20.869+0000] {docker.py:438} INFO - âœ… [DEBUG] Selected pods: ['compose-post-service-67bcfcd5ff-bqrz2']
[2025-10-09T13:52:20.869+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Pods selected: 1
[2025-10-09T13:52:20.869+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:20.870+0000] {docker.py:438} INFO - ðŸŽ¯ [DEBUG] Processing pod: compose-post-service-67bcfcd5ff-bqrz2
[2025-10-09T13:52:20.870+0000] {docker.py:438} INFO - ðŸ“¦ [DEBUG] Using provided container: compose-post-service
[2025-10-09T13:52:20.870+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:52:20.871+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:52:20.871+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 76
[2025-10-09T13:52:20.871+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=76
[2025-10-09T13:52:20.872+0000] {docker.py:438} INFO - ðŸ“Š [DEBUG] Restart count before action: 76
[2025-10-09T13:52:20.872+0000] {docker.py:438} INFO - ðŸ”§ [DEBUG] Restart strategies to try: [['sh', '-c', 'kill -INT 1'], ['sh', '-c', 'kill -2 1'], ['sh', '-c', 'kill -TERM 1'], ['sh', '-c', 'kill -9 1']]
[2025-10-09T13:52:35.991+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #1: sh -c kill -INT 1
[2025-10-09T13:52:35.992+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:52:35.992+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:52:21 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:52:35.993+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:35.993+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #2: sh -c kill -2 1
[2025-10-09T13:52:35.995+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:52:35.995+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:52:21 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:52:35.995+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:35.996+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #3: sh -c kill -TERM 1
[2025-10-09T13:52:35.996+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:52:35.998+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:52:22 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:52:35.999+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:35.999+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #4: sh -c kill -9 1
[2025-10-09T13:52:36.000+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:52:36.000+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:52:22 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:52:36.000+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:36.001+0000] {docker.py:438} INFO - âŒ [DEBUG] All strategies exhausted for pod compose-post-service-67bcfcd5ff-bqrz2 and no restart observed
[2025-10-09T13:52:36.001+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:36.001+0000] {docker.py:438} INFO - ðŸ [DEBUG] restart_containers() finished. Processed 1 pods
[2025-10-09T13:52:36.002+0000] {docker.py:438} INFO -    [DEBUG] restart_containers returned 1 entries
[2025-10-09T13:52:36.002+0000] {docker.py:438} INFO - âœ… [DEBUG] Successfully restarted this cycle: 0
[2025-10-09T13:52:36.002+0000] {docker.py:438} INFO - âŒ [DEBUG] Failed restarts this cycle: 1
[2025-10-09T13:52:36.004+0000] {docker.py:438} INFO -    - compose-post-service-67bcfcd5ff-bqrz2 status=restart_failed details={'pod_name': 'compose-post-service-67bcfcd5ff-bqrz2', 'container_name': 'compose-post-service', 'status': 'restart_failed', 'before_count': 76, 'stdout': None, 'stderr': None, 'ctrl_err': None}
[2025-10-09T13:52:36.005+0000] {docker.py:438} INFO - â³ [DEBUG] Waiting 5 seconds until next cycle. Time remaining: 75s
[2025-10-09T13:52:36.006+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:36.006+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:52:36.008+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Container Restart Cycle #14 at 2025-10-09 13:52:27
[2025-10-09T13:52:36.008+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:52:36.009+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Entered restart_containers()
[2025-10-09T13:52:36.010+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, qty=2, rand=True, mode=fixed, ns=default, order=alphabetic, container_name=compose-post-service, restart_command=None
[2025-10-09T13:52:36.011+0000] {docker.py:438} INFO - ðŸ”‘ [DEBUG] Kubernetes API client created
[2025-10-09T13:52:36.011+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Selecting pods now...
[2025-10-09T13:52:36.014+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Entered _select_pods()
[2025-10-09T13:52:36.014+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, all=False, rand=True, mode=fixed, qty=2, ns=default, order=alphabetic
[2025-10-09T13:52:36.015+0000] {docker.py:438} INFO -    [DEBUG] Listing pods with label_selector=app=compose-post-service
[2025-10-09T13:52:36.016+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Found 1 pods initially
[2025-10-09T13:52:36.016+0000] {docker.py:438} INFO - ðŸŽ² [DEBUG] Random selection chosen: 1 pods
[2025-10-09T13:52:36.018+0000] {docker.py:438} INFO - âœ… [DEBUG] Selected pods: ['compose-post-service-67bcfcd5ff-bqrz2']
[2025-10-09T13:52:36.018+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Pods selected: 1
[2025-10-09T13:52:36.020+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:36.021+0000] {docker.py:438} INFO - ðŸŽ¯ [DEBUG] Processing pod: compose-post-service-67bcfcd5ff-bqrz2
[2025-10-09T13:52:36.023+0000] {docker.py:438} INFO - ðŸ“¦ [DEBUG] Using provided container: compose-post-service
[2025-10-09T13:52:36.024+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:52:36.024+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:52:36.026+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 76
[2025-10-09T13:52:36.027+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=76
[2025-10-09T13:52:36.027+0000] {docker.py:438} INFO - ðŸ“Š [DEBUG] Restart count before action: 76
[2025-10-09T13:52:36.028+0000] {docker.py:438} INFO - ðŸ”§ [DEBUG] Restart strategies to try: [['sh', '-c', 'kill -INT 1'], ['sh', '-c', 'kill -2 1'], ['sh', '-c', 'kill -TERM 1'], ['sh', '-c', 'kill -9 1']]
[2025-10-09T13:52:36.028+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #1: sh -c kill -INT 1
[2025-10-09T13:52:36.028+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:52:36.028+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:52:28 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:52:36.032+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:36.032+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #2: sh -c kill -2 1
[2025-10-09T13:52:36.033+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:52:36.034+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:52:28 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:52:36.034+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:36.036+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #3: sh -c kill -TERM 1
[2025-10-09T13:52:36.038+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:52:36.038+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:52:28 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:52:36.039+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:36.039+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #4: sh -c kill -9 1
[2025-10-09T13:52:36.039+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:52:36.040+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:52:29 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:52:36.040+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:36.040+0000] {docker.py:438} INFO - âŒ [DEBUG] All strategies exhausted for pod compose-post-service-67bcfcd5ff-bqrz2 and no restart observed
[2025-10-09T13:52:36.040+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:36.041+0000] {docker.py:438} INFO - ðŸ [DEBUG] restart_containers() finished. Processed 1 pods
[2025-10-09T13:52:36.042+0000] {docker.py:438} INFO -    [DEBUG] restart_containers returned 1 entries
[2025-10-09T13:52:36.043+0000] {docker.py:438} INFO - âœ… [DEBUG] Successfully restarted this cycle: 0
[2025-10-09T13:52:36.043+0000] {docker.py:438} INFO - âŒ [DEBUG] Failed restarts this cycle: 1
[2025-10-09T13:52:36.044+0000] {docker.py:438} INFO -    - compose-post-service-67bcfcd5ff-bqrz2 status=restart_failed details={'pod_name': 'compose-post-service-67bcfcd5ff-bqrz2', 'container_name': 'compose-post-service', 'status': 'restart_failed', 'before_count': 76, 'stdout': None, 'stderr': None, 'ctrl_err': None}
[2025-10-09T13:52:36.044+0000] {docker.py:438} INFO - â³ [DEBUG] Waiting 5 seconds until next cycle. Time remaining: 68s
[2025-10-09T13:52:36.045+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:36.045+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:52:36.046+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Container Restart Cycle #15 at 2025-10-09 13:52:34
[2025-10-09T13:52:36.047+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:52:36.049+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Entered restart_containers()
[2025-10-09T13:52:36.050+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, qty=2, rand=True, mode=fixed, ns=default, order=alphabetic, container_name=compose-post-service, restart_command=None
[2025-10-09T13:52:36.050+0000] {docker.py:438} INFO - ðŸ”‘ [DEBUG] Kubernetes API client created
[2025-10-09T13:52:36.050+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Selecting pods now...
[2025-10-09T13:52:36.051+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Entered _select_pods()
[2025-10-09T13:52:36.051+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, all=False, rand=True, mode=fixed, qty=2, ns=default, order=alphabetic
[2025-10-09T13:52:36.053+0000] {docker.py:438} INFO -    [DEBUG] Listing pods with label_selector=app=compose-post-service
[2025-10-09T13:52:36.053+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Found 1 pods initially
[2025-10-09T13:52:36.054+0000] {docker.py:438} INFO - ðŸŽ² [DEBUG] Random selection chosen: 1 pods
[2025-10-09T13:52:36.055+0000] {docker.py:438} INFO - âœ… [DEBUG] Selected pods: ['compose-post-service-67bcfcd5ff-bqrz2']
[2025-10-09T13:52:36.055+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Pods selected: 1
[2025-10-09T13:52:36.056+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:36.056+0000] {docker.py:438} INFO - ðŸŽ¯ [DEBUG] Processing pod: compose-post-service-67bcfcd5ff-bqrz2
[2025-10-09T13:52:36.057+0000] {docker.py:438} INFO - ðŸ“¦ [DEBUG] Using provided container: compose-post-service
[2025-10-09T13:52:36.057+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:52:36.059+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:52:36.059+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 76
[2025-10-09T13:52:36.060+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=76
[2025-10-09T13:52:36.060+0000] {docker.py:438} INFO - ðŸ“Š [DEBUG] Restart count before action: 76
[2025-10-09T13:52:36.060+0000] {docker.py:438} INFO - ðŸ”§ [DEBUG] Restart strategies to try: [['sh', '-c', 'kill -INT 1'], ['sh', '-c', 'kill -2 1'], ['sh', '-c', 'kill -TERM 1'], ['sh', '-c', 'kill -9 1']]
[2025-10-09T13:52:36.061+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #1: sh -c kill -INT 1
[2025-10-09T13:52:36.063+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:52:36.064+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:52:35 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:52:36.065+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:36.066+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #2: sh -c kill -2 1
[2025-10-09T13:52:36.066+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:52:36.067+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:52:35 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:52:36.068+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:36.068+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #3: sh -c kill -TERM 1
[2025-10-09T13:52:36.068+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:52:36.068+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:52:35 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:52:36.069+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:36.071+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #4: sh -c kill -9 1
[2025-10-09T13:52:57.644+0000] {docker.py:438} INFO - âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:52:57.754+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:52:36 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:52:57.754+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:57.755+0000] {docker.py:438} INFO - âŒ [DEBUG] All strategies exhausted for pod compose-post-service-67bcfcd5ff-bqrz2 and no restart observed
[2025-10-09T13:52:57.756+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:57.757+0000] {docker.py:438} INFO - ðŸ [DEBUG] restart_containers() finished. Processed 1 pods
[2025-10-09T13:52:57.757+0000] {docker.py:438} INFO -    [DEBUG] restart_containers returned 1 entries
[2025-10-09T13:52:57.758+0000] {docker.py:438} INFO - âœ… [DEBUG] Successfully restarted this cycle: 0
[2025-10-09T13:52:57.758+0000] {docker.py:438} INFO - âŒ [DEBUG] Failed restarts this cycle: 1
[2025-10-09T13:52:57.758+0000] {docker.py:438} INFO -    - compose-post-service-67bcfcd5ff-bqrz2 status=restart_failed details={'pod_name': 'compose-post-service-67bcfcd5ff-bqrz2', 'container_name': 'compose-post-service', 'status': 'restart_failed', 'before_count': 76, 'stdout': None, 'stderr': None, 'ctrl_err': None}
[2025-10-09T13:52:57.758+0000] {docker.py:438} INFO - â³ [DEBUG] Waiting 5 seconds until next cycle. Time remaining: 61s
[2025-10-09T13:52:57.759+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:57.759+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:52:57.759+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Container Restart Cycle #16 at 2025-10-09 13:52:41
[2025-10-09T13:52:57.759+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:52:57.760+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Entered restart_containers()
[2025-10-09T13:52:57.760+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, qty=2, rand=True, mode=fixed, ns=default, order=alphabetic, container_name=compose-post-service, restart_command=None
[2025-10-09T13:52:57.760+0000] {docker.py:438} INFO - ðŸ”‘ [DEBUG] Kubernetes API client created
[2025-10-09T13:52:57.761+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Selecting pods now...
[2025-10-09T13:52:57.761+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Entered _select_pods()
[2025-10-09T13:52:57.761+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, all=False, rand=True, mode=fixed, qty=2, ns=default, order=alphabetic
[2025-10-09T13:52:57.761+0000] {docker.py:438} INFO -    [DEBUG] Listing pods with label_selector=app=compose-post-service
[2025-10-09T13:52:57.761+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Found 1 pods initially
[2025-10-09T13:52:57.762+0000] {docker.py:438} INFO - ðŸŽ² [DEBUG] Random selection chosen: 1 pods
[2025-10-09T13:52:57.762+0000] {docker.py:438} INFO - âœ… [DEBUG] Selected pods: ['compose-post-service-67bcfcd5ff-bqrz2']
[2025-10-09T13:52:57.762+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Pods selected: 1
[2025-10-09T13:52:57.762+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:57.762+0000] {docker.py:438} INFO - ðŸŽ¯ [DEBUG] Processing pod: compose-post-service-67bcfcd5ff-bqrz2
[2025-10-09T13:52:57.763+0000] {docker.py:438} INFO - ðŸ“¦ [DEBUG] Using provided container: compose-post-service
[2025-10-09T13:52:57.763+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:52:57.763+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:52:57.763+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 76
[2025-10-09T13:52:57.764+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=76
[2025-10-09T13:52:57.764+0000] {docker.py:438} INFO - ðŸ“Š [DEBUG] Restart count before action: 76
[2025-10-09T13:52:57.764+0000] {docker.py:438} INFO - ðŸ”§ [DEBUG] Restart strategies to try: [['sh', '-c', 'kill -INT 1'], ['sh', '-c', 'kill -2 1'], ['sh', '-c', 'kill -TERM 1'], ['sh', '-c', 'kill -9 1']]
[2025-10-09T13:52:57.764+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #1: sh -c kill -INT 1
[2025-10-09T13:52:57.764+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:52:57.765+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:52:42 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:52:57.765+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:57.765+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #2: sh -c kill -2 1
[2025-10-09T13:52:57.765+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:52:57.765+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:52:42 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:52:57.766+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:57.766+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #3: sh -c kill -TERM 1
[2025-10-09T13:52:57.766+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:52:57.766+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:52:42 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:52:57.767+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:57.767+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #4: sh -c kill -9 1
[2025-10-09T13:52:57.767+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:52:57.767+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:52:43 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:52:57.767+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:57.768+0000] {docker.py:438} INFO - âŒ [DEBUG] All strategies exhausted for pod compose-post-service-67bcfcd5ff-bqrz2 and no restart observed
[2025-10-09T13:52:57.768+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:57.768+0000] {docker.py:438} INFO - ðŸ [DEBUG] restart_containers() finished. Processed 1 pods
[2025-10-09T13:52:57.768+0000] {docker.py:438} INFO -    [DEBUG] restart_containers returned 1 entries
[2025-10-09T13:52:57.769+0000] {docker.py:438} INFO - âœ… [DEBUG] Successfully restarted this cycle: 0
[2025-10-09T13:52:57.769+0000] {docker.py:438} INFO - âŒ [DEBUG] Failed restarts this cycle: 1
[2025-10-09T13:52:57.769+0000] {docker.py:438} INFO -    - compose-post-service-67bcfcd5ff-bqrz2 status=restart_failed details={'pod_name': 'compose-post-service-67bcfcd5ff-bqrz2', 'container_name': 'compose-post-service', 'status': 'restart_failed', 'before_count': 76, 'stdout': None, 'stderr': None, 'ctrl_err': None}
[2025-10-09T13:52:57.769+0000] {docker.py:438} INFO - â³ [DEBUG] Waiting 5 seconds until next cycle. Time remaining: 54s
[2025-10-09T13:52:57.769+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:57.770+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:52:57.770+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Container Restart Cycle #17 at 2025-10-09 13:52:48
[2025-10-09T13:52:57.770+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:52:57.770+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Entered restart_containers()
[2025-10-09T13:52:57.770+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, qty=2, rand=True, mode=fixed, ns=default, order=alphabetic, container_name=compose-post-service, restart_command=None
[2025-10-09T13:52:57.771+0000] {docker.py:438} INFO - ðŸ”‘ [DEBUG] Kubernetes API client created
[2025-10-09T13:52:57.771+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Selecting pods now...
[2025-10-09T13:52:57.771+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Entered _select_pods()
[2025-10-09T13:52:57.771+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, all=False, rand=True, mode=fixed, qty=2, ns=default, order=alphabetic
[2025-10-09T13:52:57.771+0000] {docker.py:438} INFO -    [DEBUG] Listing pods with label_selector=app=compose-post-service
[2025-10-09T13:52:57.772+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Found 1 pods initially
[2025-10-09T13:52:57.772+0000] {docker.py:438} INFO - ðŸŽ² [DEBUG] Random selection chosen: 1 pods
[2025-10-09T13:52:57.772+0000] {docker.py:438} INFO - âœ… [DEBUG] Selected pods: ['compose-post-service-67bcfcd5ff-bqrz2']
[2025-10-09T13:52:57.772+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Pods selected: 1
[2025-10-09T13:52:57.772+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:57.773+0000] {docker.py:438} INFO - ðŸŽ¯ [DEBUG] Processing pod: compose-post-service-67bcfcd5ff-bqrz2
[2025-10-09T13:52:57.773+0000] {docker.py:438} INFO - ðŸ“¦ [DEBUG] Using provided container: compose-post-service
[2025-10-09T13:52:57.773+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:52:57.773+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:52:57.773+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 76
[2025-10-09T13:52:57.774+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=76
[2025-10-09T13:52:57.774+0000] {docker.py:438} INFO - ðŸ“Š [DEBUG] Restart count before action: 76
[2025-10-09T13:52:57.774+0000] {docker.py:438} INFO - ðŸ”§ [DEBUG] Restart strategies to try: [['sh', '-c', 'kill -INT 1'], ['sh', '-c', 'kill -2 1'], ['sh', '-c', 'kill -TERM 1'], ['sh', '-c', 'kill -9 1']]
[2025-10-09T13:52:57.774+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #1: sh -c kill -INT 1
[2025-10-09T13:52:57.775+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:52:57.775+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:52:49 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:52:57.775+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:57.775+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #2: sh -c kill -2 1
[2025-10-09T13:52:57.776+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:52:57.776+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:52:49 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:52:57.776+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:57.776+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #3: sh -c kill -TERM 1
[2025-10-09T13:52:57.776+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:52:57.777+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:52:49 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:52:57.777+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:57.777+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #4: sh -c kill -9 1
[2025-10-09T13:52:57.777+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:52:57.778+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:52:50 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:52:57.778+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:57.778+0000] {docker.py:438} INFO - âŒ [DEBUG] All strategies exhausted for pod compose-post-service-67bcfcd5ff-bqrz2 and no restart observed
[2025-10-09T13:52:57.778+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:57.778+0000] {docker.py:438} INFO - ðŸ [DEBUG] restart_containers() finished. Processed 1 pods
[2025-10-09T13:52:57.779+0000] {docker.py:438} INFO -    [DEBUG] restart_containers returned 1 entries
[2025-10-09T13:52:57.779+0000] {docker.py:438} INFO - âœ… [DEBUG] Successfully restarted this cycle: 0
[2025-10-09T13:52:57.779+0000] {docker.py:438} INFO - âŒ [DEBUG] Failed restarts this cycle: 1
[2025-10-09T13:52:57.779+0000] {docker.py:438} INFO -    - compose-post-service-67bcfcd5ff-bqrz2 status=restart_failed details={'pod_name': 'compose-post-service-67bcfcd5ff-bqrz2', 'container_name': 'compose-post-service', 'status': 'restart_failed', 'before_count': 76, 'stdout': None, 'stderr': None, 'ctrl_err': None}
[2025-10-09T13:52:57.780+0000] {docker.py:438} INFO - â³ [DEBUG] Waiting 5 seconds until next cycle. Time remaining: 47s
[2025-10-09T13:52:57.780+0000] {docker.py:438} INFO - 
[2025-10-09T13:52:57.780+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:52:57.780+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Container Restart Cycle #18 at 2025-10-09 13:52:55
[2025-10-09T13:52:59.177+0000] {job.py:239} ERROR - Job heartbeat failed with error
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (127.0.0.1), port 5433 failed: FATAL:  the database system is in recovery mode


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/jobs/job.py", line 207, in heartbeat
    self._merge_from(Job._fetch_from_db(self, session))
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/api_internal/internal_api_call.py", line 139, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/retries.py", line 93, in wrapped_function
    for attempt in run_with_db_retries(max_retries=retries, logger=logger, **retry_kwargs):
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 443, in __iter__
    do = self.iter(retry_state=retry_state)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 376, in iter
    result = action(retry_state)
             ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 418, in exc_check
    raise retry_exc.reraise()
          ^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/tenacity/__init__.py", line 185, in reraise
    raise self.last_attempt.result()
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 449, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/utils/retries.py", line 102, in wrapped_function
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/jobs/job.py", line 335, in _fetch_from_db
    session.merge(job)
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3056, in merge
    return self._merge(
           ^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 3136, in _merge
    merged = self.get(
             ^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2853, in get
    return self._get_impl(
           ^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 2975, in _get_impl
    return db_load_fn(
           ^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/loading.py", line 530, in load_on_pk_identity
    session.execute(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1716, in execute
    conn = self._connection_for_bind(bind)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 1555, in _connection_for_bind
    return self._transaction._connection_for_bind(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/orm/session.py", line 750, in _connection_for_bind
    conn = bind.connect()
           ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/future/engine.py", line 412, in connect
    return super(Engine, self).connect()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3325, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3404, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3374, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 2208, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/base.py", line 3371, in _wrap_pool_connect
    return fn()
           ^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/impl.py", line 256, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 388, in __init__
    self.__connect()
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 690, in __connect
    with util.safe_reraise():
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/pool/base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/create.py", line 574, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/sqlalchemy/engine/default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/psycopg2/__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: FATAL:  the database system is in recovery mode

(Background on this error at: https://sqlalche.me/e/14/e3q8)
[2025-10-09T13:52:59.215+0000] {job.py:245} ERROR - Job heartbeat failed with error. Scheduler may go into unhealthy state
[2025-10-09T13:53:04.244+0000] {job.py:229} INFO - Heartbeat recovered after 14.88 seconds
[2025-10-09T13:53:12.582+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:53:12.582+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Entered restart_containers()
[2025-10-09T13:53:12.583+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, qty=2, rand=True, mode=fixed, ns=default, order=alphabetic, container_name=compose-post-service, restart_command=None
[2025-10-09T13:53:12.583+0000] {docker.py:438} INFO - ðŸ”‘ [DEBUG] Kubernetes API client created
[2025-10-09T13:53:12.584+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Selecting pods now...
[2025-10-09T13:53:12.584+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Entered _select_pods()
[2025-10-09T13:53:12.585+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, all=False, rand=True, mode=fixed, qty=2, ns=default, order=alphabetic
[2025-10-09T13:53:12.585+0000] {docker.py:438} INFO -    [DEBUG] Listing pods with label_selector=app=compose-post-service
[2025-10-09T13:53:12.585+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Found 1 pods initially
[2025-10-09T13:53:12.586+0000] {docker.py:438} INFO - ðŸŽ² [DEBUG] Random selection chosen: 1 pods
[2025-10-09T13:53:12.586+0000] {docker.py:438} INFO - âœ… [DEBUG] Selected pods: ['compose-post-service-67bcfcd5ff-bqrz2']
[2025-10-09T13:53:12.586+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Pods selected: 1
[2025-10-09T13:53:12.587+0000] {docker.py:438} INFO - 
[2025-10-09T13:53:12.587+0000] {docker.py:438} INFO - ðŸŽ¯ [DEBUG] Processing pod: compose-post-service-67bcfcd5ff-bqrz2
[2025-10-09T13:53:12.587+0000] {docker.py:438} INFO - ðŸ“¦ [DEBUG] Using provided container: compose-post-service
[2025-10-09T13:53:12.588+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:53:12.588+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:53:12.588+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 76
[2025-10-09T13:53:12.589+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=76
[2025-10-09T13:53:12.589+0000] {docker.py:438} INFO - ðŸ“Š [DEBUG] Restart count before action: 76
[2025-10-09T13:53:12.589+0000] {docker.py:438} INFO - ðŸ”§ [DEBUG] Restart strategies to try: [['sh', '-c', 'kill -INT 1'], ['sh', '-c', 'kill -2 1'], ['sh', '-c', 'kill -TERM 1'], ['sh', '-c', 'kill -9 1']]
[2025-10-09T13:53:12.589+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #1: sh -c kill -INT 1
[2025-10-09T13:53:12.590+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:53:12.590+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:52:59 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:53:12.590+0000] {docker.py:438} INFO - 
[2025-10-09T13:53:12.591+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #2: sh -c kill -2 1
[2025-10-09T13:53:12.591+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:53:12.591+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:52:59 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:53:12.592+0000] {docker.py:438} INFO - 
[2025-10-09T13:53:12.592+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #3: sh -c kill -TERM 1
[2025-10-09T13:53:12.593+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:53:12.593+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:52:59 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:53:12.594+0000] {docker.py:438} INFO - 
[2025-10-09T13:53:12.594+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #4: sh -c kill -9 1
[2025-10-09T13:53:12.594+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:53:12.595+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:53:00 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:53:12.595+0000] {docker.py:438} INFO - 
[2025-10-09T13:53:12.595+0000] {docker.py:438} INFO - âŒ [DEBUG] All strategies exhausted for pod compose-post-service-67bcfcd5ff-bqrz2 and no restart observed
[2025-10-09T13:53:12.596+0000] {docker.py:438} INFO - 
[2025-10-09T13:53:12.596+0000] {docker.py:438} INFO - ðŸ [DEBUG] restart_containers() finished. Processed 1 pods
[2025-10-09T13:53:12.596+0000] {docker.py:438} INFO -    [DEBUG] restart_containers returned 1 entries
[2025-10-09T13:53:12.597+0000] {docker.py:438} INFO - âœ… [DEBUG] Successfully restarted this cycle: 0
[2025-10-09T13:53:12.597+0000] {docker.py:438} INFO - âŒ [DEBUG] Failed restarts this cycle: 1
[2025-10-09T13:53:12.597+0000] {docker.py:438} INFO -    - compose-post-service-67bcfcd5ff-bqrz2 status=restart_failed details={'pod_name': 'compose-post-service-67bcfcd5ff-bqrz2', 'container_name': 'compose-post-service', 'status': 'restart_failed', 'before_count': 76, 'stdout': None, 'stderr': None, 'ctrl_err': None}
[2025-10-09T13:53:12.598+0000] {docker.py:438} INFO - â³ [DEBUG] Waiting 5 seconds until next cycle. Time remaining: 37s
[2025-10-09T13:53:12.598+0000] {docker.py:438} INFO - 
[2025-10-09T13:53:12.598+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:53:12.599+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Container Restart Cycle #19 at 2025-10-09 13:53:05
[2025-10-09T13:53:12.599+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:53:12.600+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Entered restart_containers()
[2025-10-09T13:53:12.600+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, qty=2, rand=True, mode=fixed, ns=default, order=alphabetic, container_name=compose-post-service, restart_command=None
[2025-10-09T13:53:12.600+0000] {docker.py:438} INFO - ðŸ”‘ [DEBUG] Kubernetes API client created
[2025-10-09T13:53:12.601+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Selecting pods now...
[2025-10-09T13:53:12.601+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Entered _select_pods()
[2025-10-09T13:53:12.601+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, all=False, rand=True, mode=fixed, qty=2, ns=default, order=alphabetic
[2025-10-09T13:53:12.602+0000] {docker.py:438} INFO -    [DEBUG] Listing pods with label_selector=app=compose-post-service
[2025-10-09T13:53:12.603+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Found 1 pods initially
[2025-10-09T13:53:12.603+0000] {docker.py:438} INFO - ðŸŽ² [DEBUG] Random selection chosen: 1 pods
[2025-10-09T13:53:12.604+0000] {docker.py:438} INFO - âœ… [DEBUG] Selected pods: ['compose-post-service-67bcfcd5ff-bqrz2']
[2025-10-09T13:53:12.604+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Pods selected: 1
[2025-10-09T13:53:12.605+0000] {docker.py:438} INFO - 
[2025-10-09T13:53:12.605+0000] {docker.py:438} INFO - ðŸŽ¯ [DEBUG] Processing pod: compose-post-service-67bcfcd5ff-bqrz2
[2025-10-09T13:53:12.606+0000] {docker.py:438} INFO - ðŸ“¦ [DEBUG] Using provided container: compose-post-service
[2025-10-09T13:53:12.606+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:53:12.606+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:53:12.607+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 76
[2025-10-09T13:53:12.607+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=76
[2025-10-09T13:53:12.607+0000] {docker.py:438} INFO - ðŸ“Š [DEBUG] Restart count before action: 76
[2025-10-09T13:53:12.608+0000] {docker.py:438} INFO - ðŸ”§ [DEBUG] Restart strategies to try: [['sh', '-c', 'kill -INT 1'], ['sh', '-c', 'kill -2 1'], ['sh', '-c', 'kill -TERM 1'], ['sh', '-c', 'kill -9 1']]
[2025-10-09T13:53:12.608+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #1: sh -c kill -INT 1
[2025-10-09T13:53:12.608+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:53:12.609+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:53:06 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:53:12.609+0000] {docker.py:438} INFO - 
[2025-10-09T13:53:12.609+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #2: sh -c kill -2 1
[2025-10-09T13:53:12.610+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:53:12.610+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:53:06 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:53:12.610+0000] {docker.py:438} INFO - 
[2025-10-09T13:53:12.611+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #3: sh -c kill -TERM 1
[2025-10-09T13:53:12.611+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:53:12.611+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:53:06 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:53:12.612+0000] {docker.py:438} INFO - 
[2025-10-09T13:53:12.612+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #4: sh -c kill -9 1
[2025-10-09T13:53:12.613+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:53:12.613+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:53:07 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:53:12.613+0000] {docker.py:438} INFO - 
[2025-10-09T13:53:12.614+0000] {docker.py:438} INFO - âŒ [DEBUG] All strategies exhausted for pod compose-post-service-67bcfcd5ff-bqrz2 and no restart observed
[2025-10-09T13:53:12.614+0000] {docker.py:438} INFO - 
[2025-10-09T13:53:12.614+0000] {docker.py:438} INFO - ðŸ [DEBUG] restart_containers() finished. Processed 1 pods
[2025-10-09T13:53:12.615+0000] {docker.py:438} INFO -    [DEBUG] restart_containers returned 1 entries
[2025-10-09T13:53:12.615+0000] {docker.py:438} INFO - âœ… [DEBUG] Successfully restarted this cycle: 0
[2025-10-09T13:53:12.615+0000] {docker.py:438} INFO - âŒ [DEBUG] Failed restarts this cycle: 1
[2025-10-09T13:53:12.616+0000] {docker.py:438} INFO -    - compose-post-service-67bcfcd5ff-bqrz2 status=restart_failed details={'pod_name': 'compose-post-service-67bcfcd5ff-bqrz2', 'container_name': 'compose-post-service', 'status': 'restart_failed', 'before_count': 76, 'stdout': None, 'stderr': None, 'ctrl_err': None}
[2025-10-09T13:53:12.616+0000] {docker.py:438} INFO - â³ [DEBUG] Waiting 5 seconds until next cycle. Time remaining: 30s
[2025-10-09T13:53:12.616+0000] {docker.py:438} INFO - 
[2025-10-09T13:53:12.617+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:53:12.617+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Container Restart Cycle #20 at 2025-10-09 13:53:12
[2025-10-09T13:53:12.617+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:53:12.618+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Entered restart_containers()
[2025-10-09T13:53:12.618+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, qty=2, rand=True, mode=fixed, ns=default, order=alphabetic, container_name=compose-post-service, restart_command=None
[2025-10-09T13:53:12.618+0000] {docker.py:438} INFO - ðŸ”‘ [DEBUG] Kubernetes API client created
[2025-10-09T13:53:12.619+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Selecting pods now...
[2025-10-09T13:53:12.619+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Entered _select_pods()
[2025-10-09T13:53:12.619+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, all=False, rand=True, mode=fixed, qty=2, ns=default, order=alphabetic
[2025-10-09T13:53:12.620+0000] {docker.py:438} INFO -    [DEBUG] Listing pods with label_selector=app=compose-post-service
[2025-10-09T13:53:12.620+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Found 1 pods initially
[2025-10-09T13:53:12.620+0000] {docker.py:438} INFO - ðŸŽ² [DEBUG] Random selection chosen: 1 pods
[2025-10-09T13:53:12.621+0000] {docker.py:438} INFO - âœ… [DEBUG] Selected pods: ['compose-post-service-67bcfcd5ff-bqrz2']
[2025-10-09T13:53:12.621+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Pods selected: 1
[2025-10-09T13:53:12.621+0000] {docker.py:438} INFO - 
[2025-10-09T13:53:12.622+0000] {docker.py:438} INFO - ðŸŽ¯ [DEBUG] Processing pod: compose-post-service-67bcfcd5ff-bqrz2
[2025-10-09T13:53:12.622+0000] {docker.py:438} INFO - ðŸ“¦ [DEBUG] Using provided container: compose-post-service
[2025-10-09T13:53:12.622+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:53:27.297+0000] {docker.py:438} INFO - [DEBUG] Found 1 container_status entries
[2025-10-09T13:53:27.298+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 76
[2025-10-09T13:53:27.298+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=76
[2025-10-09T13:53:27.299+0000] {docker.py:438} INFO - ðŸ“Š [DEBUG] Restart count before action: 76
[2025-10-09T13:53:27.299+0000] {docker.py:438} INFO - ðŸ”§ [DEBUG] Restart strategies to try: [['sh', '-c', 'kill -INT 1'], ['sh', '-c', 'kill -2 1'], ['sh', '-c', 'kill -TERM 1'], ['sh', '-c', 'kill -9 1']]
[2025-10-09T13:53:27.301+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #1: sh -c kill -INT 1
[2025-10-09T13:53:27.302+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:53:27.302+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:53:13 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:53:27.302+0000] {docker.py:438} INFO - 
[2025-10-09T13:53:27.303+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #2: sh -c kill -2 1
[2025-10-09T13:53:27.303+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:53:27.303+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:53:13 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:53:27.304+0000] {docker.py:438} INFO - 
[2025-10-09T13:53:27.304+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #3: sh -c kill -TERM 1
[2025-10-09T13:53:27.304+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:53:27.304+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:53:13 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:53:27.305+0000] {docker.py:438} INFO - 
[2025-10-09T13:53:27.305+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #4: sh -c kill -9 1
[2025-10-09T13:53:27.306+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:53:27.307+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:53:14 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:53:27.307+0000] {docker.py:438} INFO - 
[2025-10-09T13:53:27.308+0000] {docker.py:438} INFO - âŒ [DEBUG] All strategies exhausted for pod compose-post-service-67bcfcd5ff-bqrz2 and no restart observed
[2025-10-09T13:53:27.309+0000] {docker.py:438} INFO - 
[2025-10-09T13:53:27.309+0000] {docker.py:438} INFO - ðŸ [DEBUG] restart_containers() finished. Processed 1 pods
[2025-10-09T13:53:27.309+0000] {docker.py:438} INFO -    [DEBUG] restart_containers returned 1 entries
[2025-10-09T13:53:27.310+0000] {docker.py:438} INFO - âœ… [DEBUG] Successfully restarted this cycle: 0
[2025-10-09T13:53:27.310+0000] {docker.py:438} INFO - âŒ [DEBUG] Failed restarts this cycle: 1
[2025-10-09T13:53:27.312+0000] {docker.py:438} INFO -    - compose-post-service-67bcfcd5ff-bqrz2 status=restart_failed details={'pod_name': 'compose-post-service-67bcfcd5ff-bqrz2', 'container_name': 'compose-post-service', 'status': 'restart_failed', 'before_count': 76, 'stdout': None, 'stderr': None, 'ctrl_err': None}
[2025-10-09T13:53:27.312+0000] {docker.py:438} INFO - â³ [DEBUG] Waiting 5 seconds until next cycle. Time remaining: 23s
[2025-10-09T13:53:27.313+0000] {docker.py:438} INFO - 
[2025-10-09T13:53:27.313+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:53:27.314+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Container Restart Cycle #21 at 2025-10-09 13:53:19
[2025-10-09T13:53:27.315+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:53:27.315+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Entered restart_containers()
[2025-10-09T13:53:27.316+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, qty=2, rand=True, mode=fixed, ns=default, order=alphabetic, container_name=compose-post-service, restart_command=None
[2025-10-09T13:53:27.316+0000] {docker.py:438} INFO - ðŸ”‘ [DEBUG] Kubernetes API client created
[2025-10-09T13:53:27.317+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Selecting pods now...
[2025-10-09T13:53:27.317+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Entered _select_pods()
[2025-10-09T13:53:27.318+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, all=False, rand=True, mode=fixed, qty=2, ns=default, order=alphabetic
[2025-10-09T13:53:27.319+0000] {docker.py:438} INFO -    [DEBUG] Listing pods with label_selector=app=compose-post-service
[2025-10-09T13:53:27.319+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Found 1 pods initially
[2025-10-09T13:53:27.321+0000] {docker.py:438} INFO - ðŸŽ² [DEBUG] Random selection chosen: 1 pods
[2025-10-09T13:53:27.321+0000] {docker.py:438} INFO - âœ… [DEBUG] Selected pods: ['compose-post-service-67bcfcd5ff-bqrz2']
[2025-10-09T13:53:27.322+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Pods selected: 1
[2025-10-09T13:53:27.323+0000] {docker.py:438} INFO - 
[2025-10-09T13:53:27.323+0000] {docker.py:438} INFO - ðŸŽ¯ [DEBUG] Processing pod: compose-post-service-67bcfcd5ff-bqrz2
[2025-10-09T13:53:27.324+0000] {docker.py:438} INFO - ðŸ“¦ [DEBUG] Using provided container: compose-post-service
[2025-10-09T13:53:27.324+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:53:27.325+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:53:27.326+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 76
[2025-10-09T13:53:27.326+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=76
[2025-10-09T13:53:27.326+0000] {docker.py:438} INFO - ðŸ“Š [DEBUG] Restart count before action: 76
[2025-10-09T13:53:27.327+0000] {docker.py:438} INFO - ðŸ”§ [DEBUG] Restart strategies to try: [['sh', '-c', 'kill -INT 1'], ['sh', '-c', 'kill -2 1'], ['sh', '-c', 'kill -TERM 1'], ['sh', '-c', 'kill -9 1']]
[2025-10-09T13:53:27.327+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #1: sh -c kill -INT 1
[2025-10-09T13:53:27.328+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:53:27.329+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:53:19 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:53:27.329+0000] {docker.py:438} INFO - 
[2025-10-09T13:53:27.330+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #2: sh -c kill -2 1
[2025-10-09T13:53:27.331+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:53:27.331+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:53:20 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:53:27.331+0000] {docker.py:438} INFO - 
[2025-10-09T13:53:27.331+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #3: sh -c kill -TERM 1
[2025-10-09T13:53:27.332+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:53:27.332+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:53:20 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:53:27.333+0000] {docker.py:438} INFO - 
[2025-10-09T13:53:27.334+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #4: sh -c kill -9 1
[2025-10-09T13:53:27.335+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:53:27.336+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:53:20 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:53:27.336+0000] {docker.py:438} INFO - 
[2025-10-09T13:53:27.336+0000] {docker.py:438} INFO - âŒ [DEBUG] All strategies exhausted for pod compose-post-service-67bcfcd5ff-bqrz2 and no restart observed
[2025-10-09T13:53:27.337+0000] {docker.py:438} INFO - 
[2025-10-09T13:53:27.337+0000] {docker.py:438} INFO - ðŸ [DEBUG] restart_containers() finished. Processed 1 pods
[2025-10-09T13:53:27.337+0000] {docker.py:438} INFO -    [DEBUG] restart_containers returned 1 entries
[2025-10-09T13:53:27.338+0000] {docker.py:438} INFO - âœ… [DEBUG] Successfully restarted this cycle: 0
[2025-10-09T13:53:27.338+0000] {docker.py:438} INFO - âŒ [DEBUG] Failed restarts this cycle: 1
[2025-10-09T13:53:27.338+0000] {docker.py:438} INFO -    - compose-post-service-67bcfcd5ff-bqrz2 status=restart_failed details={'pod_name': 'compose-post-service-67bcfcd5ff-bqrz2', 'container_name': 'compose-post-service', 'status': 'restart_failed', 'before_count': 76, 'stdout': None, 'stderr': None, 'ctrl_err': None}
[2025-10-09T13:53:27.338+0000] {docker.py:438} INFO - â³ [DEBUG] Waiting 5 seconds until next cycle. Time remaining: 16s
[2025-10-09T13:53:27.339+0000] {docker.py:438} INFO - 
[2025-10-09T13:53:27.339+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:53:27.340+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Container Restart Cycle #22 at 2025-10-09 13:53:25
[2025-10-09T13:53:27.341+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:53:27.342+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Entered restart_containers()
[2025-10-09T13:53:27.343+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, qty=2, rand=True, mode=fixed, ns=default, order=alphabetic, container_name=compose-post-service, restart_command=None
[2025-10-09T13:53:27.343+0000] {docker.py:438} INFO - ðŸ”‘ [DEBUG] Kubernetes API client created
[2025-10-09T13:53:27.343+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Selecting pods now...
[2025-10-09T13:53:27.344+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Entered _select_pods()
[2025-10-09T13:53:27.344+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, all=False, rand=True, mode=fixed, qty=2, ns=default, order=alphabetic
[2025-10-09T13:53:27.344+0000] {docker.py:438} INFO -    [DEBUG] Listing pods with label_selector=app=compose-post-service
[2025-10-09T13:53:27.344+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Found 1 pods initially
[2025-10-09T13:53:27.345+0000] {docker.py:438} INFO - ðŸŽ² [DEBUG] Random selection chosen: 1 pods
[2025-10-09T13:53:27.345+0000] {docker.py:438} INFO - âœ… [DEBUG] Selected pods: ['compose-post-service-67bcfcd5ff-bqrz2']
[2025-10-09T13:53:27.346+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Pods selected: 1
[2025-10-09T13:53:27.347+0000] {docker.py:438} INFO - 
[2025-10-09T13:53:27.347+0000] {docker.py:438} INFO - ðŸŽ¯ [DEBUG] Processing pod: compose-post-service-67bcfcd5ff-bqrz2
[2025-10-09T13:53:27.348+0000] {docker.py:438} INFO - ðŸ“¦ [DEBUG] Using provided container: compose-post-service
[2025-10-09T13:53:27.349+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:53:27.349+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:53:27.349+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 76
[2025-10-09T13:53:27.350+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=76
[2025-10-09T13:53:27.350+0000] {docker.py:438} INFO - ðŸ“Š [DEBUG] Restart count before action: 76
[2025-10-09T13:53:27.350+0000] {docker.py:438} INFO - ðŸ”§ [DEBUG] Restart strategies to try: [['sh', '-c', 'kill -INT 1'], ['sh', '-c', 'kill -2 1'], ['sh', '-c', 'kill -TERM 1'], ['sh', '-c', 'kill -9 1']]
[2025-10-09T13:53:27.351+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #1: sh -c kill -INT 1
[2025-10-09T13:53:27.351+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:53:27.352+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:53:26 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:53:27.353+0000] {docker.py:438} INFO - 
[2025-10-09T13:53:27.353+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #2: sh -c kill -2 1
[2025-10-09T13:53:27.353+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:53:27.353+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:53:27 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:53:35.007+0000] {docker.py:438} INFO - [32m[2025-10-09 13:53:35 INFO] Let's rollback...
[2025-10-09T13:53:35.014+0000] {docker.py:438} INFO - [32m[2025-10-09 13:53:35 INFO] Rollback: verify-pods-running
[2025-10-09T13:53:35.015+0000] {docker.py:438} INFO - [32m[2025-10-09 13:53:35 INFO] Probe: verify-pods-running
[2025-10-09T13:53:35.328+0000] {docker.py:438} INFO - [32m[2025-10-09 13:53:35 INFO] Experiment ended with status: completed
[2025-10-09T13:53:35.333+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #3: sh -c kill -TERM 1
[2025-10-09T13:53:35.333+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:53:35.333+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:53:27 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:53:35.334+0000] {docker.py:438} INFO - 
[2025-10-09T13:53:35.334+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #4: sh -c kill -9 1
[2025-10-09T13:53:35.335+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:53:35.336+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:53:27 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:53:35.336+0000] {docker.py:438} INFO - 
[2025-10-09T13:53:35.336+0000] {docker.py:438} INFO - âŒ [DEBUG] All strategies exhausted for pod compose-post-service-67bcfcd5ff-bqrz2 and no restart observed
[2025-10-09T13:53:35.337+0000] {docker.py:438} INFO - 
[2025-10-09T13:53:35.337+0000] {docker.py:438} INFO - ðŸ [DEBUG] restart_containers() finished. Processed 1 pods
[2025-10-09T13:53:35.338+0000] {docker.py:438} INFO -    [DEBUG] restart_containers returned 1 entries
[2025-10-09T13:53:35.338+0000] {docker.py:438} INFO - âœ… [DEBUG] Successfully restarted this cycle: 0
[2025-10-09T13:53:35.341+0000] {docker.py:438} INFO - âŒ [DEBUG] Failed restarts this cycle: 1
[2025-10-09T13:53:35.342+0000] {docker.py:438} INFO -    - compose-post-service-67bcfcd5ff-bqrz2 status=restart_failed details={'pod_name': 'compose-post-service-67bcfcd5ff-bqrz2', 'container_name': 'compose-post-service', 'status': 'restart_failed', 'before_count': 76, 'stdout': None, 'stderr': None, 'ctrl_err': None}
[2025-10-09T13:53:35.342+0000] {docker.py:438} INFO - â³ [DEBUG] Waiting 5 seconds until next cycle. Time remaining: 9s
[2025-10-09T13:53:35.343+0000] {docker.py:438} INFO - 
[2025-10-09T13:53:35.344+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:53:35.344+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Container Restart Cycle #23 at 2025-10-09 13:53:33
[2025-10-09T13:53:35.344+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:53:35.344+0000] {docker.py:438} INFO - ðŸ”„ [DEBUG] Entered restart_containers()
[2025-10-09T13:53:35.345+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, qty=2, rand=True, mode=fixed, ns=default, order=alphabetic, container_name=compose-post-service, restart_command=None
[2025-10-09T13:53:35.345+0000] {docker.py:438} INFO - ðŸ”‘ [DEBUG] Kubernetes API client created
[2025-10-09T13:53:35.347+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Selecting pods now...
[2025-10-09T13:53:35.348+0000] {docker.py:438} INFO - ðŸ” [DEBUG] Entered _select_pods()
[2025-10-09T13:53:35.348+0000] {docker.py:438} INFO -    Params => label_selector=app=compose-post-service, name_pattern=None, all=False, rand=True, mode=fixed, qty=2, ns=default, order=alphabetic
[2025-10-09T13:53:35.348+0000] {docker.py:438} INFO -    [DEBUG] Listing pods with label_selector=app=compose-post-service
[2025-10-09T13:53:35.349+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Found 1 pods initially
[2025-10-09T13:53:35.349+0000] {docker.py:438} INFO - ðŸŽ² [DEBUG] Random selection chosen: 1 pods
[2025-10-09T13:53:35.349+0000] {docker.py:438} INFO - âœ… [DEBUG] Selected pods: ['compose-post-service-67bcfcd5ff-bqrz2']
[2025-10-09T13:53:35.350+0000] {docker.py:438} INFO - ðŸ“‹ [DEBUG] Pods selected: 1
[2025-10-09T13:53:35.350+0000] {docker.py:438} INFO - 
[2025-10-09T13:53:35.350+0000] {docker.py:438} INFO - ðŸŽ¯ [DEBUG] Processing pod: compose-post-service-67bcfcd5ff-bqrz2
[2025-10-09T13:53:35.353+0000] {docker.py:438} INFO - ðŸ“¦ [DEBUG] Using provided container: compose-post-service
[2025-10-09T13:53:35.353+0000] {docker.py:438} INFO - ðŸ” [DEBUG] _get_restart_count() called for pod=compose-post-service-67bcfcd5ff-bqrz2, ns=default, container=compose-post-service
[2025-10-09T13:53:35.353+0000] {docker.py:438} INFO -    [DEBUG] Found 1 container_status entries
[2025-10-09T13:53:35.354+0000] {docker.py:438} INFO -    [DEBUG] container: compose-post-service, restart_count: 76
[2025-10-09T13:53:35.354+0000] {docker.py:438} INFO -    âœ… [DEBUG] Matched container compose-post-service, restart_count=76
[2025-10-09T13:53:35.354+0000] {docker.py:438} INFO - ðŸ“Š [DEBUG] Restart count before action: 76
[2025-10-09T13:53:35.354+0000] {docker.py:438} INFO - ðŸ”§ [DEBUG] Restart strategies to try: [['sh', '-c', 'kill -INT 1'], ['sh', '-c', 'kill -2 1'], ['sh', '-c', 'kill -TERM 1'], ['sh', '-c', 'kill -9 1']]
[2025-10-09T13:53:35.355+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #1: sh -c kill -INT 1
[2025-10-09T13:53:35.355+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:53:35.357+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:53:33 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:53:35.358+0000] {docker.py:438} INFO - 
[2025-10-09T13:53:35.358+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #2: sh -c kill -2 1
[2025-10-09T13:53:35.358+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:53:35.358+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:53:34 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:53:35.359+0000] {docker.py:438} INFO - 
[2025-10-09T13:53:35.359+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #3: sh -c kill -TERM 1
[2025-10-09T13:53:35.360+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:53:35.360+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:53:34 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:53:35.360+0000] {docker.py:438} INFO - 
[2025-10-09T13:53:35.361+0000] {docker.py:438} INFO - âž¡ï¸ [DEBUG] Trying restart strategy #4: sh -c kill -9 1
[2025-10-09T13:53:35.361+0000] {docker.py:438} INFO -    âŒ [DEBUG] Failed to open exec stream for pod compose-post-service-67bcfcd5ff-bqrz2, container compose-post-service: (0)
[2025-10-09T13:53:35.361+0000] {docker.py:438} INFO - Reason: Handshake status 500 Internal Server Error -+-+- {'date': 'Thu, 09 Oct 2025 13:53:34 GMT', 'connection': 'close', 'content-length': '0'} -+-+- b''
[2025-10-09T13:53:35.362+0000] {docker.py:438} INFO - 
[2025-10-09T13:53:35.362+0000] {docker.py:438} INFO - âŒ [DEBUG] All strategies exhausted for pod compose-post-service-67bcfcd5ff-bqrz2 and no restart observed
[2025-10-09T13:53:35.362+0000] {docker.py:438} INFO - 
[2025-10-09T13:53:35.362+0000] {docker.py:438} INFO - ðŸ [DEBUG] restart_containers() finished. Processed 1 pods
[2025-10-09T13:53:35.363+0000] {docker.py:438} INFO -    [DEBUG] restart_containers returned 1 entries
[2025-10-09T13:53:35.363+0000] {docker.py:438} INFO - âœ… [DEBUG] Successfully restarted this cycle: 0
[2025-10-09T13:53:35.364+0000] {docker.py:438} INFO - âŒ [DEBUG] Failed restarts this cycle: 1
[2025-10-09T13:53:35.364+0000] {docker.py:438} INFO -    - compose-post-service-67bcfcd5ff-bqrz2 status=restart_failed details={'pod_name': 'compose-post-service-67bcfcd5ff-bqrz2', 'container_name': 'compose-post-service', 'status': 'restart_failed', 'before_count': 76, 'stdout': None, 'stderr': None, 'ctrl_err': None}
[2025-10-09T13:53:35.365+0000] {docker.py:438} INFO - â° [DEBUG] Less than 5 seconds remaining (2s). Stopping continuous run.
[2025-10-09T13:53:35.365+0000] {docker.py:438} INFO - 
[2025-10-09T13:53:35.365+0000] {docker.py:438} INFO - ============================================================
[2025-10-09T13:53:35.366+0000] {docker.py:438} INFO - ðŸ [DEBUG] Continuous restart experiment completed
[2025-10-09T13:53:35.366+0000] {docker.py:438} INFO - ðŸ“ˆ Total cycles: 23
[2025-10-09T13:53:35.367+0000] {docker.py:438} INFO - ðŸ“¦ Total containers restarted: 4
[2025-10-09T13:53:35.368+0000] {docker.py:438} INFO - â±ï¸ Total duration: 398 seconds
[2025-10-09T13:53:35.368+0000] {docker.py:438} INFO - ðŸ“Š Average cycle time: 17.3 seconds
[2025-10-09T13:53:35.763+0000] {docker.py:438} INFO - Container restart experiment completed successfully
[2025-10-09T13:53:36.355+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2025-10-09T13:53:36.356+0000] {taskinstance.py:352} INFO - Marking task as SUCCESS. dag_id=Container_Restart, task_id=apply_container_restart_docker, run_id=scheduled__2025-10-09T13:00:00+00:00, execution_date=20251009T130000, start_date=20251009T134519, end_date=20251009T135336
[2025-10-09T13:53:36.427+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2025-10-09T13:53:36.474+0000] {taskinstance.py:3900} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2025-10-09T13:53:36.486+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
